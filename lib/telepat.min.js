!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Telepat",[],t):"object"==typeof exports?exports.Telepat=t():e.Telepat=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),c=i(a),u=n(3),f=i(u),l=n(173),h=i(l),d=n(182),p=i(d),v=n(184),g=i(v),y=n(185),m=i(y),b=n(186),_=i(b),w=n(223),E=i(w),k=n(224),x=i(k),S=function(){function e(){function t(){return r.env["win32"===r.platform?"USERPROFILE":"HOME"]}function n(){var e=t()+"/.telepat-cli";return c["default"].existsSync(e)||c["default"].mkdirSync(e,744),e}o(this,e),this._db=new f["default"]("undefined"!=typeof window?"/_telepat":n()),this._event=new m["default"](p["default"]),this._monitor=new _["default"],this._socketEndpoint=null,this._socket=null,this._persistentConnectionOptions=null,this._sessionId=null,this.connected=!1,this.connecting=!1,this.configured=!1,this.currentAppId=null,this.contexts=null,this.subscriptions={},this.admin=null,this.user=null,this.contextEvent=new m["default"](p["default"])}return s(e,[{key:"getContexts",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0];h["default"].get("context/all","",function(n,r){if(n){var i=i("Error retrieving contexts "+n);e.callback(i,null),e._event.emit("error",i)}else{e._monitor.remove({channel:{model:"context"}}),e.contexts={};for(var o in r.body.content)e.contexts[r.body.content[o].id]=r.body.content[o];e._monitor.add({channel:{model:"context"}},e.contexts,e.contextEvent,e._addContext.bind(e),e._deleteContext.bind(e),e._updateContext.bind(e)),e.contextEvent.on("update",function(t,n,r,i){e._event.emit("contexts-update")}),t(null,e.contexts),e._event.emit("contexts-update")}})}},{key:"_addContext",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];this.admin?this.admin.addContext(e,t):p["default"].warn("Editing context data as non-admin user. Changes will not be remotely persisted.")}},{key:"_updateContext",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?function(){}:arguments[2];this.admin?this.admin.updateContext(e,t,n):p["default"].warn("Editing context data as non-admin user. Changes will not be remotely persisted.")}},{key:"_deleteContext",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];this.admin?this.admin.deleteContext(e,t):p["default"].warn("Editing context data as non-admin user. Changes will not be remotely persisted.")}},{key:"_updateUser",value:function(){var e=this,t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],n=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];this.user?n(null):this.user=new x["default"](this._db,this._event,this._monitor,function(t){e.admin=t},function(){t?e.user.reauth(n):n(null)})}},{key:"configure",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];"undefined"!=typeof t.apiEndpoint?h["default"].apiEndpoint=t.apiEndpoint+"/":n((0,g["default"])("Configure options must provide an apiEndpoint property")),"undefined"!=typeof t.socketEndpoint?this._socketEndpoint=t.socketEndpoint:n((0,g["default"])("Configure options must provide an socketEndpoint property")),this._updateUser(t.reauth,function(){e._event.emit("configure"),e.configured=!0,n(null,e)})}},{key:"connect",value:function(e){function t(t){return void 0!==t.body.content.identifier&&(h["default"].UDID=t.body.content.identifier,p["default"].info("Received new UDID: "+h["default"].UDID),s._db.get(":deviceId").then(function(e){e[h["default"].appId]=h["default"].UDID,p["default"].warn("Replacing existing UDID"),s._db.put(e)["catch"](function(e){p["default"].warn("Could not persist UDID. Error: "+e)})})["catch"](function(){var e={_id:":deviceId"};e[h["default"].appId]=h["default"].UDID,s._db.put(e)["catch"](function(e){p["default"].warn("Could not persist UDID. Error: "+e)})})),s._socket.emit("bind_device",{device_id:h["default"].UDID,application_id:h["default"].appId}),p["default"].info("Connection established"),s.getContexts(function(){s._updateUser(e.reauth,function(){s._event.emit("connect"),s.currentAppId=h["default"].appId,s.connected=!0,s.connecting=!1,o(null,s)})}),!0}function r(){var e={info:{os:"web",userAgent:"undefined"!=typeof navigator?navigator.userAgent:"node"},"volatile":{type:"sockets",active:1,token:s._sessionId}};s._persistentConnectionOptions&&(e.persistent=s._persistentConnectionOptions,1===e.persistent.active&&(e["volatile"].active=0)),h["default"].call("device/register",e,function(n,r){return n?(h["default"].UDID=null,void h["default"].call("device/register",e,function(e,n){return e?(s._socket.disconnect(),s._event.emit("disconnect",e),s.currentAppId=null,s.connected=!1,s.connecting=!1,o((0,g["default"])("Device registration failed with error: "+e))):t(n)})):t(r)})}var i=this,o=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1],s=this;if("undefined"==typeof e)return o((0,g["default"])("Options object not provided to the connect function"));if("undefined"==typeof e.apiKey)return o((0,g["default"])("Connect options must provide an apiKey property"));if("undefined"==typeof e.appId)return o((0,g["default"])("Connect options must provide an appId property"));if("undefined"!=typeof e.apiEndpoint)h["default"].apiEndpoint=e.apiEndpoint+"/";else if(!h["default"].apiEndpoint)return o((0,g["default"])("Connect options must provide an apiEndpoint property, or you must run `configure` first"));if("undefined"!=typeof e.socketEndpoint)this._socketEndpoint=e.socketEndpoint;else if(!this._socketEndpoint)return o((0,g["default"])("Connect options must provide an socketEndpoint property, or you must run `configure` first"));return"undefined"!=typeof e.timerInterval&&(this._monitor.timerInterval=e.timerInterval),this.connecting=!0,this.connected&&this.disconnect(),h["default"].apiKey=e.apiKey,h["default"].appId=e.appId,this.admin.apps&&(this.admin.app=this.admin.apps[h["default"].appId]),this._persistentConnectionOptions=e.persistentConnection||this._persistentConnectionOptions,this._socket=n(226)(this._socketEndpoint,e.ioOptions||{}),p["default"].info("Connecting to socket service "+this._socketEndpoint),e.updateUDID?r():this._db.get(":deviceId").then(function(e){e[h["default"].appId]&&(h["default"].UDID=e[h["default"].appId],p["default"].info("Retrieved saved UDID: "+h["default"].UDID)),r()})["catch"](function(){r()}),this._socket.on("message",function(e){i._monitor.processMessage(e)}),this._socket.on("context-update",function(){i.getContexts()}),this._socket.on("disconnect",function(){}),this}},{key:"disconnect",value:function(){var e=this;this._socket.close(),this._socket=null,this._sessionId=null,this.contexts=null,this._monitor.remove({channel:{model:"context"}});for(var t in this.subscriptions)this.subscriptions[t].unsubscribe();this.subscriptions={},this.user.isAdmin||this.user.logout(function(){e.admin.unhook(),e.admin=null,e.user=null}),h["default"].apiKey=null,h["default"].appId=null,h["default"].UDID=null,this._event.emit("disconnect"),this.currentAppId=null,this.connected=!1}},{key:"processMessage",value:function(e){this._monitor.processMessage(e)}},{key:"setLogLevel",value:function(e){return p["default"].setLevel(e),this}},{key:"on",value:function(e,t){return this._event.on(e,t)}},{key:"removeCallback",value:function(e,t){return this._event.removeCallback(e,t)}},{key:"subscribe",value:function(e,t){var n=this,r=new E["default"](this._monitor,e),i=_["default"].subscriptionKeyForOptions(e);return this.subscriptions[i]=r,r.subscribe(),void 0!==t&&r.on("subscribe",t),r.on("_unsubscribe",function(){delete n.subscriptions[i]}),r}},{key:"sendEmail",value:function(e,t,n,r,i,o){h["default"].call("/email",{recipients:n,from:e,from_name:t,subject:r,body:i},function(e,t){e?o((0,g["default"])("Send email failed with error: "+e),null):o(null,t.body.content)})}},{key:"get",value:function(e,t){var n=this;e.no_subscribe=!0,h["default"].call("object/subscribe",e,function(e,r){e?(n._event.emit("error",(0,g["default"])("Get objects failed with error: "+e)),t((0,g["default"])("Get objects failed with error: "+e),null)):t(null,r.body.content)})}}]),e}();t["default"]=S,e.exports=t["default"]}).call(t,n(1))},function(e,t){function n(){l&&u&&(l=!1,u.length?f=u.concat(f):h=-1,f.length&&r())}function r(){if(!l){var e=s(n);l=!0;for(var t=f.length;t;){for(u=f,f=[];++h<t;)u&&u[h].run();h=-1,t=f.length}u=null,l=!1,a(e)}}function i(e,t){this.fun=e,this.array=t}function o(){}var s,a,c=e.exports={};!function(){try{s=setTimeout}catch(e){s=function(){throw new Error("setTimeout is not defined")}}try{a=clearTimeout}catch(e){a=function(){throw new Error("clearTimeout is not defined")}}}();var u,f=[],l=!1,h=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new i(e,t)),1!==f.length||l||s(r,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=o,c.addListener=o,c.once=o,c.off=o,c.removeListener=o,c.removeAllListeners=o,c.emit=o,c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},function(e,t){console.log("I'm `fs` modules")},function(e,t,n){(function(t){"use strict";var r=n(4);e.exports=r,r.ajax=n(10),r.utils=n(7),r.Errors=n(15),r.replicate=n(56).replicate,r.sync=n(65),r.version=n(66);var i=n(67);if(r.adapter("http",i),r.adapter("https",i),r.adapter("idb",n(70),!0),r.adapter("websql",n(76),!0),r.plugin(n(81)),!t.browser){var o=n(88);r.adapter("leveldb",o,!0)}}).call(t,n(1))},function(e,t,n){"use strict";var r=n(5),i=n(7),o=n(19).EventEmitter;r.adapters={},r.preferredAdapters=[],r.prefix="_pouch_";var s=new o,a=["on","addListener","emit","listeners","once","removeAllListeners","removeListener","setMaxListeners"];a.forEach(function(e){r[e]=s[e].bind(s)}),r.setMaxListeners(0),r.parseAdapter=function(e,t){var n,o,s=e.match(/([a-z\-]*):\/\/(.*)/);if(s){if(e=/http(s?)/.test(s[1])?s[1]+"://"+s[2]:s[2],n=s[1],!r.adapters[n].valid())throw"Invalid adapter";return{name:e,adapter:s[1]}}var a="idb"in r.adapters&&"websql"in r.adapters&&i.hasLocalStorage()&&localStorage["_pouch__websqldb_"+r.prefix+e];if(t.adapter)o=t.adapter;else if("undefined"!=typeof t&&t.db)o="leveldb";else for(var c=0;c<r.preferredAdapters.length;++c)if(o=r.preferredAdapters[c],o in r.adapters){if(a&&"idb"===o){console.log('PouchDB is downgrading "'+e+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}n=r.adapters[o];var u=!(n&&"use_prefix"in n)||n.use_prefix;return{name:u?r.prefix+e:e,adapter:o}},r.destroy=i.toPromise(function(e,t,n){console.log("PouchDB.destroy() is deprecated and will be removed. Please use db.destroy() instead."),"function"!=typeof t&&"undefined"!=typeof t||(n=t,t={}),e&&"object"==typeof e&&(t=e,e=void 0),new r(e,t,function(e,t){return e?n(e):void t.destroy(n)})}),r.adapter=function(e,t,n){t.valid()&&(r.adapters[e]=t,n&&r.preferredAdapters.push(e))},r.plugin=function(e){Object.keys(e).forEach(function(t){r.prototype[t]=e[t]})},r.defaults=function(e){function t(t,n,o){"function"!=typeof n&&"undefined"!=typeof n||(o=n,n={}),t&&"object"==typeof t&&(n=t,t=void 0),n=i.extend(!0,{},e,n),r.call(this,t,n,o)}return i.inherits(t,r),t.destroy=i.toPromise(function(t,n,o){return"function"!=typeof n&&"undefined"!=typeof n||(o=n,n={}),t&&"object"==typeof t&&(n=t,t=void 0),n=i.extend(!0,{},e,n),r.destroy(t,n,o)}),a.forEach(function(e){t[e]=s[e].bind(s)}),t.setMaxListeners(10),t.preferredAdapters=r.preferredAdapters.slice(),Object.keys(r).forEach(function(e){e in t||(t[e]=r[e])}),t},e.exports=r},function(e,t,n){(function(t,r){"use strict";function i(e){e&&t.debug&&console.error(e)}function o(e,t,n){if(!(this instanceof o))return new o(e,t,n);var f=this;"function"!=typeof t&&"undefined"!=typeof t||(n=t,t={}),e&&"object"==typeof e&&(t=e,e=void 0),"undefined"==typeof n&&(n=i),e=e||t.name,t=t?a.clone(t):{},delete t.name,this.__opts=t;var l=n;f.auto_compaction=t.auto_compaction,f.prefix=o.prefix,s.call(f),f.taskqueue=new c;var h=new u(function(i,s){n=function(e,t){return e?s(e):(delete t.then,void i(t))},t=a.clone(t);var c,u,l=t.name||e;return function(){try{if("string"!=typeof l)throw u=new Error("Missing/invalid DB name"),u.code=400,u;if(c=o.parseAdapter(l,t),t.originalName=l,t.name=c.name,t.prefix&&"http"!==c.adapter&&"https"!==c.adapter&&(t.name=t.prefix+t.name),t.adapter=t.adapter||c.adapter,f._adapter=t.adapter,f._db_name=l,!o.adapters[t.adapter])throw u=new Error("Adapter is missing"),u.code=404,u;if(!o.adapters[t.adapter].valid())throw u=new Error("Invalid Adapter"),u.code=404,u}catch(e){f.taskqueue.fail(e),f.changes=a.toPromise(function(t){t.complete&&t.complete(e)})}}(),u?s(u):(f.adapter=t.adapter,f.replicate={},f.replicate.from=function(e,t,n){return f.constructor.replicate(e,f,t,n)},f.replicate.to=function(e,t,n){return f.constructor.replicate(f,e,t,n)},f.sync=function(e,t,n){return f.constructor.sync(f,e,t,n)},f.replicate.sync=f.sync,o.adapters[t.adapter].call(f,t,function(e){function r(){o.emit("destroyed",t.originalName),o.emit(t.originalName,"destroyed"),f.removeListener("destroyed",r)}return e?void(n&&(f.taskqueue.fail(e),n(e))):(f.on("destroyed",r),f.emit("created",f),o.emit("created",t.originalName),f.taskqueue.ready(f),void n(null,f))}),t.skipSetup&&(f.taskqueue.ready(f),r.nextTick(function(){n(null,f)})),void(a.isCordova()&&cordova.fireWindowEvent(t.name+"_pouch",{})))});h.then(function(e){l(null,e)},l),f.then=h.then.bind(h),f["catch"]=h["catch"].bind(h)}var s=n(6),a=n(7),c=n(55),u=a.Promise;a.inherits(o,s),o.debug=n(41),e.exports=o}).call(t,function(){return this}(),n(1))},function(e,t,n){(function(t){"use strict";function r(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n)===!0)return e[n];return!1}function i(e){return function(t,n){t||n[0]&&n[0].error?e(t||n[0]):e(null,n.length?n[0]:n)}}function o(e){for(var t=0;t<e.length;t++){var n=e[t];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),i=0;i<r.length;i++){var o=r[i];n._attachments[o]=l.pick(n._attachments[o],["data","digest","content_type","revpos","stub"])}}}function s(e,t){var n=l.compare(e._id,t._id);if(0!==n)return n;var r=e._revisions?e._revisions.start:0,i=t._revisions?t._revisions.start:0;return l.compare(r,i)}function a(e){var t={},n=[];return h.traverseRevTree(e,function(e,r,i,o){var s=r+"-"+i;return e&&(t[s]=0),void 0!==o&&n.push({from:o,to:s}),s}),n.reverse(),n.forEach(function(e){void 0===t[e.from]?t[e.from]=1+t[e.to]:t[e.from]=Math.min(t[e.from],1+t[e.to])}),t}function c(e,t,n){var r="limit"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&r.reverse(),!r.length)return e._allDocs({limit:0},n);var i={offset:t.skip};return y.all(r.map(function(n){var r=l.extend(!0,{key:n,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(e){delete r[e]}),new y(function(t,o){e._allDocs(r,function(e,r){return e?o(e):(i.total_rows=r.total_rows,void t(r.rows[0]||{key:n,error:"not_found"}))})})})).then(function(e){return i.rows=e,i})}function u(e){var n=e._compactionQueue[0],r=n.opts,i=n.callback;e.get("_local/compaction")["catch"](function(){return!1}).then(function(n){n&&n.last_seq&&(r.last_seq=n.last_seq),e._compact(r,function(n,r){n?i(n):i(null,r),t.nextTick(function(){e._compactionQueue.shift(),e._compactionQueue.length&&u(e)})})})}function f(){p.call(this)}var l=n(7),h=n(8),d=n(15),p=n(19).EventEmitter,v=n(50),g=n(52),y=l.Promise;l.inherits(f,p),e.exports=f,f.prototype.post=l.adapterFun("post",function(e,t,n){return"function"==typeof t&&(n=t,t={}),"object"!=typeof e||Array.isArray(e)?n(d.error(d.NOT_AN_OBJECT)):void this.bulkDocs({docs:[e]},t,i(n))}),f.prototype.put=l.adapterFun("put",l.getArguments(function(e){var t,n,r,o,s=e.shift(),a="_id"in s;if("object"!=typeof s||Array.isArray(s))return(o=e.pop())(d.error(d.NOT_AN_OBJECT));for(s=l.clone(s);;)if(t=e.shift(),n=typeof t,"string"!==n||a?"string"!==n||!a||"_rev"in s?"object"===n?r=t:"function"===n&&(o=t):s._rev=t:(s._id=t,a=!0),!e.length)break;r=r||{};var c=l.invalidIdError(s._id);return c?o(c):l.isLocalId(s._id)&&"function"==typeof this._putLocal?s._deleted?this._removeLocal(s,o):this._putLocal(s,o):void this.bulkDocs({docs:[s]},r,i(o))})),f.prototype.putAttachment=l.adapterFun("putAttachment",function(e,t,n,r,i,o){function s(e){return e._attachments=e._attachments||{},e._attachments[t]={content_type:i,data:r},a.put(e)}var a=this;return"function"==typeof i&&(o=i,i=r,r=n,n=null),"undefined"==typeof i&&(i=r,r=n,n=null),a.get(e).then(function(e){if(e._rev!==n)throw d.error(d.REV_CONFLICT);return s(e)},function(t){if(t.reason===d.MISSING_DOC.message)return s({_id:e});throw t})}),f.prototype.removeAttachment=l.adapterFun("removeAttachment",function(e,t,n,r){var i=this;i.get(e,function(e,o){return e?void r(e):o._rev!==n?void r(d.error(d.REV_CONFLICT)):o._attachments?(delete o._attachments[t],0===Object.keys(o._attachments).length&&delete o._attachments,void i.put(o,r)):r()})}),f.prototype.remove=l.adapterFun("remove",function(e,t,n,r){var o;"string"==typeof t?(o={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(o=e,"function"==typeof t?(r=t,n={}):(r=n,n=t)),n=l.clone(n||{}),n.was_delete=!0;var s={_id:o._id,_rev:o._rev||n.rev};return s._deleted=!0,l.isLocalId(s._id)&&"function"==typeof this._removeLocal?this._removeLocal(o,r):void this.bulkDocs({docs:[s]},n,i(r))}),f.prototype.revsDiff=l.adapterFun("revsDiff",function(e,t,n){function r(e,t){a.has(e)||a.set(e,{missing:[]}),a.get(e).missing.push(t)}function i(t,n){var i=e[t].slice(0);h.traverseRevTree(n,function(e,n,o,s,a){var c=n+"-"+o,u=i.indexOf(c);u!==-1&&(i.splice(u,1),"available"!==a.status&&r(t,c))}),i.forEach(function(e){r(t,e)})}"function"==typeof t&&(n=t,t={}),t=l.clone(t);var o=Object.keys(e);if(!o.length)return n(null,{});var s=0,a=new l.Map;o.map(function(t){this._getRevisionTree(t,function(r,c){if(r&&404===r.status&&"missing"===r.message)a.set(t,{missing:e[t]});else{if(r)return n(r);i(t,c)}if(++s===o.length){var u={};return a.forEach(function(e,t){u[t]=e}),n(null,u)}})},this)}),f.prototype.compactDocument=l.adapterFun("compactDocument",function(e,t,n){var r=this;this._getRevisionTree(e,function(i,o){if(i)return n(i);var s=a(o),c=[],u=[];Object.keys(s).forEach(function(e){s[e]>t&&c.push(e)}),h.traverseRevTree(o,function(e,t,n,r,i){var o=t+"-"+n;"available"===i.status&&c.indexOf(o)!==-1&&u.push(o)}),r._doCompaction(e,u,n)})}),f.prototype.compact=l.adapterFun("compact",function(e,t){"function"==typeof e&&(t=e,e={});var n=this;e=l.clone(e||{}),n._compactionQueue=n._compactionQueue||[],n._compactionQueue.push({opts:e,callback:t}),1===n._compactionQueue.length&&u(n)}),f.prototype._compact=function(e,t){function n(e){s.push(i.compactDocument(e.id,0))}function r(e){var n=e.last_seq;y.all(s).then(function(){return v(i,"_local/compaction",function(e){return(!e.last_seq||e.last_seq<n)&&(e.last_seq=n,e)})}).then(function(){t(null,{ok:!0})})["catch"](t)}var i=this,o={returnDocs:!1,last_seq:e.last_seq||0},s=[];i.changes(o).on("change",n).on("complete",r).on("error",t)},f.prototype.get=l.adapterFun("get",function(e,t,n){function i(){var r=[],i=o.length;return i?void o.forEach(function(o){s.get(e,{rev:o,revs:t.revs,attachments:t.attachments},function(e,t){e?r.push({missing:o}):r.push({ok:t}),i--,i||n(null,r)})}):n(null,r)}if("function"==typeof t&&(n=t,t={}),"string"!=typeof e)return n(d.error(d.INVALID_ID));if(l.isLocalId(e)&&"function"==typeof this._getLocal)return this._getLocal(e,n);var o=[],s=this;if(!t.open_revs)return this._get(e,t,function(e,i){if(t=l.clone(t),e)return n(e);var o=i.doc,a=i.metadata,c=i.ctx;if(t.conflicts){var u=h.collectConflicts(a);u.length&&(o._conflicts=u)}if(l.isDeleted(a,o._rev)&&(o._deleted=!0),t.revs||t.revs_info){var f=h.rootToLeaf(a.rev_tree),d=r(f,function(e){return e.ids.map(function(e){return e.id}).indexOf(o._rev.split("-")[1])!==-1}),p=d.ids.map(function(e){return e.id}).indexOf(o._rev.split("-")[1])+1,v=d.ids.length-p;if(d.ids.splice(p,v),d.ids.reverse(),t.revs&&(o._revisions={start:d.pos+d.ids.length-1,ids:d.ids.map(function(e){return e.id})}),t.revs_info){var g=d.pos+d.ids.length;o._revs_info=d.ids.map(function(e){return g--,{rev:g+"-"+e.id,status:e.opts.status}})}}if(t.local_seq&&(l.info('The "local_seq" option is deprecated and will be removed'),o._local_seq=i.metadata.seq),t.attachments&&o._attachments){var y=o._attachments,m=Object.keys(y).length;if(0===m)return n(null,o);Object.keys(y).forEach(function(e){this._getAttachment(y[e],{encode:!0,ctx:c},function(t,r){var i=o._attachments[e];i.data=r,delete i.stub,delete i.length,--m||n(null,o)})},s)}else{if(o._attachments)for(var b in o._attachments)o._attachments.hasOwnProperty(b)&&(o._attachments[b].stub=!0);n(null,o)}});if("all"===t.open_revs)this._getRevisionTree(e,function(e,t){return e?n(e):(o=h.collectLeaves(t).map(function(e){return e.rev}),void i())});else{if(!Array.isArray(t.open_revs))return n(d.error(d.UNKNOWN_ERROR,"function_clause"));o=t.open_revs;for(var a=0;a<o.length;a++){var c=o[a];if("string"!=typeof c||!/^\d+-/.test(c))return n(d.error(d.INVALID_REV))}i()}}),f.prototype.getAttachment=l.adapterFun("getAttachment",function(e,t,n,r){var i=this;n instanceof Function&&(r=n,n={}),n=l.clone(n),this._get(e,n,function(e,o){return e?r(e):o.doc._attachments&&o.doc._attachments[t]?(n.ctx=o.ctx,void i._getAttachment(o.doc._attachments[t],n,r)):r(d.error(d.MISSING_DOC))})}),f.prototype.allDocs=l.adapterFun("allDocs",function(e,t){if("function"==typeof e&&(t=e,e={}),e=l.clone(e),e.skip="undefined"!=typeof e.skip?e.skip:0,"keys"in e){if(!Array.isArray(e.keys))return t(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(t){return t in e})[0];if(n)return void t(d.error(d.QUERY_PARSE_ERROR,"Query parameter `"+n+"` is not compatible with multi-get"));if("http"!==this.type())return c(this,e,t)}return this._allDocs(e,t)}),f.prototype.changes=function(e,t){return"function"==typeof e&&(t=e,e={}),new g(this,e,t)},f.prototype.close=l.adapterFun("close",function(e){return this._closed=!0,this._close(e)}),f.prototype.info=l.adapterFun("info",function(e){var t=this;this._info(function(n,r){return n?e(n):(r.db_name=r.db_name||t._db_name,r.auto_compaction=!(!t.auto_compaction||"http"===t.type()),void e(null,r))})}),f.prototype.id=l.adapterFun("id",function(e){return this._id(e)}),f.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},f.prototype.bulkDocs=l.adapterFun("bulkDocs",function(e,t,n){if("function"==typeof t&&(n=t,t={}),t=l.clone(t),Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return n(d.error(d.MISSING_BULK_DOCS));for(var r=0;r<e.docs.length;++r)if("object"!=typeof e.docs[r]||Array.isArray(e.docs[r]))return n(d.error(d.NOT_AN_OBJECT));return e=l.clone(e),"new_edits"in t||("new_edits"in e?t.new_edits=e.new_edits:t.new_edits=!0),t.new_edits||"http"===this.type()||e.docs.sort(s),o(e.docs),this._bulkDocs(e,t,function(e,r){return e?n(e):(t.new_edits||(r=r.filter(function(e){return e.error})),void n(null,r))})}),f.prototype.registerDependentDatabase=l.adapterFun("registerDependentDatabase",function(e,t){function n(t){return t.dependentDbs=t.dependentDbs||{},!t.dependentDbs[e]&&(t.dependentDbs[e]=!0,t)}var r=new this.constructor(e,this.__opts);v(this,"_local/_pouch_dependentDbs",n,function(e){return e?t(e):t(null,{db:r})})}),f.prototype.destroy=l.adapterFun("destroy",function(e){function t(){n._destroy(function(t,r){return t?e(t):(n.emit("destroyed"),void e(null,r||{ok:!0}))})}var n=this,r=!("use_prefix"in n)||n.use_prefix;n.get("_local/_pouch_dependentDbs",function(i,o){if(i)return 404!==i.status?e(i):t();var s=o.dependentDbs,a=n.constructor,c=Object.keys(s).map(function(e){var t=r?e.replace(new RegExp("^"+a.prefix),""):e;return new a(t,n.__opts).destroy()});y.all(c).then(t,function(t){e(t)})})})}).call(t,n(1))},function(e,t,n){(function(e){function r(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function i(){if(!(this instanceof i))return new i;var e=this;a.call(this),this.isChrome=r(),this._listeners={},this.hasLocal=!1,this.isChrome||(this.hasLocal=t.hasLocalStorage()),this.isChrome?chrome.storage.onChanged.addListener(function(t){null!=t.db_name&&e.emit(t.dbName.newValue)}):this.hasLocal&&("undefined"!=typeof addEventListener?addEventListener("storage",function(t){e.emit(t.key)}):window.attachEvent("storage",function(t){e.emit(t.key)}))}var o=n(8);t.extend=n(9),t.ajax=n(10),t.createBlob=n(12),t.uuid=n(17),t.getArguments=n(18);var s=n(15),a=n(19).EventEmitter,c=n(20);t.Map=c.Map,t.Set=c.Set;var u=n(21),f=n(22);t.Promise=f;var l=n(37);t.atob=l.atob,t.btoa=l.btoa;var h=n(38),d=n(40),p=n(13);t.binaryStringToBlob=h,t.lastIndexOf=function(e,t){for(var n=e.length-1;n>=0;n--)if(e.charAt(n)===t)return n;return-1},t.clone=function(e){return t.extend(!0,{},e)},t.pick=function(e,t){for(var n={},r=0,i=t.length;r<i;r++){var o=t[r];n[o]=e[o]}return n},t.inherits=n(16),t.call=t.getArguments(function(e){if(e.length){var t=e.shift();"function"==typeof t&&t.apply(this,e)}}),t.isLocalId=function(e){return/^_local/.test(e)},t.isDeleted=function(e,t){t||(t=o.winningRev(e));var n=t.indexOf("-");n!==-1&&(t=t.substring(n+1));var r=!1;return o.traverseRevTree(e.rev_tree,function(e,n,i,o,s){i===t&&(r=!!s.deleted)}),r},t.revExists=function(e,t){var n=!1;return o.traverseRevTree(e.rev_tree,function(e,r,i){r+"-"+i===t&&(n=!0)}),n},t.filterChange=function(e){var t={},n=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(r){if(r.doc||(r.doc={}),e.filter&&n&&!e.filter.call(this,r.doc,t))return!1;if(e.include_docs){if(!e.attachments)for(var i in r.doc._attachments)r.doc._attachments.hasOwnProperty(i)&&(r.doc._attachments[i].stub=!0)}else delete r.doc;return!0}},t.parseDoc=u.parseDoc,t.invalidIdError=u.invalidIdError,t.isCordova=function(){return"undefined"!=typeof cordova||"undefined"!=typeof PhoneGap||"undefined"!=typeof phonegap},t.hasLocalStorage=function(){if(r())return!1;try{return localStorage}catch(e){return!1}},t.Changes=i,t.inherits(i,a),i.prototype.addListener=function(n,r,i,o){function s(){if(a._listeners[r]){if(c)return void(c="waiting");c=!0,i.changes({style:o.style,include_docs:o.include_docs,attachments:o.attachments,conflicts:o.conflicts,continuous:!1,descending:!1,filter:o.filter,doc_ids:o.doc_ids,view:o.view,since:o.since,query_params:o.query_params}).on("change",function(e){e.seq>o.since&&!o.cancelled&&(o.since=e.seq,t.call(o.onChange,e))}).on("complete",function(){"waiting"===c&&e.nextTick(function(){a.notify(n)}),c=!1}).on("error",function(){c=!1})}}if(!this._listeners[r]){var a=this,c=!1;this._listeners[r]=s,this.on(n,s)}},i.prototype.removeListener=function(e,t){t in this._listeners&&a.prototype.removeListener.call(this,e,this._listeners[t])},i.prototype.notifyLocalWindows=function(e){this.isChrome?chrome.storage.local.set({dbName:e}):this.hasLocal&&(localStorage[e]="a"===localStorage[e]?"b":"a")},i.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},t.once=function(e){var n=!1;return t.getArguments(function(t){if(n)throw new Error("once called  more than once");n=!0,e.apply(this,t)})},t.toPromise=function(n){return t.getArguments(function(r){var i,o=this,s="function"==typeof r[r.length-1]&&r.pop();s&&(i=function(t,n){e.nextTick(function(){s(t,n)})});var a=new f(function(e,i){var s;try{var a=t.once(function(t,n){t?i(t):e(n)});r.push(a),s=n.apply(o,r),s&&"function"==typeof s.then&&e(s)}catch(c){i(c)}});return i&&a.then(function(e){i(null,e)},i),a.cancel=function(){return this},a})},t.adapterFun=function(e,r){function i(e,t,n){if(o.enabled){for(var r=[e._db_name,t],i=0;i<n.length-1;i++)r.push(n[i]);o.apply(null,r);var s=n[n.length-1];n[n.length-1]=function(n,r){var i=[e._db_name,t];i=i.concat(n?["error",n]:["success",r]),o.apply(null,i),s(n,r)}}}var o=n(41)("pouchdb:api");return t.toPromise(t.getArguments(function(t){if(this._closed)return f.reject(new Error("database is closed"));var n=this;return i(n,e,t),this.taskqueue.isReady?r.apply(this,t):new f(function(r,i){n.taskqueue.addTask(function(o){o?i(o):r(n[e].apply(n,t))})})}))},t.cancellableFun=function(e,n,r){r=r?t.clone(!0,{},r):{};var i=new a,o=r.complete||function(){},s=r.complete=t.once(function(e,t){e?o(e):(i.emit("end",t),o(null,t)),i.removeAllListeners()}),c=r.onChange||function(){},u=0;n.on("destroyed",function(){i.removeAllListeners()}),r.onChange=function(e){c(e),e.seq<=u||(u=e.seq,i.emit("change",e),e.deleted?i.emit("delete",e):1===e.changes.length&&"1-"===e.changes[0].rev.slice(0,1)?i.emit("create",e):i.emit("update",e))};var l=new f(function(e,t){r.complete=function(n,r){n?t(n):e(r)}});return l.then(function(e){s(null,e)},s),l.cancel=function(){l.isCancelled=!0,n.taskqueue.isReady&&r.complete(null,{status:"cancelled"})},n.taskqueue.isReady?e(n,r,l):n.taskqueue.addTask(function(){l.isCancelled?r.complete(null,{status:"cancelled"}):e(n,r,l)}),l.on=i.on.bind(i),l.once=i.once.bind(i),l.addListener=i.addListener.bind(i),l.removeListener=i.removeListener.bind(i),l.removeAllListeners=i.removeAllListeners.bind(i),l.setMaxListeners=i.setMaxListeners.bind(i),l.listeners=i.listeners.bind(i),l.emit=i.emit.bind(i),l},t.MD5=t.toPromise(n(44)),t.explain404=n(47),t.info=function(e){"undefined"!=typeof console&&"info"in console&&console.info(e)},t.parseUri=n(48),t.compare=function(e,t){return e<t?-1:e>t?1:0},t.updateDoc=function(e,n,r,i,a,c,u){if(t.revExists(e,n.metadata.rev))return r[i]=n,a();var f=o.winningRev(e),l=t.isDeleted(e,f),h=t.isDeleted(n.metadata),d=/^1-/.test(n.metadata.rev);if(l&&!h&&u&&d){var p=n.data;p._rev=f,p._id=n.metadata.id,n=t.parseDoc(p,u)}var v=o.merge(e.rev_tree,n.metadata.rev_tree[0],1e3),g=u&&(l&&h||!l&&"new_leaf"!==v.conflicts||l&&!h&&"new_branch"===v.conflicts);if(g){var y=s.error(s.REV_CONFLICT);return r[i]=y,a()}var m=n.metadata.rev;n.metadata.rev_tree=v.tree,e.rev_map&&(n.metadata.rev_map=e.rev_map);var b=o.winningRev(n.metadata),_=t.isDeleted(n.metadata,b),w=l===_?0:l<_?-1:1,E=t.isDeleted(n.metadata,m);c(n,b,_,E,!0,w,i,a)},t.processDocs=function(e,n,r,i,a,c,u,f){function l(e,n,r){var i=o.winningRev(e.metadata),f=t.isDeleted(e.metadata,i);if("was_delete"in u&&f)return a[n]=s.error(s.MISSING_DOC,"deleted"),r();var l=f?0:1;c(e,i,f,f,!1,l,n,r)}function h(){++v===g&&f&&f()}if(e.length){var d=u.new_edits,p=new t.Map,v=0,g=e.length;e.forEach(function(e,r){if(e._id&&t.isLocalId(e._id))return void n[e._deleted?"_removeLocal":"_putLocal"](e,{ctx:i},function(e){e?a[r]=e:a[r]={ok:!0},h()});var o=e.metadata.id;p.has(o)?(g--,p.get(o).push([e,r])):p.set(o,[[e,r]])}),p.forEach(function(e,n){function i(){++s<e.length?o():h()}function o(){var o=e[s],u=o[0],f=o[1];r.has(n)?t.updateDoc(r.get(n),u,a,f,i,c,d):l(u,f,i)}var s=0;o()})}},t.preprocessAttachments=function(e,n,r){function i(e){try{return l.atob(e)}catch(t){var n=s.error(s.BAD_ARG,"Attachments need to be base64 encoded");return{error:n}}}function o(e,r){if(e.stub)return r();if("string"==typeof e.data){
var o=i(e.data);if(o.error)return r(o.error);e.length=o.length,"blob"===n?e.data=h(o,e.content_type):"base64"===n?e.data=l.btoa(o):e.data=o,t.MD5(o).then(function(t){e.digest="md5-"+t,r()})}else p(e.data,function(i){"binary"===n?e.data=d(i):"base64"===n&&(e.data=l.btoa(d(i))),t.MD5(i).then(function(t){e.digest="md5-"+t,e.length=i.byteLength,r()})})}function a(){u++,e.length===u&&(c?r(c):r())}if(!e.length)return r();var c,u=0;e.forEach(function(e){function t(e){c=e,r++,r===n.length&&a()}var n=e.data&&e.data._attachments?Object.keys(e.data._attachments):[],r=0;if(!n.length)return a();for(var i in e.data._attachments)e.data._attachments.hasOwnProperty(i)&&o(e.data._attachments[i],t)})},t.compactTree=function(e){var t=[];return o.traverseRevTree(e.rev_tree,function(e,n,r,i,o){"available"!==o.status||e||(t.push(n+"-"+r),o.status="missing")}),t};var v=n(49);t.safeJsonParse=function(e){try{return JSON.parse(e)}catch(t){return v.parse(e)}},t.safeJsonStringify=function(e){try{return JSON.stringify(e)}catch(t){return v.stringify(e)}}}).call(t,n(1))},function(e,t,n){"use strict";function r(e,t,n){for(var r,i=0,o=e.length;i<o;)r=i+o>>>1,n(e[r],t)<0?i=r+1:o=r;return i}function i(e,t,n){var i=r(e,t,n);e.splice(i,0,t)}function o(e){for(var t,n=e.shift(),r=[n.id,n.opts,[]],i=r;e.length;)n=e.shift(),t=[n.id,n.opts,[]],i[2].push(t),i=t;return r}function s(e,t){return e[0]<t[0]?-1:1}function a(e,t){for(var n=[{tree1:e,tree2:t}],r=!1;n.length>0;){var o=n.pop(),a=o.tree1,c=o.tree2;(a[1].status||c[1].status)&&(a[1].status="available"===a[1].status||"available"===c[1].status?"available":"missing");for(var u=0;u<c[2].length;u++)if(a[2][0]){for(var f=!1,l=0;l<a[2].length;l++)a[2][l][0]===c[2][u][0]&&(n.push({tree1:a[2][l],tree2:c[2][u]}),f=!0);f||(r="new_branch",i(a[2],c[2][u],s))}else r="new_leaf",a[2][0]=c[2][u]}return{conflicts:r,tree:e}}function c(e,t,n){var r,i=[],o=!1,s=!1;return e.length?(e.forEach(function(e){if(e.pos===t.pos&&e.ids[0]===t.ids[0])r=a(e.ids,t.ids),i.push({pos:e.pos,ids:r.tree}),o=o||r.conflicts,s=!0;else if(n!==!0){var c=e.pos<t.pos?e:t,u=e.pos<t.pos?t:e,f=u.pos-c.pos,l=[],h=[];for(h.push({ids:c.ids,diff:f,parent:null,parentIdx:null});h.length>0;){var d=h.pop();0!==d.diff?d.ids&&d.ids[2].forEach(function(e,t){h.push({ids:e,diff:d.diff-1,parent:d.ids,parentIdx:t})}):d.ids[0]===u.ids[0]&&l.push(d)}var p=l[0];p?(r=a(p.ids,u.ids),p.parent[2][p.parentIdx]=r.tree,i.push({pos:c.pos,ids:c.ids}),o=o||r.conflicts,s=!0):i.push(e)}else i.push(e)}),s||i.push(t),i.sort(function(e,t){return e.pos-t.pos}),{tree:i,conflicts:o||"internal_node"}):{tree:[t],conflicts:"new_leaf"}}function u(e,t){var n=l.rootToLeaf(e).map(function(e){var n=e.ids.slice(-t);return{pos:e.pos+(e.ids.length-n.length),ids:o(n)}});return n.reduce(function(e,t){return c(e,t,!0).tree},[n.shift()])}var f=n(9),l={};l.merge=function(e,t,n){e=f(!0,[],e),t=f(!0,{},t);var r=c(e,t);return{tree:u(r.tree,n),conflicts:r.conflicts}},l.winningRev=function(e){var t=[];return l.traverseRevTree(e.rev_tree,function(e,n,r,i,o){e&&t.push({pos:n,id:r,deleted:!!o.deleted})}),t.sort(function(e,t){return e.deleted!==t.deleted?e.deleted>t.deleted?1:-1:e.pos!==t.pos?t.pos-e.pos:e.id<t.id?1:-1}),t[0].pos+"-"+t[0].id},l.traverseRevTree=function(e,t){for(var n,r=e.slice();n=r.pop();)for(var i=n.pos,o=n.ids,s=o[2],a=t(0===s.length,i,o[0],n.ctx,o[1]),c=0,u=s.length;c<u;c++)r.push({pos:i+1,ids:s[c],ctx:a})},l.collectLeaves=function(e){var t=[];return l.traverseRevTree(e,function(e,n,r,i,o){e&&t.push({rev:n+"-"+r,pos:n,opts:o})}),t.sort(function(e,t){return t.pos-e.pos}),t.forEach(function(e){delete e.pos}),t},l.collectConflicts=function(e){var t=l.winningRev(e),n=l.collectLeaves(e.rev_tree),r=[];return n.forEach(function(e){e.rev===t||e.opts.deleted||r.push(e.rev)}),r},l.rootToLeaf=function(e){var t=[];return l.traverseRevTree(e,function(e,n,r,i,o){if(i=i?i.slice(0):[],i.push({id:r,opts:o}),e){var s=n+1-i.length;t.unshift({pos:s,ids:i})}return i}),t},e.exports=l},function(e,t){"use strict";function n(e){return null===e?String(e):"object"==typeof e||"function"==typeof e?c[h.call(e)]||"object":typeof e}function r(e){return null!==e&&e===e.window}function i(e){if(!e||"object"!==n(e)||e.nodeType||r(e))return!1;try{if(e.constructor&&!d.call(e,"constructor")&&!d.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var i;for(i in e);return void 0===i||d.call(e,i)}function o(e){return"function"===n(e)}function s(){for(var e=[],t=-1,n=arguments.length,r=new Array(n);++t<n;)r[t]=arguments[t];var i={};e.push({args:r,result:{container:i,key:"key"}});for(var o;o=e.pop();)a(e,o.args,o.result);return i.key}function a(e,t,n){var r,s,a,c,u,f,l,h=t[0]||{},d=1,v=t.length,g=!1,y=/\d+/;for("boolean"==typeof h&&(g=h,h=t[1]||{},d=2),"object"==typeof h||o(h)||(h={}),v===d&&(h=this,--d);d<v;d++)if(null!=(r=t[d])){l=p(r);for(s in r)if(!(s in Object.prototype)){if(l&&!y.test(s))continue;if(a=h[s],c=r[s],h===c)continue;g&&c&&(i(c)||(u=p(c)))?(u?(u=!1,f=a&&p(a)?a:[]):f=a&&i(a)?a:{},e.push({args:[g,f,c],result:{container:h,key:s}})):void 0!==c&&(p(r)&&o(c)||(h[s]=c))}}n.container[n.key]=h}for(var c={},u=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],f=0;f<u.length;f++){var l=u[f];c["[object "+l+"]"]=l.toLowerCase()}var h=c.toString,d=c.hasOwnProperty,p=Array.isArray||function(e){return"array"===n(e)};e.exports=s},function(e,t,n){(function(t){"use strict";function r(e,n){function r(t,n,r){if(e.binary||e.json||!e.processData||"string"==typeof t){if(!e.binary&&e.json&&"string"==typeof t)try{t=JSON.parse(t)}catch(i){return r(i)}}else t=JSON.stringify(t);Array.isArray(t)&&(t=t.map(function(e){return e.error||e.missing?s.generateErrorFromResponse(e):e})),r(null,t,n)}function c(e,t){var n,r;if(e.code&&e.status){var i=new Error(e.message||e.code);return i.status=e.status,t(i)}try{n=JSON.parse(e.responseText),r=s.generateErrorFromResponse(n)}catch(o){r=s.generateErrorFromResponse(e)}t(r)}function u(e){return t.browser?"":new o("","binary")}var f=!1,l=a.getArguments(function(e){f||(n.apply(this,e),f=!0)});"function"==typeof e&&(l=e,e={}),e=a.clone(e);var h={method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1};return e=a.extend(!0,h,e),e.json&&(e.binary||(e.headers.Accept="application/json"),e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json"),e.binary&&(e.encoding=null,e.json=!1),e.processData||(e.json=!1),i(e,function(t,n,i){if(t)return t.status=n?n.statusCode:400,c(t,l);var o,a=n.headers&&n.headers["content-type"],f=i||u();e.binary||!e.json&&e.processData||"object"==typeof f||!(/json/.test(a)||/^[\s]*\{/.test(f)&&/\}[\s]*$/.test(f))||(f=JSON.parse(f)),n.statusCode>=200&&n.statusCode<300?r(f,n,l):(e.binary&&(f=JSON.parse(f.toString())),o=s.generateErrorFromResponse(f),o.status=n.statusCode,l(o))})}var i=n(11),o=n(14),s=n(15),a=n(7);e.exports=r}).call(t,n(1))},function(e,t,n){"use strict";function r(){for(var e={},t=new c.Promise(function(t,n){e.resolve=t,e.reject=n}),n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.promise=t,c.Promise.resolve().then(function(){return fetch.apply(null,n)}).then(function(t){e.resolve(t)})["catch"](function(t){e.reject(t)}),e}function i(e,t){var n,i,o,s=new Headers,a={method:e.method,credentials:"include",headers:s};return e.json&&(s.set("Accept","application/json"),s.set("Content-Type",e.headers["Content-Type"]||"application/json")),e.body&&e.body instanceof Blob?u(e.body,function(e){a.body=e}):e.body&&e.processData&&"string"!=typeof e.body?a.body=JSON.stringify(e.body):"body"in e?a.body=e.body:a.body=null,Object.keys(e.headers).forEach(function(t){e.headers.hasOwnProperty(t)&&s.set(t,e.headers[t])}),n=r(e.url,a),e.timeout>0&&(i=setTimeout(function(){n.reject(new Error("Load timeout for resource: "+e.url))},e.timeout)),n.promise.then(function(t){return o={statusCode:t.status},e.timeout>0&&clearTimeout(i),o.statusCode>=200&&o.statusCode<300?e.binary?t.blob():t.text():t.json()}).then(function(e){o.statusCode>=200&&o.statusCode<300?t(null,o,e):t(e,o)})["catch"](function(e){t(e,o)}),{abort:n.reject}}function o(e,t){var n,r,i,o=function(){n.abort()};if(n=e.xhr?new e.xhr:new XMLHttpRequest,"GET"===e.method&&!e.cache){var s=e.url.indexOf("?")!==-1;e.url+=(s?"&":"?")+"_nonce="+Date.now()}n.open(e.method,e.url),n.withCredentials=!0,"GET"===e.method?delete e.headers["Content-Type"]:e.json&&(e.headers.Accept="application/json",e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json",e.body&&e.processData&&"string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.binary&&(n.responseType="arraybuffer"),"body"in e||(e.body=null);for(var c in e.headers)e.headers.hasOwnProperty(c)&&n.setRequestHeader(c,e.headers[c]);return e.timeout>0&&(r=setTimeout(o,e.timeout),n.onprogress=function(){clearTimeout(r),r=setTimeout(o,e.timeout)},"undefined"==typeof i&&(i=Object.keys(n).indexOf("upload")!==-1&&"undefined"!=typeof n.upload),i&&(n.upload.onprogress=n.onprogress)),n.onreadystatechange=function(){if(4===n.readyState){var r={statusCode:n.status};if(n.status>=200&&n.status<300){var i;i=e.binary?a([n.response||""],{type:n.getResponseHeader("Content-Type")}):n.responseText,t(null,r,i)}else{var o={};try{o=JSON.parse(n.response)}catch(s){}t(o,r)}}},e.body&&e.body instanceof Blob?u(e.body,function(e){n.send(e)}):n.send(e.body),{abort:o}}function s(){try{return new XMLHttpRequest,!0}catch(e){return!1}}var a=n(12),c=n(7),u=n(13),f=s();e.exports=function(e,t){return f||e.xhr?o(e,t):i(e,t)}},function(e,t){(function(t){"use strict";function n(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(r){if("TypeError"!==r.name)throw r;for(var i=t.BlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder||t.WebKitBlobBuilder,o=new i,s=0;s<e.length;s+=1)o.append(e[s]);return o.getBlob(n.type)}}e.exports=n}).call(t,function(){return this}())},function(e,t){"use strict";e.exports=function(e,t){var n=new FileReader;n.onloadend=function(e){var n=e.target.result||new ArrayBuffer(0);t(n)},n.readAsArrayBuffer(e)}},function(e,t){e.exports={}},function(e,t,n){"use strict";function r(e){Error.call(e.reason),this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}var i=n(16);i(r,Error),r.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message})},t.UNAUTHORIZED=new r({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),t.MISSING_BULK_DOCS=new r({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),t.MISSING_DOC=new r({status:404,error:"not_found",reason:"missing"}),t.REV_CONFLICT=new r({status:409,error:"conflict",reason:"Document update conflict"}),t.INVALID_ID=new r({status:400,error:"invalid_id",reason:"_id field must contain a string"}),t.MISSING_ID=new r({status:412,error:"missing_id",reason:"_id is required for puts"}),t.RESERVED_ID=new r({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),t.NOT_OPEN=new r({status:412,error:"precondition_failed",reason:"Database not open"}),t.UNKNOWN_ERROR=new r({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),t.BAD_ARG=new r({status:500,error:"badarg",reason:"Some query argument is invalid"}),t.INVALID_REQUEST=new r({status:400,error:"invalid_request",reason:"Request was invalid"}),t.QUERY_PARSE_ERROR=new r({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),t.DOC_VALIDATION=new r({status:500,error:"doc_validation",reason:"Bad special document member"}),t.BAD_REQUEST=new r({status:400,error:"bad_request",reason:"Something wrong with the request"}),t.NOT_AN_OBJECT=new r({status:400,error:"bad_request",reason:"Document must be a JSON object"}),t.DB_MISSING=new r({status:404,error:"not_found",reason:"Database not found"}),t.IDB_ERROR=new r({status:500,error:"indexed_db_went_bad",reason:"unknown"}),t.WSQ_ERROR=new r({status:500,error:"web_sql_went_bad",reason:"unknown"}),t.LDB_ERROR=new r({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),t.FORBIDDEN=new r({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),t.INVALID_REV=new r({status:400,error:"bad_request",reason:"Invalid rev format"}),t.FILE_EXISTS=new r({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),t.MISSING_STUB=new r({status:412,error:"missing_stub"}),t.error=function(e,t,n){function i(t){for(var r in e)"function"!=typeof e[r]&&(this[r]=e[r]);void 0!==n&&(this.name=n),void 0!==t&&(this.reason=t)}return i.prototype=r.prototype,new i(t)},t.getErrorTypeByProp=function(e,n,r){var i=t,o=Object.keys(i).filter(function(t){var r=i[t];return"function"!=typeof r&&r[e]===n}),s=r&&o.filter(function(e){var t=i[e];return t.message===r})[0]||o[0];return s?i[s]:null},t.generateErrorFromResponse=function(e){var n,r,i,o,s,a=t;return r=e.error===!0&&"string"==typeof e.name?e.name:e.error,s=e.reason,i=a.getErrorTypeByProp("name",r,s),e.missing||"missing"===s||"deleted"===s||"not_found"===r?i=a.MISSING_DOC:"doc_validation"===r?(i=a.DOC_VALIDATION,o=s):"bad_request"===r&&i.message!==s&&(0===s.indexOf("unknown stub attachment")?(i=a.MISSING_STUB,o=s):i=a.BAD_REQUEST),i||(i=a.getErrorTypeByProp("status",e.status,s)||a.UNKNOWN_ERROR),n=a.error(i,s,r),o&&(n.message=o),e.id&&(n.id=e.id),e.status&&(n.status=e.status),e.statusText&&(n.name=e.statusText),e.missing&&(n.missing=e.missing),n}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){"use strict";function n(e){return 0|Math.random()*e}function r(e,t){t=t||i.length;var r="",o=-1;if(e){for(;++o<e;)r+=i[n(t)];return r}for(;++o<36;)switch(o){case 8:case 13:case 18:case 23:r+="-";break;case 19:r+=i[3&n(16)|8];break;default:r+=i[n(16)]}return r}/*!
	Math.uuid.js (v1.4)
	http://www.broofa.com
	mailto:robert@broofa.com
	
	Copyright (c) 2010 Robert Kieffer
	Dual licensed under the MIT and GPL licenses.
	*/
var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");e.exports=r},function(e,t){"use strict";function n(e){return function(){var t=arguments.length;if(t){for(var n=[],r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}return e.call(this,[])}}e.exports=n},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,a,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(n=this._events[e],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(o(n))for(a=Array.prototype.slice.call(arguments,1),u=n.slice(),i=u.length,c=0;c<i;c++)u[c].apply(this,a);return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,s,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){"use strict";function n(){this.store={}}function r(e){if(this.store=new n,e&&Array.isArray(e))for(var t=0,r=e.length;t<r;t++)this.add(e[t])}t.Map=n,t.Set=r,n.prototype.mangle=function(e){if("string"!=typeof e)throw new TypeError("key must be a string but Got "+e);return"$"+e},n.prototype.unmangle=function(e){return e.substring(1)},n.prototype.get=function(e){var t=this.mangle(e);if(t in this.store)return this.store[t]},n.prototype.set=function(e,t){var n=this.mangle(e);return this.store[n]=t,!0},n.prototype.has=function(e){var t=this.mangle(e);return t in this.store},n.prototype["delete"]=function(e){var t=this.mangle(e);return t in this.store&&(delete this.store[t],!0)},n.prototype.forEach=function(e){for(var t=Object.keys(this.store),n=0,r=t.length;n<r;n++){var i=t[n],o=this.store[i];i=this.unmangle(i),e(o,i)}},r.prototype.add=function(e){return this.store.set(e,!0)},r.prototype.has=function(e){return this.store.has(e)},r.prototype["delete"]=function(e){return this.store["delete"](e)}},function(e,t,n){"use strict";function r(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}function i(e){if(!/^\d+\-./.test(e))return s.error(s.INVALID_REV);var t=e.indexOf("-"),n=e.substring(0,t),r=e.substring(t+1);return{prefix:parseInt(n,10),id:r}}function o(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,i=[r[0],t,[]],o=1,s=r.length;o<s;o++)i=[r[o],{status:"missing"},[i]];return[{pos:n,ids:i}]}var s=n(15),a=n(17),c=r(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),u=r(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);t.invalidIdError=function(e){var t;if(e?"string"!=typeof e?t=s.error(s.INVALID_ID):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=s.error(s.RESERVED_ID)):t=s.error(s.MISSING_ID),t)throw t},t.parseDoc=function(e,n){var r,f,l,h={status:"available"};if(e._deleted&&(h.deleted=!0),n)if(e._id||(e._id=a()),f=a(32,16).toLowerCase(),e._rev){if(l=i(e._rev),l.error)return l;e._rev_tree=[{pos:l.prefix,ids:[l.id,{status:"missing"},[[f,h,[]]]]}],r=l.prefix+1}else e._rev_tree=[{pos:1,ids:[f,h,[]]}],r=1;else if(e._revisions&&(e._rev_tree=o(e._revisions,h),r=e._revisions.start,f=e._revisions.ids[0]),!e._rev_tree){if(l=i(e._rev),l.error)return l;r=l.prefix,f=l.id,e._rev_tree=[{pos:r,ids:[f,h,[]]}]}t.invalidIdError(e._id),e._rev=r+"-"+f;var d={metadata:{},data:{}};for(var p in e)if(e.hasOwnProperty(p)){var v="_"===p[0];if(v&&!c[p]){var g=s.error(s.DOC_VALIDATION,p);throw g.message=s.DOC_VALIDATION.message+": "+p,g}v&&!u[p]?d.metadata[p.slice(1)]=e[p]:d.data[p]=e[p]}return d}},function(e,t,n){"use strict";"function"==typeof Promise?e.exports=Promise:e.exports=n(23)},function(e,t,n){e.exports=t=n(24),t.resolve=n(33),t.reject=n(34),t.all=n(35),t.race=n(36)},function(e,t,n){(function(t){"use strict";function r(e){if(!(this instanceof r))return new r(e);if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=a.PENDING,this.queue=[],this.outcome=void 0,t.browser||(this.handled=a.UNHANDLED),e!==o&&s.safely(this,e)}var i=n(25),o=n(31),s=n(29),a=n(30),c=n(32);e.exports=r,r.prototype["catch"]=function(e){return this.then(null,e)},r.prototype.then=function(e,n){if("function"!=typeof e&&this.state===a.FULFILLED||"function"!=typeof n&&this.state===a.REJECTED)return this;var s=new r(o);if(t.browser||"function"==typeof n&&this.handled===a.UNHANDLED&&(this.handled=this.HANDLED),this.state!==a.PENDING){var u=this.state===a.FULFILLED?e:n;i(s,u,this.outcome)}else this.queue.push(new c(s,e,n));return s}}).call(t,n(1))},function(e,t,n){"use strict";function r(e,t,n){i(function(){var r;try{r=t(n)}catch(i){return o.reject(e,i)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)})}var i=n(26),o=n(27);e.exports=r},function(e,t,n){(function(t,n){"use strict";function r(){l=!0;for(var e,t,n=h.length;n;){for(t=h,h=[],e=-1;++e<n;)t[e]();n=h.length}l=!1}function i(e){1!==h.push(e)||l||o()}var o,s=t.MutationObserver||t.WebKitMutationObserver;if(n.browser)if(s){var a=0,c=new s(r),u=t.document.createTextNode("");c.observe(u,{characterData:!0}),o=function(){u.data=a=++a%2}}else if(t.setImmediate||"undefined"==typeof t.MessageChannel)o="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){r(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(r,0)};else{var f=new t.MessageChannel;f.port1.onmessage=r,o=function(){f.port2.postMessage(0)}}else o=function(){n.nextTick(r)};var l,h=[];e.exports=i}).call(t,function(){return this}(),n(1))},function(e,t,n){(function(e){"use strict";function r(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}var i=n(28),o=n(29),s=n(30);t.resolve=function(e,n){var a=i(r,n);if("error"===a.status)return t.reject(e,a.value);var c=a.value;if(c)o.safely(e,c);else{e.state=s.FULFILLED,e.outcome=n;for(var u=-1,f=e.queue.length;++u<f;)e.queue[u].callFulfilled(n)}return e},t.reject=function(t,r){t.state=s.REJECTED,t.outcome=r,e.browser||t.handled===s.UNHANDLED&&n(26)(function(){t.handled===s.UNHANDLED&&e.emit("unhandledRejection",r,t)});for(var i=-1,o=t.queue.length;++i<o;)t.queue[i].callRejected(r);return t}}).call(t,n(1))},function(e,t){"use strict";function n(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}e.exports=n},function(e,t,n){"use strict";function r(e,t){function n(t){a||(a=!0,i.reject(e,t))}function r(t){a||(a=!0,i.resolve(e,t))}function s(){t(r,n)}var a=!1,c=o(s);"error"===c.status&&n(c.value)}var i=n(27),o=n(28);t.safely=r},function(e,t,n){(function(e){t.REJECTED=["REJECTED"],t.FULFILLED=["FULFILLED"],t.PENDING=["PENDING"],e.browser||(t.UNHANDLED=["UNHANDLED"],t.HANDLED=["HANDLED"])}).call(t,n(1))},function(e,t){"use strict";function n(){}e.exports=n},function(e,t,n){"use strict";function r(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}var i=n(27),o=n(25);e.exports=r,r.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},r.prototype.otherCallFulfilled=function(e){o(this.promise,this.onFulfilled,e)},r.prototype.callRejected=function(e){i.reject(this.promise,e)},r.prototype.otherCallRejected=function(e){o(this.promise,this.onRejected,e)}},function(e,t,n){"use strict";function r(e){if(e)return e instanceof i?e:s.resolve(new i(o),e);var t=typeof e;switch(t){case"boolean":return a;case"undefined":return u;case"object":return c;case"number":return f;case"string":return l}}var i=n(24),o=n(31),s=n(27);e.exports=r;var a=s.resolve(new i(o),!1),c=s.resolve(new i(o),null),u=s.resolve(new i(o),void 0),f=s.resolve(new i(o),0),l=s.resolve(new i(o),"")},function(e,t,n){"use strict";function r(e){var t=new i(o);return s.reject(t,e)}var i=n(24),o=n(31),s=n(27);e.exports=r},function(e,t,n){"use strict";function r(e){function t(e,t){function i(e){u[t]=e,++f===n&!r&&(r=!0,c.resolve(h,u))}s(e).then(i,function(e){r||(r=!0,c.reject(h,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return o(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return s([]);for(var u=new Array(n),f=0,l=-1,h=new i(a);++l<n;)t(e[l],l);return h}var i=n(24),o=n(34),s=n(33),a=n(31),c=n(27);e.exports=r},function(e,t,n){"use strict";function r(e){function t(e){s(e).then(function(e){r||(r=!0,c.resolve(f,e))},function(e){r||(r=!0,c.reject(f,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return o(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return s([]);for(var u=-1,f=new i(a);++u<n;)t(e[u]);return f}var i=n(24),o=n(34),s=n(33),a=n(31),c=n(27);e.exports=r},function(e,t,n){"use strict";var r=n(14);"function"==typeof atob?t.atob=function(e){return atob(e)}:t.atob=function(e){var t=new r(e,"base64");if(t.toString("base64")!==e)throw"Cannot base64 encode full string";return t.toString("binary")},"function"==typeof btoa?t.btoa=function(e){return btoa(e)}:t.btoa=function(e){return new r(e,"binary").toString("base64")}},function(e,t,n){"use strict";var r=n(12),i=n(39);e.exports=function(e,t){return r([i(e)],{type:t})}},function(e,t){"use strict";e.exports=function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}},function(e,t){"use strict";e.exports=function(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,i=0;i<r;i++)t+=String.fromCharCode(n[i]);return t}},function(e,t,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,r),e}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}}function a(){var e;try{e=t.storage.debug}catch(n){}return e}function c(){try{return window.localStorage}catch(e){}}t=e.exports=n(42),t.log=o,t.formatArgs=i,t.save=s,t.load=a,t.useColors=r,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(a())},function(e,t,n){function r(){return t.colors[f++%t.colors.length]}function i(e){function n(){}function i(){var e=i,n=+new Date,o=n-(u||n);e.diff=o,e.prev=u,e.curr=n,u=n,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=r());var s=Array.prototype.slice.call(arguments);s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(n,r){if("%%"===n)return n;a++;var i=t.formatters[r];if("function"==typeof i){var o=s[a];n=i.call(e,o),s.splice(a,1),a--}return n}),"function"==typeof t.formatArgs&&(s=t.formatArgs.apply(e,s));var c=i.log||t.log||console.log.bind(console);c.apply(e,s)}n.enabled=!1,i.enabled=!0;var o=t.enabled(e)?i:n;return o.namespace=e,o}function o(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&(e=n[i].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function s(){t.enable("")}function a(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=i,t.coerce=c,t.disable=s,t.enable=o,t.enabled=a,t.humanize=n(43),t.names=[],t.skips=[],t.formatters={};var u,f=0},function(e,t){function n(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*f;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*a;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function r(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=a?Math.round(e/a)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function i(e){return o(e,u,"day")||o(e,c,"hour")||o(e,a,"minute")||o(e,s,"second")||e+" ms"}function o(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var s=1e3,a=60*s,c=60*a,u=24*c,f=365.25*u;e.exports=function(e,t){return t=t||{},"string"==typeof e?n(e):t["long"]?i(e):r(e)}},function(e,t,n){(function(t,r){"use strict";function i(e){return String.fromCharCode(255&e)+String.fromCharCode(e>>>8&255)+String.fromCharCode(e>>>16&255)+String.fromCharCode(e>>>24&255)}function o(e){for(var t="",n=0,r=e.length;n<r;n++)t+=i(e[n]);return c.btoa(t)}function s(e,t,n,r){(n>0||r<t.byteLength)&&(t=new Uint8Array(t,n,Math.min(r,t.byteLength)-n)),e.append(t)}function a(e,t,n,r){(n>0||r<t.length)&&(t=t.substring(n,r)),e.appendBinary(t)}var c=n(37),u=n(45),f=n(46),l=t.setImmediate||t.setTimeout,h=32768;e.exports=function(e,t){function n(){var r=g*p,i=r+p;if(g++,g<v)m(y,e,r,i),l(n);else{m(y,e,r,i);var s=y.end(!0),a=o(s);t(null,a),y.destroy()}}if(!r.browser){var i=u.createHash("md5").update(e).digest("base64");return void t(null,i)}var c="string"==typeof e,d=c?e.length:e.byteLength,p=Math.min(h,d),v=Math.ceil(d/p),g=0,y=c?new f:new f.ArrayBuffer,m=c?a:s;n()}}).call(t,function(){return this}(),n(1))},function(e,t){},function(e,t,n){!function(t){e.exports=t()}(function(e){"use strict";var t=function(e,t){return e+t&4294967295},n=function(e,n,r,i,o,s){return n=t(t(n,e),t(i,s)),t(n<<o|n>>>32-o,r)},r=function(e,t,r,i,o,s,a){return n(t&r|~t&i,e,t,o,s,a)},i=function(e,t,r,i,o,s,a){return n(t&i|r&~i,e,t,o,s,a)},o=function(e,t,r,i,o,s,a){return n(t^r^i,e,t,o,s,a)},s=function(e,t,r,i,o,s,a){return n(r^(t|~i),e,t,o,s,a)},a=function(e,n){var a=e[0],c=e[1],u=e[2],f=e[3];a=r(a,c,u,f,n[0],7,-680876936),f=r(f,a,c,u,n[1],12,-389564586),u=r(u,f,a,c,n[2],17,606105819),c=r(c,u,f,a,n[3],22,-1044525330),a=r(a,c,u,f,n[4],7,-176418897),f=r(f,a,c,u,n[5],12,1200080426),u=r(u,f,a,c,n[6],17,-1473231341),c=r(c,u,f,a,n[7],22,-45705983),a=r(a,c,u,f,n[8],7,1770035416),f=r(f,a,c,u,n[9],12,-1958414417),u=r(u,f,a,c,n[10],17,-42063),c=r(c,u,f,a,n[11],22,-1990404162),a=r(a,c,u,f,n[12],7,1804603682),f=r(f,a,c,u,n[13],12,-40341101),u=r(u,f,a,c,n[14],17,-1502002290),c=r(c,u,f,a,n[15],22,1236535329),a=i(a,c,u,f,n[1],5,-165796510),f=i(f,a,c,u,n[6],9,-1069501632),u=i(u,f,a,c,n[11],14,643717713),c=i(c,u,f,a,n[0],20,-373897302),a=i(a,c,u,f,n[5],5,-701558691),f=i(f,a,c,u,n[10],9,38016083),u=i(u,f,a,c,n[15],14,-660478335),c=i(c,u,f,a,n[4],20,-405537848),a=i(a,c,u,f,n[9],5,568446438),f=i(f,a,c,u,n[14],9,-1019803690),u=i(u,f,a,c,n[3],14,-187363961),c=i(c,u,f,a,n[8],20,1163531501),a=i(a,c,u,f,n[13],5,-1444681467),f=i(f,a,c,u,n[2],9,-51403784),u=i(u,f,a,c,n[7],14,1735328473),c=i(c,u,f,a,n[12],20,-1926607734),a=o(a,c,u,f,n[5],4,-378558),f=o(f,a,c,u,n[8],11,-2022574463),u=o(u,f,a,c,n[11],16,1839030562),c=o(c,u,f,a,n[14],23,-35309556),a=o(a,c,u,f,n[1],4,-1530992060),f=o(f,a,c,u,n[4],11,1272893353),u=o(u,f,a,c,n[7],16,-155497632),c=o(c,u,f,a,n[10],23,-1094730640),a=o(a,c,u,f,n[13],4,681279174),f=o(f,a,c,u,n[0],11,-358537222),u=o(u,f,a,c,n[3],16,-722521979),c=o(c,u,f,a,n[6],23,76029189),a=o(a,c,u,f,n[9],4,-640364487),f=o(f,a,c,u,n[12],11,-421815835),u=o(u,f,a,c,n[15],16,530742520),c=o(c,u,f,a,n[2],23,-995338651),a=s(a,c,u,f,n[0],6,-198630844),f=s(f,a,c,u,n[7],10,1126891415),u=s(u,f,a,c,n[14],15,-1416354905),c=s(c,u,f,a,n[5],21,-57434055),a=s(a,c,u,f,n[12],6,1700485571),f=s(f,a,c,u,n[3],10,-1894986606),u=s(u,f,a,c,n[10],15,-1051523),c=s(c,u,f,a,n[1],21,-2054922799),a=s(a,c,u,f,n[8],6,1873313359),f=s(f,a,c,u,n[15],10,-30611744),u=s(u,f,a,c,n[6],15,-1560198380),c=s(c,u,f,a,n[13],21,1309151649),a=s(a,c,u,f,n[4],6,-145523070),f=s(f,a,c,u,n[11],10,-1120210379),u=s(u,f,a,c,n[2],15,718787259),c=s(c,u,f,a,n[9],21,-343485551),e[0]=t(a,e[0]),e[1]=t(c,e[1]),e[2]=t(u,e[2]),e[3]=t(f,e[3])},c=function(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n},u=function(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n},f=function(e){var t,n,r,i,o,s,u=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=u;t+=64)a(f,c(e.substring(t-64,t)));for(e=e.substring(t-64),n=e.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<n;t+=1)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(a(f,r),t=0;t<16;t+=1)r[t]=0;return i=8*u,i=i.toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(i[2],16),s=parseInt(i[1],16)||0,r[14]=o,r[15]=s,a(f,r),f},l=function(e){var t,n,r,i,o,s,c=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)a(f,u(e.subarray(t-64,t)));for(e=t-64<c?e.subarray(t-64):new Uint8Array(0),n=e.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<n;t+=1)r[t>>2]|=e[t]<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(a(f,r),t=0;t<16;t+=1)r[t]=0;return i=8*c,i=i.toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(i[2],16),s=parseInt(i[1],16)||0,r[14]=o,r[15]=s,a(f,r),f},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],d=function(e){var t,n="";for(t=0;t<4;t+=1)n+=h[e>>8*t+4&15]+h[e>>8*t&15];return n},p=function(e){var t;for(t=0;t<e.length;t+=1)e[t]=d(e[t]);return e.join("")},v=function(e){return p(f(e))},g=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==v("hello")&&(t=function(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}),g.prototype.append=function(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),this.appendBinary(e),this},g.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,n=this._buff.length;for(t=64;t<=n;t+=64)a(this._state,c(this._buff.substring(t-64,t)));return this._buff=this._buff.substr(t-64),this},g.prototype.end=function(e){var t,n,r=this._buff,i=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(o,i),n=e?this._state:p(this._state),this.reset(),n},g.prototype._finish=function(e,t){var n,r,i,o=t;if(e[o>>2]|=128<<(o%4<<3),o>55)for(a(this._state,e),o=0;o<16;o+=1)e[o]=0;n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(n[2],16),i=parseInt(n[1],16)||0,e[14]=r,e[15]=i,a(this._state,e)},g.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},g.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},g.hash=function(e,t){/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e)));var n=f(e);return t?n:p(n)},g.hashBinary=function(e,t){var n=f(e);return t?n:p(n)},g.ArrayBuffer=function(){this.reset()},g.ArrayBuffer.prototype.append=function(e){var t,n=this._concatArrayBuffer(this._buff,e),r=n.length;for(this._length+=e.byteLength,t=64;t<=r;t+=64)a(this._state,u(n.subarray(t-64,t)));return this._buff=t-64<r?n.subarray(t-64):new Uint8Array(0),this},g.ArrayBuffer.prototype.end=function(e){var t,n,r=this._buff,i=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=r[t]<<(t%4<<3);return this._finish(o,i),n=e?this._state:p(this._state),this.reset(),n},g.ArrayBuffer.prototype._finish=g.prototype._finish,g.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},g.ArrayBuffer.prototype.destroy=g.prototype.destroy,g.ArrayBuffer.prototype._concatArrayBuffer=function(e,t){var n=e.length,r=new Uint8Array(n+t.byteLength);return r.set(e),r.set(new Uint8Array(t),n),r},g.ArrayBuffer.hash=function(e,t){var n=l(new Uint8Array(e));return t?n:p(n)},g})},function(e,t,n){(function(t,n){"use strict";function r(e){t.browser&&"console"in n&&"info"in console&&console.info("The above 404 is totally normal. "+e)}e.exports=r}).call(t,n(1),function(){return this}())},function(e,t){"use strict";function n(e){for(var t=r,n=t.parser[t.strictMode?"strict":"loose"].exec(e),i={},o=14;o--;){var s=t.key[o],a=n[o]||"",c=["user","password"].indexOf(s)!==-1;i[s]=c?decodeURIComponent(a):a}return i[t.q.name]={},i[t.key[12]].replace(t.q.parser,function(e,n,r){n&&(i[t.q.name][n]=r)}),i}var r={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};e.exports=n},function(e,t){"use strict";function n(e,t,n){var r=n[n.length-1];e===r.element&&(n.pop(),r=n[n.length-1]);var i=r.element,o=r.index;if(Array.isArray(i))i.push(e);else if(o===t.length-2){var s=t.pop();i[s]=e}else t.push(e)}t.stringify=function(e){var t=[];t.push({obj:e});for(var n,r,i,o,s,a,c,u,f,l,h,d="";n=t.pop();)if(r=n.obj,i=n.prefix||"",o=n.val||"",d+=i,o)d+=o;else if("object"!=typeof r)d+="undefined"==typeof r?null:JSON.stringify(r);else if(null===r)d+="null";else if(Array.isArray(r)){for(t.push({val:"]"}),s=r.length-1;s>=0;s--)a=0===s?"":",",t.push({obj:r[s],prefix:a});t.push({val:"["})}else{c=[];for(u in r)r.hasOwnProperty(u)&&c.push(u);for(t.push({val:"}"}),s=c.length-1;s>=0;s--)f=c[s],l=r[f],h=s>0?",":"",h+=JSON.stringify(f)+":",t.push({obj:l,prefix:h});t.push({val:"{"})}return d},t.parse=function(e){for(var t,r,i,o,s,a,c,u,f,l=[],h=[],d=0;;)if(t=e[d++],"}"!==t&&"]"!==t&&"undefined"!=typeof t)switch(t){case" ":case"\t":case"\n":case":":case",":break;case"n":d+=3,n(null,l,h);break;case"t":d+=3,n(!0,l,h);break;case"f":d+=4,n(!1,l,h);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(r="",d--;;){if(i=e[d++],!/[\d\.\-e\+]/.test(i)){d--;break}r+=i}n(parseFloat(r),l,h);break;case'"':for(o="",s=void 0,a=0;;){if(c=e[d++],'"'===c&&("\\"!==s||a%2!==1))break;o+=c,s=c,"\\"===s?a++:a=0}n(JSON.parse('"'+o+'"'),l,h);break;case"[":u={element:[],index:l.length},l.push(u.element),h.push(u);break;case"{":f={element:{},index:l.length},l.push(f.element),h.push(f);break;default:throw new Error("unexpectedly reached end of input: "+t)}else{if(1===l.length)return l.pop();n(l.pop(),l,h)}}},function(e,t,n){"use strict";var r=n(51).upsert;e.exports=function(e,t,n,i){return r.call(e,t,n,i)}},function(e,t,n){(function(e){"use strict";function r(e,t,n){return new o(function(r,o){return"string"!=typeof t?o(new Error("doc id is required")):void e.get(t,function(s,a){if(s){if(404!==s.status)return o(s);a={}}var c=a._rev,u=n(a);return u?(u._id=t,u._rev=c,void r(i(e,u,n))):r({updated:!1,rev:c})})})}function i(e,t,n){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(i){if(409!==i.status)throw i;return r(e,t._id,n)})}var o;o="undefined"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:"function"==typeof e.Promise?e.Promise:n(23),t.upsert=function(e,t,n){var i=this,o=r(i,e,t);return"function"!=typeof n?o:void o.then(function(e){n(null,e)},n)},t.putIfNotExists=function(e,t,n){var i=this;"string"!=typeof e&&(n=t,t=e,e=t._id);var o=function(e){return!e._rev&&t},s=r(i,e,o);return"function"!=typeof n?s:void s.then(function(e){n(null,e)},n)},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(t)}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e,t,n){function r(){i.cancel()}c.call(this);var i=this;this.db=e,t=t?o.clone(t):{};var s=n||t.complete||function(){},a=t.complete=o.once(function(t,n){t?i.emit("error",t):i.emit("complete",n),i.removeAllListeners(),e.removeListener("destroyed",r)});s&&(i.on("complete",function(e){s(null,e)}),i.on("error",function(e){s(e)}));var u=t.onChange;u&&i.on("change",u),e.once("destroyed",r),t.onChange=function(e){t.isCancelled||(i.emit("change",e),i.startSeq&&i.startSeq<=e.seq&&(i.emit("uptodate"),i.startSeq=!1),e.deleted?i.emit("delete",e):1===e.changes.length&&"1-"===e.changes[0].rev.slice(0,2)?i.emit("create",e):i.emit("update",e))};var f=new o.Promise(function(e,n){t.complete=function(t,r){t?n(t):e(r)}});i.once("cancel",function(){u&&i.removeListener("change",u),e.removeListener("destroyed",r),t.complete(null,{status:"cancelled"})}),this.then=f.then.bind(f),this["catch"]=f["catch"].bind(f),this.then(function(e){a(null,e)},a),e.taskqueue.isReady?i.doChanges(t):e.taskqueue.addTask(function(){i.isCancelled?i.emit("cancel"):i.doChanges(t)})}function i(e,t,n){var r=[{rev:e._rev}];"all_docs"===n.style&&(r=s.collectLeaves(t.rev_tree).map(function(e){return{rev:e.rev}}));var i={id:t.id,changes:r,doc:e};return o.isDeleted(t,e._rev)&&(i.deleted=!0),n.conflicts&&(i.doc._conflicts=s.collectConflicts(t),i.doc._conflicts.length||delete i.doc._conflicts),i}var o=n(7),s=n(8),a=n(15),c=n(19).EventEmitter,u=n(53),f=n(54);e.exports=r,o.inherits(r,c),r.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},r.prototype.doChanges=function(e){var t=this,n=e.complete;if(e=o.clone(e),"live"in e&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=i,"latest"===e.since&&(e.since="now"),e.since||(e.since=0),"now"===e.since)return void this.db.info().then(function(r){return t.isCancelled?void n(null,{status:"cancelled"}):(e.since=r.update_seq,void t.doChanges(e))},n);if(e.continuous&&"now"!==e.since&&this.db.info().then(function(e){t.startSeq=e.update_seq},function(e){if("idbNull"!==e.id)throw e}),"http"!==this.db.type()&&e.filter&&"string"==typeof e.filter&&!e.doc_ids)return this.filterChanges(e);"descending"in e||(e.descending=!1),e.limit=0===e.limit?1:e.limit,e.complete=n;var r=this.db._changes(e);if(r&&"function"==typeof r.cancel){var s=t.cancel;t.cancel=o.getArguments(function(e){r.cancel(),s.apply(this,e)})}},r.prototype.filterChanges=function(e){var t=this,n=e.complete;if("_view"===e.filter){if(!e.view||"string"!=typeof e.view){var r=a.error(a.BAD_REQUEST,"`view` filter parameter is not provided.");return void n(r)}var i=e.view.split("/");this.db.get("_design/"+i[0],function(r,o){if(t.isCancelled)return void n(null,{status:"cancelled"});if(r)return void n(a.generateErrorFromResponse(r));if(o&&o.views&&o.views[i[1]]){var s=f(o.views[i[1]].map);return e.filter=s,void t.doChanges(e)}var c=o.views?"missing json key: "+i[1]:"missing json key: views";r||(r=a.error(a.MISSING_DOC,c)),n(r)})}else{var o=e.filter.split("/");this.db.get("_design/"+o[0],function(r,i){if(t.isCancelled)return void n(null,{status:"cancelled"});if(r)return void n(a.generateErrorFromResponse(r));if(i&&i.filters&&i.filters[o[1]]){var s=u(i.filters[o[1]]);return e.filter=s,void t.doChanges(e)}var c=i&&i.filters?"missing json key: "+o[1]:"missing json key: filters";return r||(r=a.error(a.MISSING_DOC,c)),void n(r)})}}},function(module,exports){"use strict";function evalFilter(input){return eval(["(function () { return ",input," })()"].join(""))}module.exports=evalFilter},function(module,exports){"use strict";function evalView(input){return eval(["(function () {","  return function (doc) {","    var emitted = false;","    var emit = function (a, b) {","      emitted = true;","    };","    var view = "+input+";","    view(doc);","    if (emitted) {","      return true;","    }","  }","})()"].join("\n"))}module.exports=evalView},function(e,t){"use strict";function n(){this.isReady=!1,this.failed=!1,this.queue=[]}e.exports=n,n.prototype.execute=function(){var e,t;if(this.failed)for(;e=this.queue.shift();)"function"!=typeof e?(t=e.parameters[e.parameters.length-1],"function"==typeof t?t(this.failed):"changes"===e.name&&"function"==typeof t.complete&&t.complete(this.failed)):e(this.failed);else if(this.isReady)for(;e=this.queue.shift();)"function"==typeof e?e():e.task=this.db[e.name].apply(this.db,e.parameters)},n.prototype.fail=function(e){this.failed=e,this.execute()},n.prototype.ready=function(e){return!this.failed&&(0===arguments.length?this.isReady:(this.isReady=!!e,
this.db=e,void this.execute()))},n.prototype.addTask=function(e,t){if("function"!=typeof e){var n={name:e,parameters:t};return this.queue.push(n),this.failed&&this.execute(),n}this.queue.push(e),this.failed&&this.execute()}},function(e,t,n){"use strict";function r(e,t){var n=t.PouchConstructor;return"string"==typeof e?new n(e,t):e}function i(e,t,n,i){"function"==typeof n&&(i=n,n={}),"undefined"==typeof n&&(n={}),n.complete||(n.complete=i||function(){}),n=o.clone(n),n.continuous=n.continuous||n.live,n.retry="retry"in n&&n.retry,n.PouchConstructor=n.PouchConstructor||this;var c=new a(n),u=r(e,n),f=r(t,n);return s(u,f,n,c),c}var o=n(7),s=n(57),a=n(64);e.exports={replicate:i,toPouch:r}},function(e,t,n){"use strict";function r(e,t,n,u,f){function l(){return T?i.Promise.resolve():a(e,t,n).then(function(n){A=n,T=new o(e,t,A,q)})}function h(){if(0!==S.docs.length){var e=S.docs;return t.bulkDocs({docs:e,new_edits:!1}).then(function(t){if(q.cancelled)throw b(),new Error("cancelled");var n=[],r={};t.forEach(function(e){e.error&&(f.doc_write_failures++,n.push(e),r[e.id]=e)}),U=U.concat(n),f.docs_written+=S.docs.length-n.length;var o=n.filter(function(e){return"unauthorized"!==e.name&&"forbidden"!==e.name});if(F=[],e.forEach(function(e){var t=r[e._id];t?u.emit("denied",i.clone(t)):F.push(e)}),o.length>0){var s=new Error("bulkDocs error");throw s.other_errors=n,m("target.bulkDocs failed to write docs",s),new Error("bulkWrite partial failure")}},function(t){throw f.doc_write_failures+=e.length,t})}}function d(){return C=!0,T.writeCheckpoint(S.seq).then(function(){if(C=!1,q.cancelled)throw b(),new Error("cancelled");f.last_seq=L=S.seq;var e=i.clone(f);e.docs=F,u.emit("change",e),S=void 0,k()})["catch"](function(e){throw C=!1,m("writeCheckpoint completed with error",e),e})}function p(){var e={};return S.changes.forEach(function(t){"_user/"!==t.id&&(e[t.id]=t.changes.map(function(e){return e.rev}))}),t.revsDiff(e).then(function(e){if(q.cancelled)throw b(),new Error("cancelled");S.diffs=e})}function v(){return c(e,S.diffs,q).then(function(e){e.forEach(function(e){delete S.diffs[e._id],f.docs_read++,S.docs.push(e)})})}function g(){if(!q.cancelled&&!S){if(0===O.length)return void y(!0);S=O.shift(),p().then(v).then(h).then(d).then(g)["catch"](function(e){m("batch processing terminated with error",e)})}}function y(e){return 0===R.changes.length?void(0!==O.length||S||((I&&H.live||j)&&(u.state="pending",u.emit("paused"),u.emit("uptodate",f)),j&&b())):void((e||j||R.changes.length>=N)&&(O.push(R),R={seq:0,changes:[],docs:[]},"pending"!==u.state&&"stopped"!==u.state||(u.state="active",u.emit("active")),g()))}function m(e,t){D||(t.message||(t.message=e),f.ok=!1,f.status="aborting",f.errors.push(t),U=U.concat(t),O=[],R={seq:0,changes:[],docs:[]},b())}function b(){if(!(D||q.cancelled&&(f.status="cancelled",C))){f.status=f.status||"complete",f.end_time=new Date,f.last_seq=L,D=q.cancelled=!0;var i=U.filter(function(e){return"unauthorized"!==e.name&&"forbidden"!==e.name});if(i.length>0){var o=U.pop();U.length>0&&(o.other_errors=U),o.result=f,s(n,u,o,function(){r(e,t,n,u)})}else f.errors=U,u.emit("complete",f),u.removeAllListeners()}}function _(e){if(q.cancelled)return b();var t=i.filterChange(n)(e);t&&(R.seq=e.seq,R.changes.push(e),y(0===O.length))}function w(e){return M=!1,q.cancelled?b():(e.results.length>0?(H.since=e.last_seq,k()):I?(H.live=!0,k()):j=!0,void y(!0))}function E(e){return M=!1,q.cancelled?b():void m("changes rejected",e)}function k(){function t(){i.cancel()}function r(){u.removeListener("cancel",t)}if(!M&&!j&&O.length<B){M=!0,u._changes&&(u.removeListener("cancel",u._abortChanges),u._changes.cancel()),u.once("cancel",t);var i=e.changes(H).on("change",_);i.then(r,r),i.then(w)["catch"](E),n.retry&&(u._changes=i,u._abortChanges=t)}}function x(){l().then(function(){return q.cancelled?void b():T.getCheckpoint().then(function(e){L=e,H={since:L,limit:N,batch_size:N,style:"all_docs",doc_ids:P,returnDocs:!0},n.filter&&("string"!=typeof n.filter?H.include_docs=!0:H.filter=n.filter),n.query_params&&(H.query_params=n.query_params),n.view&&(H.view=n.view),k()})})["catch"](function(e){m("getCheckpoint rejected with ",e)})}var S,A,T,O=[],R={seq:0,changes:[],docs:[]},C=!1,j=!1,D=!1,L=0,I=n.continuous||n.live||!1,N=n.batch_size||100,B=n.batches_limit||10,M=!1,P=n.doc_ids,q={cancelled:!1},U=[],F=[];f=f||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var H={};return u.ready(e,t),u.cancelled?void b():(u._addedListeners||(u.once("cancel",b),"function"==typeof n.onChange&&u.on("change",n.onChange),"function"==typeof n.complete&&(u.once("error",n.complete),u.once("complete",function(e){n.complete(null,e)})),u._addedListeners=!0),void("undefined"==typeof n.since?x():l().then(function(){return C=!0,T.writeCheckpoint(n.since)}).then(function(){return C=!1,q.cancelled?void b():(L=n.since,void x())})["catch"](function(e){throw C=!1,m("writeCheckpoint completed with error",e),e})))}var i=n(7),o=n(58),s=n(61),a=n(62),c=n(63);e.exports=r},function(e,t,n){"use strict";function r(e,t,n,i){return e.get(t)["catch"](function(n){if(404===n.status)return"http"===e.type()&&s("PouchDB is just checking if a remote checkpoint exists."),{_id:t};throw n}).then(function(o){if(!i.cancelled)return o.last_seq=n,e.put(o)["catch"](function(o){if(409===o.status)return r(e,t,n,i);throw o})})}function i(e,t,n,r){this.src=e,this.target=t,this.id=n,this.returnValue=r}var o=n(22),s=n(47),a=n(59),c=a.collate;i.prototype.writeCheckpoint=function(e){var t=this;return this.updateTarget(e).then(function(){return t.updateSource(e)})},i.prototype.updateTarget=function(e){return r(this.target,this.id,e,this.returnValue)},i.prototype.updateSource=function(e){var t=this;return this.readOnlySource?o.resolve(!0):r(this.src,this.id,e,this.returnValue)["catch"](function(e){var n="number"==typeof e.status&&4===Math.floor(e.status/100);if(n)return t.readOnlySource=!0,!0;throw e})},i.prototype.getCheckpoint=function(){var e=this;return e.target.get(e.id).then(function(t){return e.src.get(e.id).then(function(e){return 0===c(t.last_seq,e.last_seq)?e.last_seq:0},function(n){if(404===n.status&&t.last_seq)return e.src.put({_id:e.id,last_seq:0}).then(function(){return 0},function(n){return 401===n.status?(e.readOnlySource=!0,t.last_seq):0});throw n})})["catch"](function(e){if(404!==e.status)throw e;return 0})},e.exports=i},function(e,t,n){"use strict";function r(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return f(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var n=Array.isArray(e),r=n?e:Object.keys(e),i=-1,o=r.length,s="";if(n)for(;++i<o;)s+=t.toIndexableString(r[i]);else for(;++i<o;){var a=r[i];s+=t.toIndexableString(a)+t.toIndexableString(e[a])}return s}return""}function i(e,t){var n,r=t,i="1"===e[t];if(i)n=0,t++;else{var o="0"===e[t];t++;var s="",a=e.substring(t,t+h),c=parseInt(a,10)+l;for(o&&(c=-c),t+=h;;){var u=e[t];if("\0"===u)break;s+=u,t++}s=s.split("."),n=1===s.length?parseInt(s,10):parseFloat(s[0]+"."+s[1]),o&&(n-=10),0!==c&&(n=parseFloat(n+"e"+c))}return{num:n,length:t-r}}function o(e,t){var n=e.pop();if(t.length){var r=t[t.length-1];n===r.element&&(t.pop(),r=t[t.length-1]);var i=r.element,o=r.index;if(Array.isArray(i))i.push(n);else if(o===e.length-2){var s=e.pop();i[s]=n}else e.push(n)}}function s(e,n){for(var r=Math.min(e.length,n.length),i=0;i<r;i++){var o=t.collate(e[i],n[i]);if(0!==o)return o}return e.length===n.length?0:e.length>n.length?1:-1}function a(e,t){return e===t?0:e>t?1:-1}function c(e,n){for(var r=Object.keys(e),i=Object.keys(n),o=Math.min(r.length,i.length),s=0;s<o;s++){var a=t.collate(r[s],i[s]);if(0!==a)return a;if(a=t.collate(e[r[s]],n[i[s]]),0!==a)return a}return r.length===i.length?0:r.length>i.length?1:-1}function u(e){var t=["boolean","number","string","object"],n=t.indexOf(typeof e);return~n?null===e?1:Array.isArray(e)?5:n<3?n+2:n+3:Array.isArray(e)?5:void 0}function f(e){if(0===e)return"1";var t=e.toExponential().split(/e\+?/),n=parseInt(t[1],10),r=e<0,i=r?"0":"2",o=(r?-n:n)-l,s=p.padLeft(o.toString(),"0",h);i+=d+s;var a=Math.abs(parseFloat(t[0]));r&&(a=10-a);var c=a.toFixed(20);return c=c.replace(/\.?0+$/,""),i+=d+c}var l=-324,h=3,d="",p=n(60);t.collate=function(e,n){if(e===n)return 0;e=t.normalizeKey(e),n=t.normalizeKey(n);var r=u(e),i=u(n);if(r-i!==0)return r-i;if(null===e)return 0;switch(typeof e){case"number":return e-n;case"boolean":return e===n?0:e<n?-1:1;case"string":return a(e,n)}return Array.isArray(e)?s(e,n):c(e,n)},t.normalizeKey=function(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-(1/0)||isNaN(e)?null:e;case"object":var n=e;if(Array.isArray(e)){var r=e.length;e=new Array(r);for(var i=0;i<r;i++)e[i]=t.normalizeKey(n[i])}else{if(e instanceof Date)return e.toJSON();if(null!==e){e={};for(var o in n)if(n.hasOwnProperty(o)){var s=n[o];"undefined"!=typeof s&&(e[o]=t.normalizeKey(s))}}}}return e},t.toIndexableString=function(e){var n="\0";return e=t.normalizeKey(e),u(e)+d+r(e)+n},t.parseIndexableString=function(e){for(var t=[],n=[],r=0;;){var s=e[r++];if("\0"!==s)switch(s){case"1":t.push(null);break;case"2":t.push("1"===e[r]),r++;break;case"3":var a=i(e,r);t.push(a.num),r+=a.length;break;case"4":for(var c="";;){var u=e[r];if("\0"===u)break;c+=u,r++}c=c.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),t.push(c);break;case"5":var f={element:[],index:t.length};t.push(f.element),n.push(f);break;case"6":var l={element:{},index:t.length};t.push(l.element),n.push(l);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+s)}else{if(1===t.length)return t.pop();o(t,n)}}}},function(e,t){"use strict";function n(e,t,n){for(var r="",i=n-e.length;r.length<i;)r+=t;return r}t.padLeft=function(e,t,r){var i=n(e,t,r);return i+e},t.padRight=function(e,t,r){var i=n(e,t,r);return e+i},t.stringLexCompare=function(e,t){var n,r=e.length,i=t.length;for(n=0;n<r;n++){if(n===i)return 1;var o=e.charAt(n),s=t.charAt(n);if(o!==s)return o<s?-1:1}return r<i?-1:0},t.intToDecimalForm=function(e){var t=e<0,n="";do{var r=t?-Math.ceil(e%10):Math.floor(e%10);n=r+n,e=t?Math.ceil(e/10):Math.floor(e/10)}while(e);return t&&"0"!==n&&(n="-"+n),n}},function(e,t){"use strict";function n(e,t){e=parseInt(e,10),t=parseInt(t,10),e!==e&&(e=0),t!==t||t<=e?t=(e||1)<<1:t+=1;var n=Math.random(),r=t-e;return~~(r*n+e)}function r(e){var t=0;return e||(t=2e3),n(e,t)}function i(e,t,n,i){return e.retry===!1?(t.emit("error",n),void t.removeAllListeners()):("function"!=typeof e.back_off_function&&(e.back_off_function=r),t.emit("requestError",n),"active"===t.state&&(t.emit("paused",n),t.state="stopped",t.once("active",function(){e.current_back_off=o})),e.current_back_off=e.current_back_off||o,e.current_back_off=e.back_off_function(e.current_back_off),void setTimeout(i,e.current_back_off))}var o=0;e.exports=i},function(e,t,n){"use strict";function r(e,t,n){var r=n.filter?n.filter.toString():"";return e.id().then(function(e){return t.id().then(function(t){var o=e+t+r+JSON.stringify(n.query_params)+n.doc_ids;return i.MD5(o).then(function(e){return e=e.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+e})})})}var i=n(7);e.exports=r},function(e,t,n){"use strict";function r(e){return/^1-/.test(e)}function i(e,t,n){function i(t,r){var i={revs:!0,open_revs:r,attachments:!0};return e.get(t,i).then(function(e){if(n.cancelled)throw new Error("cancelled");e.forEach(function(e){e.ok&&p.push(e.ok)})})}function o(e){for(var n=t[e].missing,r=[],o=0;o<n.length;o+=c){var s=n.slice(o,Math.min(n.length,o+c));r.push(s)}return a.all(r.map(function(t){return i(e,t)}))}function u(){var e=Object.keys(t);return a.all(e.map(o))}function f(e){return e._attachments&&Object.keys(e._attachments).length>0}function l(i){return e.allDocs({keys:i,include_docs:!0}).then(function(e){if(n.cancelled)throw new Error("cancelled");e.rows.forEach(function(e){!e.deleted&&e.doc&&r(e.value.rev)&&!f(e.doc)&&(p.push(e.doc),delete t[e.id])})})}function h(){var e=Object.keys(t).filter(function(e){var n=t[e].missing;return 1===n.length&&r(n[0])});if(e.length>0)return l(e)}function d(){return p}t=s(t);var p=[];return a.resolve().then(h).then(u).then(d)}var o=n(7),s=o.clone,a=o.Promise,c=50;e.exports=i},function(e,t,n){"use strict";function r(){o.call(this),this.cancelled=!1,this.state="pending";var e=this,t=new s(function(t,n){e.once("complete",t),e.once("error",n)});e.then=function(e,n){return t.then(e,n)},e["catch"]=function(e){return t["catch"](e)},e["catch"](function(){})}var i=n(7),o=n(19).EventEmitter,s=i.Promise;i.inherits(r,o),r.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},r.prototype.ready=function(e,t){function n(){i.cancel()}function r(){e.removeListener("destroyed",n),t.removeListener("destroyed",n)}var i=this;i._readyCalled||(i._readyCalled=!0,e.once("destroyed",n),t.once("destroyed",n),i.once("complete",r))},e.exports=r},function(e,t,n){"use strict";function r(e,t,n,r){return"function"==typeof n&&(r=n,n={}),"undefined"==typeof n&&(n={}),n=o.clone(n),n.PouchConstructor=n.PouchConstructor||this,e=s.toPouch(e,n),t=s.toPouch(t,n),new i(e,t,n,r)}function i(e,t,n,r){function i(e){v||(v=!0,h.emit("cancel",e))}function s(e){h.emit("change",{direction:"pull",change:e})}function c(e){h.emit("change",{direction:"push",change:e})}function u(e){h.emit("denied",{direction:"push",doc:e})}function f(e){h.emit("denied",{direction:"pull",doc:e})}function l(e){return function(t,n){var r="change"===t&&(n===s||n===c),o="cancel"===t&&n===i,a=t in g&&n===g[t];(r||o||a)&&(t in y||(y[t]={}),y[t][e]=!0,2===Object.keys(y[t]).length&&h.removeAllListeners(t))}}var h=this;this.canceled=!1;var d,p;"onChange"in n&&(d=n.onChange,delete n.onChange),"function"!=typeof r||n.complete?"complete"in n&&(p=n.complete,delete n.complete):p=r,this.push=a(e,t,n),this.pull=a(t,e,n);var v=!1,g={},y={};n.live&&(this.push.on("complete",h.pull.cancel.bind(h.pull)),this.pull.on("complete",h.push.cancel.bind(h.push))),this.on("newListener",function(e){"change"===e?(h.pull.on("change",s),h.push.on("change",c)):"denied"===e?(h.pull.on("denied",f),h.push.on("denied",u)):"cancel"===e?(h.pull.on("cancel",i),h.push.on("cancel",i)):"error"===e||"removeListener"===e||"complete"===e||e in g||(g[e]=function(t){h.emit(e,t)},h.pull.on(e,g[e]),h.push.on(e,g[e]))}),this.on("removeListener",function(e){"change"===e?(h.pull.removeListener("change",s),h.push.removeListener("change",c)):"cancel"===e?(h.pull.removeListener("cancel",i),h.push.removeListener("cancel",i)):e in g&&"function"==typeof g[e]&&(h.pull.removeListener(e,g[e]),h.push.removeListener(e,g[e]),delete g[e])}),this.pull.on("removeListener",l("pull")),this.push.on("removeListener",l("push"));var m=o.Promise.all([this.push,this.pull]).then(function(e){var t={push:e[0],pull:e[1]};return h.emit("complete",t),p&&p(null,t),h.removeAllListeners(),t},function(e){throw h.cancel(),h.emit("error",e),p&&p(e),h.removeAllListeners(),e});this.then=function(e,t){return m.then(e,t)},this["catch"]=function(e){return m["catch"](e)}}var o=n(7),s=n(56),a=s.replicate,c=n(19).EventEmitter;o.inherits(i,c),e.exports=r,i.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())}},function(e,t){e.exports="3.6.0"},function(e,t,n){(function(t){"use strict";function r(e){return E?new v(function(t){h(e,function(e){t(m(e))})}):v.resolve(e.toString("base64"))}function i(e){return/^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function o(e){return e._attachments&&Object.keys(e._attachments)?v.all(Object.keys(e._attachments).map(function(t){var n=e._attachments[t];if(n.data&&"string"!=typeof n.data)return r(n.data).then(function(e){n.data=e})})):v.resolve()}function s(e,t){if(/http(s?):/.test(e)){var n=p.parseUri(e);n.remote=!0,(n.user||n.password)&&(n.auth={username:n.user,password:n.password});var r=n.path.replace(/(^\/|\/$)/g,"").split("/");if(n.db=r.pop(),n.path=r.join("/"),t=t||{},t=g(t),n.headers=t.headers||t.ajax&&t.ajax.headers||{},t.auth||n.auth){var i=t.auth||n.auth,o=m(i.username+":"+i.password);n.headers.Authorization="Basic "+o}return t.headers&&(n.headers=t.headers),n}return{host:"",path:"/",db:e,auth:!1}}function a(e,t){return c(e,e.db+"/"+t)}function c(e,t){if(e.remote){var n=e.path?"/":"";return e.protocol+"://"+e.host+":"+e.port+"/"+e.path+n+t}return"/"+t}function u(e,t){function n(e,t){var n=p.extend(!0,g(A),e);return w(n.method+" "+n.url),p.ajax(n,t)}function u(e){return new v(function(t,r){n(e,function(e,n){return e?r(e):void t(n)})})}function h(e){return e.split("/").map(encodeURIComponent).join("/")}var y=this;y.getHost=e.getHost?e.getHost:s;var m=y.getHost(e.name,e),S=a(m,"");y.getUrl=function(){return S},y.getHeaders=function(){return g(m.headers)};var A=e.ajax||{};e=g(e);var T=function(){n({headers:g(m.headers),method:"PUT",url:S},function(e){e&&401===e.status?n({headers:g(m.headers),method:"HEAD",url:S},function(e){e?t(e):t(null,y)}):e&&412!==e.status?t(e):t(null,y)})};e.skipSetup||n({headers:g(m.headers),method:"GET",url:S},function(e){e?404===e.status?(p.explain404("PouchDB is just detecting if the remote DB exists."),T()):t(e):t(null,y)}),y.type=function(){return"http"},y.id=p.adapterFun("id",function(e){n({headers:g(m.headers),method:"GET",url:c(m,"")},function(t,n){if(t)return e(t);var r=n&&n.uuid?n.uuid+m.db:a(m,"");e(null,r)})}),y.request=p.adapterFun("request",function(e,t){e.headers=m.headers,e.url=a(m,e.url),n(e,t)}),y.compact=p.adapterFun("compact",function(e,t){"function"==typeof e&&(t=e,e={}),e=g(e),n({headers:g(m.headers),url:a(m,"_compact"),method:"POST"},function(){function n(){y.info(function(r,i){i.compact_running?setTimeout(n,e.interval||200):t(null,{ok:!0})})}"function"==typeof t&&n()})}),y._info=function(e){n({headers:g(m.headers),method:"GET",url:a(m,"")},function(t,n){t?e(t):(n.host=a(m,""),e(null,n))})},y.get=p.adapterFun("get",function(e,t,n){function o(e){var t=e._attachments,n=t&&Object.keys(t);if(t&&n.length)return v.all(n.map(function(n){var o=t[n],s=i(e._id)+"/"+h(n)+"?rev="+e._rev;return u({headers:g(m.headers),method:"GET",url:a(m,s),binary:!0}).then(r).then(function(e){delete o.stub,delete o.length,o.data=e})}))}function s(e){return Array.isArray(e)?v.all(e.map(function(e){if(e.ok)return o(e.ok)})):o(e)}"function"==typeof t&&(n=t,t={}),t=g(t);var c=[];t.revs&&c.push("revs=true"),t.revs_info&&c.push("revs_info=true"),t.local_seq&&c.push("local_seq=true"),t.open_revs&&("all"!==t.open_revs&&(t.open_revs=JSON.stringify(t.open_revs)),c.push("open_revs="+t.open_revs)),t.rev&&c.push("rev="+t.rev),t.conflicts&&c.push("conflicts="+t.conflicts),c=c.join("&"),c=""===c?"":"?"+c,e=i(e);var f={headers:g(m.headers),method:"GET",url:a(m,e+c)},l=t.ajax||{};p.extend(!0,f,l),u(f).then(function(e){return v.resolve().then(function(){if(t.attachments)return s(e)}).then(function(){n(null,e)})})["catch"](n)}),y.remove=p.adapterFun("remove",function(e,t,r,o){var s;"string"==typeof t?(s={_id:e,_rev:t},"function"==typeof r&&(o=r,r={})):(s=e,"function"==typeof t?(o=t,r={}):(o=r,r=t));var c=s._rev||r.rev;n({headers:g(m.headers),method:"DELETE",url:a(m,i(s._id))+"?rev="+c},o)}),y.getAttachment=p.adapterFun("getAttachment",function(e,t,r,o){"function"==typeof r&&(o=r,r={});var s=r.rev?"?rev="+r.rev:"",c=a(m,i(e))+"/"+h(t)+s;n({headers:g(m.headers),method:"GET",url:c,binary:!0},o)}),y.removeAttachment=p.adapterFun("removeAttachment",function(e,t,r,o){var s=a(m,i(e)+"/"+h(t))+"?rev="+r;n({headers:g(m.headers),method:"DELETE",url:s},o)}),y.putAttachment=p.adapterFun("putAttachment",function(e,t,r,o,s,c){"function"==typeof s&&(c=s,s=o,o=r,r=null),"undefined"==typeof s&&(s=o,o=r,r=null);var u=i(e)+"/"+h(t),f=a(m,u);if(r&&(f+="?rev="+r),"string"==typeof o){var l;try{l=b(o)}catch(p){return c(_.error(_.BAD_ARG,"Attachments need to be base64 encoded"))}o=E?d(l,s):l?new k(l,"binary"):""}var v={headers:g(m.headers),method:"PUT",url:f,processData:!1,body:o,timeout:6e4};v.headers["Content-Type"]=s,n(v,c)}),y.put=p.adapterFun("put",p.getArguments(function(e){var t,n,r,s=e.shift(),c="_id"in s,f=e.pop();return"object"!=typeof s||Array.isArray(s)?f(_.error(_.NOT_AN_OBJECT)):(s=g(s),void o(s).then(function(){for(;;)if(t=e.shift(),n=typeof t,"string"!==n||c?"string"!==n||!c||"_rev"in s?"object"===n&&(r=g(t)):s._rev=t:(s._id=t,c=!0),!e.length)break;r=r||{};var o=p.invalidIdError(s._id);if(o)throw o;var l=[];r&&"undefined"!=typeof r.new_edits&&l.push("new_edits="+r.new_edits),l=l.join("&"),""!==l&&(l="?"+l);var h={headers:g(m.headers),method:"PUT",url:a(m,i(s._id))+l,body:s};return v.resolve().then(function(){var e=s._attachments&&Object.keys(s._attachments).filter(function(e){return!s._attachments[e].stub}).length;if(e){var t=x(s);h.body=t.body,h.processData=!1,h.headers=p.extend(h.headers,t.headers)}})["catch"](function(){throw new Error("Did you forget to base64-encode an attachment?")}).then(function(){return u(h)}).then(function(e){e.ok=!0,f(null,e)})})["catch"](f))})),y.post=p.adapterFun("post",function(e,t,n){return"function"==typeof t&&(n=t,t={}),t=g(t),"object"!=typeof e?n(_.error(_.NOT_AN_OBJECT)):("_id"in e||(e._id=p.uuid()),void y.put(e,t,function(e,t){return e?n(e):(t.ok=!0,void n(null,t))}))}),y._bulkDocs=function(e,t,r){"undefined"!=typeof t.new_edits&&(e.new_edits=t.new_edits),v.all(e.docs.map(o)).then(function(){n({headers:g(m.headers),method:"POST",url:a(m,"_bulk_docs"),body:e},function(e,t){return e?r(e):(t.forEach(function(e){e.ok=!0}),void r(null,t))})})["catch"](r)},y.allDocs=p.adapterFun("allDocs",function(e,t){"function"==typeof e&&(t=e,e={}),e=g(e);var r,i=[],o="GET";if(e.conflicts&&i.push("conflicts=true"),e.descending&&i.push("descending=true"),e.include_docs&&i.push("include_docs=true"),e.attachments&&i.push("attachments=true"),e.key&&i.push("key="+encodeURIComponent(JSON.stringify(e.key))),e.startkey&&i.push("startkey="+encodeURIComponent(JSON.stringify(e.startkey))),e.endkey&&i.push("endkey="+encodeURIComponent(JSON.stringify(e.endkey))),"undefined"!=typeof e.inclusive_end&&i.push("inclusive_end="+!!e.inclusive_end),"undefined"!=typeof e.limit&&i.push("limit="+e.limit),"undefined"!=typeof e.skip&&i.push("skip="+e.skip),i=i.join("&"),""!==i&&(i="?"+i),"undefined"!=typeof e.keys){var s="keys="+encodeURIComponent(JSON.stringify(e.keys));s.length+i.length+1<=l?i+=(i.indexOf("?")!==-1?"&":"?")+s:(o="POST",r=JSON.stringify({keys:e.keys}))}n({headers:g(m.headers),method:o,url:a(m,"_all_docs"+i),body:r},t)}),y._changes=function(e){var t="batch_size"in e?e.batch_size:f;e=g(e),e.timeout=e.timeout||3e4;var r={timeout:e.timeout-5e3},i="undefined"!=typeof e.limit&&e.limit;0===i&&(i=1);var o;o=!("returnDocs"in e)||e.returnDocs;var s=i;if(e.style&&(r.style=e.style),(e.include_docs||e.filter&&"function"==typeof e.filter)&&(r.include_docs=!0),e.attachments&&(r.attachments=!0),e.continuous&&(r.feed="longpoll"),e.conflicts&&(r.conflicts=!0),e.descending&&(r.descending=!0),e.filter&&"string"==typeof e.filter&&(r.filter=e.filter,"_view"===e.filter&&e.view&&"string"==typeof e.view&&(r.view=e.view)),e.query_params&&"object"==typeof e.query_params)for(var c in e.query_params)e.query_params.hasOwnProperty(c)&&(r[c]=e.query_params[c]);var u,h="GET";if(e.doc_ids){r.filter="_doc_ids";var d=JSON.stringify(e.doc_ids);d.length<l?r.doc_ids=d:(h="POST",u={doc_ids:e.doc_ids})}if(e.continuous&&y._useSSE)return y.sse(e,r,o);var v,b,w=function(o,c){if(!e.aborted){r.since=o,"object"==typeof r.since&&(r.since=JSON.stringify(r.since)),e.descending?i&&(r.limit=s):r.limit=!i||s>t?t:s;var f="?"+Object.keys(r).map(function(e){return e+"="+r[e]}).join("&"),l={headers:g(m.headers),method:h,url:a(m,"_changes"+f),timeout:e.timeout,body:u};b=o,e.aborted||(v=n(l,c))}},E=10,k=0,x={results:[]},S=function(n,r){if(!e.aborted){var a=0;if(r&&r.results){a=r.results.length,x.last_seq=r.last_seq;var c={};c.query=e.query_params,r.results=r.results.filter(function(t){s--;var n=p.filterChange(e)(t);return n&&(o&&x.results.push(t),p.call(e.onChange,t)),n})}else if(n)return e.aborted=!0,void p.call(e.complete,n);r&&r.last_seq&&(b=r.last_seq);var u=i&&s<=0||r&&a<t||e.descending;if((!e.continuous||i&&s<=0)&&u)p.call(e.complete,null,x);else{n?k+=1:k=0;var f=1<<k,l=E*f,h=e.maximumWait||3e4;if(l>h)return void p.call(e.complete,n||_.error(_.UNKNOWN_ERROR));setTimeout(function(){w(b,S)},l)}}};return w(e.since||0,S),{cancel:function(){e.aborted=!0,v&&v.abort()}}},y.sse=function(e,t,n){function r(t){var r=JSON.parse(t.data);n&&u.results.push(r),u.last_seq=r.seq,p.call(e.onChange,r)}function i(t){return c.removeEventListener("message",r,!1),l===!1?(y._useSSE=!1,void(f=y._changes(e))):(c.close(),void p.call(e.complete,t))}t.feed="eventsource",t.since=e.since||0,t.limit=e.limit,delete t.timeout;var o="?"+Object.keys(t).map(function(e){return e+"="+t[e]}).join("&"),s=a(m,"_changes"+o),c=new EventSource(s),u={results:[],last_seq:!1},f=!1,l=!1;return c.addEventListener("message",r,!1),c.onopen=function(){l=!0},c.onerror=i,{cancel:function(){return f?f.cancel():(c.removeEventListener("message",r,!1),void c.close())}}},y._useSSE=!1,y.revsDiff=p.adapterFun("revsDiff",function(e,t,r){"function"==typeof t&&(r=t,t={}),n({headers:g(m.headers),method:"POST",url:a(m,"_revs_diff"),body:JSON.stringify(e)},r)}),y._close=function(e){e()},y._destroy=function(t){n({url:a(m,""),method:"DELETE",headers:g(m.headers)},function(n,r){n?(y.emit("error",n),t(n)):(y.emit("destroyed"),y.constructor.emit("destroyed",e.name),t(null,r))})}}var f=25,l=1800,h=n(68),d=n(38),p=n(7),v=p.Promise,g=p.clone,y=n(37),m=y.btoa,b=y.atob,_=n(15),w=n(41)("pouchdb:http"),E="undefined"==typeof t||t.browser,k=n(14),x=n(69);u.valid=function(){return!0},e.exports=u}).call(t,n(1))},function(e,t,n){"use strict";var r=n(40);e.exports=function(e,t){var n=new FileReader,i="function"==typeof n.readAsBinaryString;n.onloadend=function(e){var n=e.target.result||"";return i?t(n):void t(r(n))},i?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}},function(e,t,n){(function(t){"use strict";function r(e,t){return h?c(e,{type:t}):d.concat(e.map(function(e){return new d(e,"binary")}))}function i(e){e=l(e);var t=a(),n={};Object.keys(e._attachments).forEach(function(t){var r=e._attachments[t];if(!r.stub){var i=s(r.data);n[t]={type:r.content_type,data:i},r.length=i.length,r.follows=!0,delete r.digest,delete r.data}});var i="--"+t+"\r\nContent-Type: application/json\r\n\r\n",o=[i,JSON.stringify(e)];Object.keys(n).forEach(function(e){var r=n[e],i="\r\n--"+t+"\r\nContent-Disposition: attachment; filename="+JSON.stringify(e)+"\r\nContent-Type: "+r.type+"\r\nContent-Length: "+r.data.length+"\r\n\r\n";o.push(i),o.push(h?u(r.data):r.data)}),o.push("\r\n--"+t+"--");var c="multipart/related; boundary="+t,f=r(o,c);return{headers:{"Content-Type":c},body:f}}var o=n(37),s=o.atob,a=n(17),c=n(12),u=n(39),f=n(7),l=f.clone,h="undefined"==typeof t||t.browser,d=n(14);e.exports=i}).call(t,n(1))},function(e,t,n){(function(t){"use strict";function r(e,t){var n=this;j.queue.push({action:function(t){i(n,e,t)},callback:t}),E()}function i(e,n,i){function u(e){var t=e.createObjectStore(b,{keyPath:"id"});e.createObjectStore(y,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),e.createObjectStore(g,{keyPath:"digest"}),e.createObjectStore(w,{keyPath:"id",autoIncrement:!1}),e.createObjectStore(m),t.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),e.createObjectStore(_,{keyPath:"_id"});var n=e.createObjectStore(v,{autoIncrement:!0});n.createIndex("seq","seq"),n.createIndex("digestSeq","digestSeq",{unique:!0})}function f(e,t){var n=e.objectStore(b);n.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var i=r.value,o=s.isDeleted(i);i.deletedOrLocal=o?"1":"0",n.put(i),r["continue"]()}else t()}}function E(e){e.createObjectStore(_,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function j(e,t){var n=e.objectStore(_),r=e.objectStore(b),i=e.objectStore(y),o=r.openCursor();o.onsuccess=function(e){var o=e.target.result;if(o){var c=o.value,u=c.id,f=s.isLocalId(u),l=a.winningRev(c);if(f){var h=u+"::"+l,d=u+"::",p=u+"::~",v=i.index("_doc_id_rev"),g=IDBKeyRange.bound(d,p,!1,!1),y=v.openCursor(g);y.onsuccess=function(e){if(y=e.target.result){var t=y.value;t._doc_id_rev===h&&n.put(t),i["delete"](y.primaryKey),y["continue"]()}else r["delete"](o.primaryKey),o["continue"]()}}else o["continue"]()}else t&&t()}}function I(e){var t=e.createObjectStore(v,{autoIncrement:!0});t.createIndex("seq","seq"),t.createIndex("digestSeq","digestSeq",{unique:!0})}function N(e,t){var n=e.objectStore(y),r=e.objectStore(g),i=e.objectStore(v),o=r.count();o.onsuccess=function(e){var r=e.target.result;return r?void(n.openCursor().onsuccess=function(e){var n=e.target.result;if(!n)return t();for(var r=n.value,o=n.primaryKey,s=Object.keys(r._attachments||{}),a={},c=0;c<s.length;c++){var u=r._attachments[s[c]];a[u.digest]=!0}var f=Object.keys(a);for(c=0;c<f.length;c++){var l=f[c];i.put({seq:o,digestSeq:l+"::"+o})}n["continue"]()}):t()}}function B(e){function t(e){return e.data?S(e):(e.deleted="1"===e.deletedOrLocal,e)}var n=e.objectStore(y),r=e.objectStore(b),i=r.openCursor();i.onsuccess=function(e){function i(){var e=c.id+"::",t=c.id+"::",r=n.index("_doc_id_rev").openCursor(IDBKeyRange.bound(e,t)),i=0;r.onsuccess=function(e){var t=e.target.result;if(!t)return c.seq=i,o();var n=t.primaryKey;n>i&&(i=n),t["continue"]()}}function o(){var e=A(c,c.winningRev,c.deleted),t=r.put(e);t.onsuccess=function(){s["continue"]()}}var s=e.target.result;if(s){var c=t(s.value);return c.winningRev=c.winningRev||a.winningRev(c),c.seq?o():void i()}}}var M=n.name,P=null;e._meta=null,e.type=function(){return"idb"},e._id=s.toPromise(function(t){t(null,e._meta.instanceId)}),e._bulkDocs=function(t,n,i){l(t,n,e,P,r.Changes,i)},e._get=function(e,t,n){function r(){n(a,{doc:i,metadata:o,ctx:u})}var i,o,a,u;if(t=s.clone(t),t.ctx)u=t.ctx;else{var f=D(P,[b,y,g],"readonly");if(f.error)return n(f.error);u=f.txn}u.objectStore(b).get(e).onsuccess=function(e){if(o=S(e.target.result),!o)return a=c.error(c.MISSING_DOC,"missing"),r();if(s.isDeleted(o)&&!t.rev)return a=c.error(c.MISSING_DOC,"deleted"),r();var n=u.objectStore(y),f=t.rev||o.winningRev,l=o.id+"::"+f;n.index("_doc_id_rev").get(l).onsuccess=function(e){return i=e.target.result,i&&(i=x(i)),i?void r():(a=c.error(c.MISSING_DOC,"missing"),r())}}},e._getAttachment=function(e,t,n){var r;if(t=s.clone(t),t.ctx)r=t.ctx;else{var i=D(P,[b,y,g],"readonly");if(i.error)return n(i.error);r=i.txn}var o=e.digest,a=e.content_type;r.objectStore(g).get(o).onsuccess=function(e){var r=e.target.result.body;C(r,a,t.encode,function(e){n(null,e)})}},e._info=function(t){if(null===P||!L[M]){var n=new Error("db isn't open");return n.id="idbNull",t(n)}var r,i,o=D(P,[y],"readonly");if(o.error)return t(o.error);var s=o.txn,a=s.objectStore(y).openCursor(null,"prev");a.onsuccess=function(t){var n=t.target.result;r=n?n.key:0,i=e._meta.docCount},s.oncomplete=function(){t(null,{doc_count:i,update_seq:r,idb_attachment_format:e._meta.blobSupport?"binary":"base64"})}},e._allDocs=function(t,n){h(t,e,P,n)},e._changes=function(t){function n(e){function n(){return a.seq!==s?e["continue"]():(l=s,a.winningRev===o._rev?i(o):void r())}function r(){var e=o._id+"::"+a.winningRev,t=v.index("_doc_id_rev").openCursor(IDBKeyRange.bound(e,e+""));t.onsuccess=function(e){i(x(e.target.result.value))}}function i(n){var r=t.processChange(n,a,t);r.seq=a.seq,E(r)&&(w++,d&&_.push(r),t.attachments&&t.include_docs?T(n,t,p,function(){R([r]).then(function(){t.onChange(r)})}):t.onChange(r)),w!==h&&e["continue"]()}var o=x(e.value),s=e.key;if(u&&!u.has(o._id))return e["continue"]();var a;return(a=k.get(o._id))?n():void(m.get(o._id).onsuccess=function(e){a=S(e.target.result),k.set(o._id,a),n()})}function i(e){var t=e.target.result;t&&n(t)}function o(){var e=[b,y];t.attachments&&e.push(g);
var n=D(P,e,"readonly");if(n.error)return t.complete(n.error);p=n.txn,p.onerror=O(t.complete),p.oncomplete=a,v=p.objectStore(y),m=p.objectStore(b);var r;r=f?v.openCursor(null,f):v.openCursor(IDBKeyRange.lowerBound(t.since,!0)),r.onsuccess=i}function a(){function e(){t.complete(null,{results:_,last_seq:l})}!t.continuous&&t.attachments?R(_).then(e):e()}if(t=s.clone(t),t.continuous){var c=M+":"+s.uuid();return r.Changes.addListener(M,c,e,t),r.Changes.notify(M),{cancel:function(){r.Changes.removeListener(M,c)}}}var u=t.doc_ids&&new s.Set(t.doc_ids),f=t.descending?"prev":null;t.since=t.since||0;var l=t.since,h="limit"in t?t.limit:-1;0===h&&(h=1);var d;d=!("returnDocs"in t)||t.returnDocs;var p,v,m,_=[],w=0,E=s.filterChange(t),k=new s.Map;o()},e._close=function(e){return null===P?e(c.error(c.NOT_OPEN)):(P.close(),delete L[M],P=null,void e())},e._getRevisionTree=function(e,t){var n=D(P,[b],"readonly");if(n.error)return t(n.error);var r=n.txn,i=r.objectStore(b).get(e);i.onsuccess=function(e){var n=S(e.target.result);n?t(null,n.rev_tree):t(c.error(c.MISSING_DOC))}},e._doCompaction=function(e,t,n){var r=[b,y,g,v],i=D(P,r,"readwrite");if(i.error)return n(i.error);var o=i.txn,c=o.objectStore(b);c.get(e).onsuccess=function(n){var r=S(n.target.result);a.traverseRevTree(r.rev_tree,function(e,n,r,i,o){var s=n+"-"+r;t.indexOf(s)!==-1&&(o.status="missing")}),k(t,e,o);var i=r.winningRev,s=r.deleted;o.objectStore(b).put(A(r,i,s))},o.onerror=O(n),o.oncomplete=function(){s.call(n)}},e._getLocal=function(e,t){var n=D(P,[_],"readonly");if(n.error)return t(n.error);var r=n.txn,i=r.objectStore(_).get(e);i.onerror=O(t),i.onsuccess=function(e){var n=e.target.result;n?(delete n._doc_id_rev,t(null,n)):t(c.error(c.MISSING_DOC))}},e._putLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),delete e._revisions;var r=e._rev,i=e._id;r?e._rev="0-"+(parseInt(r.split("-")[1],10)+1):e._rev="0-1";var o,s=t.ctx;if(!s){var a=D(P,[_],"readwrite");if(a.error)return n(a.error);s=a.txn,s.onerror=O(n),s.oncomplete=function(){o&&n(null,o)}}var u,f=s.objectStore(_);r?(u=f.get(i),u.onsuccess=function(i){var s=i.target.result;if(s&&s._rev===r){var a=f.put(e);a.onsuccess=function(){o={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,o)}}else n(c.error(c.REV_CONFLICT))}):(u=f.add(e),u.onerror=function(e){n(c.error(c.REV_CONFLICT)),e.preventDefault(),e.stopPropagation()},u.onsuccess=function(){o={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,o)})},e._removeLocal=function(e,t){var n=D(P,[_],"readwrite");if(n.error)return t(n.error);var r,i=n.txn;i.oncomplete=function(){r&&t(null,r)};var o=e._id,s=i.objectStore(_),a=s.get(o);a.onerror=O(t),a.onsuccess=function(n){var i=n.target.result;i&&i._rev===e._rev?(s["delete"](o),r={ok:!0,id:o,rev:"0-0"}):t(c.error(c.MISSING_DOC))}},e._destroy=function(e){r.Changes.removeAllListeners(M),r.openReqList[M]&&r.openReqList[M].result&&(r.openReqList[M].result.close(),delete L[M]);var t=indexedDB.deleteDatabase(M);t.onsuccess=function(){r.openReqList[M]&&(r.openReqList[M]=null),s.hasLocalStorage()&&M in localStorage&&delete localStorage[M],e(null,{ok:!0})},t.onerror=O(e)};var q=L[M];if(q)return P=q.idb,e._meta=q.global,void t.nextTick(function(){i(null,e)});var U=indexedDB.open(M,p);"openReqList"in r||(r.openReqList={}),r.openReqList[M]=U,U.onupgradeneeded=function(e){function t(){var e=i[o-1];o++,e&&e(r,t)}var n=e.target.result;if(e.oldVersion<1)return u(n);var r=e.currentTarget.transaction;e.oldVersion<3&&E(n),e.oldVersion<4&&I(n);var i=[f,j,N,B],o=e.oldVersion;t()},U.onsuccess=function(t){P=t.target.result,P.onversionchange=function(){P.close(),delete L[M]},P.onabort=function(){P.close(),delete L[M]};var n=P.transaction([w,m,b],"readwrite"),r=n.objectStore(w).get(w),a=null,c=null,u=null;r.onsuccess=function(t){var r=function(){null!==a&&null!==c&&null!==u&&(e._meta={name:M,instanceId:u,blobSupport:a,docCount:c},L[M]={idb:P,global:e._meta},i(null,e))},f=t.target.result||{id:w};M+"_id"in f?(u=f[M+"_id"],r()):(u=s.uuid(),f[M+"_id"]=u,n.objectStore(w).put(f).onsuccess=function(){r()}),o||(o=d(n,P)),o.then(function(e){a=e,r()});var l=n.objectStore(b).index("deletedOrLocal");l.count(IDBKeyRange.only("0")).onsuccess=function(e){c=e.target.result,r()}}},U.onerror=O(i)}var o,s=n(7),a=n(8),c=n(15),u=n(71),f=n(72),l=n(73),h=n(74),d=n(75),p=f.ADAPTER_VERSION,v=f.ATTACH_AND_SEQ_STORE,g=f.ATTACH_STORE,y=f.BY_SEQ_STORE,m=f.DETECT_BLOB_SUPPORT_STORE,b=f.DOC_STORE,_=f.LOCAL_STORE,w=f.META_STORE,E=u.applyNext,k=u.compactRevs,x=u.decodeDoc,S=u.decodeMetadata,A=u.encodeMetadata,T=u.fetchAttachmentsIfNecessary,O=u.idbError,R=u.postProcessAttachments,C=u.readBlobData,j=u.taskQueue,D=u.openTransactionSafely,L={};r.valid=function(){var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return!e&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},r.Changes=new s.Changes,e.exports=r}).call(t,n(1))},function(e,t,n){(function(e){"use strict";function r(e,t,n){try{e.apply(t,n)}catch(r){"undefined"!=typeof PouchDB&&PouchDB.emit("error",r)}}var i=n(15),o=n(7),s=n(37),a=s.atob,c=s.btoa,u=n(72),f=n(68),l=n(39);t.taskQueue={running:!1,queue:[]},t.applyNext=function(){if(!t.taskQueue.running&&t.taskQueue.queue.length){t.taskQueue.running=!0;var n=t.taskQueue.queue.shift();n.action(function(i,o){r(n.callback,this,[i,o]),t.taskQueue.running=!1,e.nextTick(t.applyNext)})}},t.idbError=function(e){return function(t){var n=t.target&&t.target.error&&t.target.error.name||t.target;e(i.error(i.IDB_ERROR,n,t.type))}},t.encodeMetadata=function(e,t,n){return{data:o.safeJsonStringify(e),winningRev:t,deletedOrLocal:n?"1":"0",seq:e.seq,id:e.id}},t.decodeMetadata=function(e){if(!e)return null;var t=o.safeJsonParse(e.data);return t.winningRev=e.winningRev,t.deleted="1"===e.deletedOrLocal,t.seq=e.seq,t},t.decodeDoc=function(e){if(!e)return e;var t=o.lastIndexOf(e._doc_id_rev,":");return e._id=e._doc_id_rev.substring(0,t-1),e._rev=e._doc_id_rev.substring(t+1),delete e._doc_id_rev,e},t.readBlobData=function(e,t,n,r){n?e?"string"!=typeof e?f(e,function(e){r(c(e))}):r(e):r(""):e?"string"!=typeof e?r(e):(e=l(a(e)),r(o.createBlob([e],{type:t}))):r(o.createBlob([""],{type:t}))},t.fetchAttachmentsIfNecessary=function(e,t,n,r){function i(){++a===s.length&&r&&r()}function o(e,t){var r=e._attachments[t],o=r.digest,s=n.objectStore(u.ATTACH_STORE).get(o);s.onsuccess=function(e){r.body=e.target.result.body,i()}}var s=Object.keys(e._attachments||{});if(!s.length)return r&&r();var a=0;s.forEach(function(n){t.attachments&&t.include_docs?o(e,n):(e._attachments[n].stub=!0,i())})},t.postProcessAttachments=function(e){return o.Promise.all(e.map(function(e){if(e.doc&&e.doc._attachments){var n=Object.keys(e.doc._attachments);return o.Promise.all(n.map(function(n){var r=e.doc._attachments[n];if("body"in r){var i=r.body,s=r.content_type;return new o.Promise(function(a){t.readBlobData(i,s,!0,function(t){e.doc._attachments[n]=o.extend(o.pick(r,["digest","content_type"]),{data:t}),a()})})}}))}}))},t.compactRevs=function(e,t,n){function r(){f--,f||i()}function i(){o.length&&o.forEach(function(e){var t=c.index("digestSeq").count(IDBKeyRange.bound(e+"::",e+"::",!1,!1));t.onsuccess=function(t){var n=t.target.result;n||a["delete"](e)}})}var o=[],s=n.objectStore(u.BY_SEQ_STORE),a=n.objectStore(u.ATTACH_STORE),c=n.objectStore(u.ATTACH_AND_SEQ_STORE),f=e.length;e.forEach(function(e){var n=s.index("_doc_id_rev"),i=t+"::"+e;n.getKey(i).onsuccess=function(e){var t=e.target.result;if("number"!=typeof t)return r();s["delete"](t);var n=c.index("seq").openCursor(IDBKeyRange.only(t));n.onsuccess=function(e){var t=e.target.result;if(t){var n=t.value.digestSeq.split("::")[0];o.push(n),c["delete"](t.primaryKey),t["continue"]()}else r()}}})},t.openTransactionSafely=function(e,t,n){try{return{txn:e.transaction(t,n)}}catch(r){return{error:r}}}}).call(t,n(1))},function(e,t){"use strict";t.ADAPTER_VERSION=5,t.DOC_STORE="document-store",t.BY_SEQ_STORE="by-sequence",t.ATTACH_STORE="attach-store",t.ATTACH_AND_SEQ_STORE="attach-seq-store",t.META_STORE="meta-store",t.LOCAL_STORE="local-store",t.DETECT_BLOB_SUPPORT_STORE="detect-blob-support"},function(e,t,n){"use strict";function r(e,t,n,r,s,a){function b(){var e=[l,f,u,d,h,c],t=m(r,e,"readwrite");return t.error?a(t.error):(j=t.txn,j.onerror=y(a),j.ontimeout=y(a),j.oncomplete=E,D=j.objectStore(l),L=j.objectStore(f),I=j.objectStore(u),N=j.objectStore(c),void x(function(e){return e?(z=!0,a(e)):void w()}))}function _(){i.processDocs(M,n,W,j,H,S,t)}function w(){function e(){++n===M.length&&_()}function t(t){var n=v(t.target.result);n&&W.set(n.id,n),e()}if(M.length)for(var n=0,r=0,o=M.length;r<o;r++){var s=M[r];if(s._id&&i.isLocalId(s._id))e();else{var a=D.get(s.metadata.id);a.onsuccess=t}}}function E(){z||(s.notify(n._meta.name),n._meta.docCount+=P,a(null,H))}function k(e,t){var n=I.get(e);n.onsuccess=function(n){if(n.target.result)t();else{var r=o.error(o.MISSING_STUB,"unknown stub attachment with digest "+e);r.status=412,t(r)}}}function x(e){function t(){++i===n.length&&e(r)}var n=[];if(M.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(t){var r=e.data._attachments[t];r.stub&&n.push(r.digest)})}),!n.length)return e();var r,i=0;n.forEach(function(e){k(e,function(e){e&&!r&&(r=e),t()})})}function S(e,t,n,r,i,o,s,a){P+=o;var c=e.data;c._id=e.metadata.id,c._rev=e.metadata.rev,r&&(c._deleted=!0);var u=c._attachments&&Object.keys(c._attachments).length;return u?O(e,t,n,i,s,a):void T(e,t,n,i,s,a)}function A(e){var t=i.compactTree(e.metadata);p(t,e.metadata.id,j)}function T(e,t,r,i,o,s){function a(o){i&&n.auto_compaction&&A(e),l.seq=o.target.result,delete l.rev;var s=g(l,t,r),a=D.put(s);a.onsuccess=u}function c(e){e.preventDefault(),e.stopPropagation();var t=L.index("_doc_id_rev"),n=t.getKey(f._doc_id_rev);n.onsuccess=function(e){var t=L.put(f,e.target.result);t.onsuccess=a}}function u(){H[o]={ok:!0,id:l.id,rev:t},W.set(e.metadata.id,e.metadata),R(e,l.seq,s)}var f=e.data,l=e.metadata;f._doc_id_rev=l.id+"::"+l.rev,delete f._id,delete f._rev;var h=L.put(f);h.onsuccess=a,h.onerror=c}function O(e,t,n,r,i,o){function s(){u===f.length&&T(e,t,n,r,i,o)}function a(){u++,s()}var c=e.data,u=0,f=Object.keys(c._attachments);f.forEach(function(t){var n=e.data._attachments[t];if(n.stub)u++,s();else{var r=n.data;delete n.data;var i=n.digest;C(i,r,a)}})}function R(e,t,n){function r(){++o===s.length&&n()}function i(n){var i=e.data._attachments[n].digest,o=N.put({seq:t,digestSeq:i+"::"+t});o.onsuccess=r,o.onerror=function(e){e.preventDefault(),e.stopPropagation(),r()}}var o=0,s=Object.keys(e.data._attachments||{});if(!s.length)return n();for(var a=0;a<s.length;a++)i(s[a])}function C(e,t,n){var r=I.count(e);r.onsuccess=function(r){var i=r.target.result;if(i)return n();var o={digest:e,body:t},s=I.put(o);s.onsuccess=n}}for(var j,D,L,I,N,B,M=e.docs,P=0,q=0,U=M.length;q<U;q++){var F=M[q];F._id&&i.isLocalId(F._id)||(F=M[q]=i.parseDoc(F,t.new_edits),F.error&&!B&&(B=F))}if(B)return a(B);var H=new Array(M.length),W=new i.Map,z=!1,J=n._meta.blobSupport?"blob":"base64";i.preprocessAttachments(M,J,function(e){return e?a(e):void b()})}var i=n(7),o=n(15),s=n(71),a=n(72),c=a.ATTACH_AND_SEQ_STORE,u=a.ATTACH_STORE,f=a.BY_SEQ_STORE,l=a.DOC_STORE,h=a.LOCAL_STORE,d=a.META_STORE,p=s.compactRevs,v=s.decodeMetadata,g=s.encodeMetadata,y=s.idbError,m=s.openTransactionSafely;e.exports=r},function(e,t,n){"use strict";function r(e,t,n,r,i){try{if(e&&t)return i?IDBKeyRange.bound(t,e,!n,!1):IDBKeyRange.bound(e,t,!1,!n);if(e)return i?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(t)return i?IDBKeyRange.lowerBound(t,!n):IDBKeyRange.upperBound(t,!n);if(r)return IDBKeyRange.only(r)}catch(o){return{error:o}}return null}function i(e,t,n,r){return"DataError"===n.name&&0===n.code?r(null,{total_rows:e._meta.docCount,offset:t.skip,rows:[]}):void r(a.error(a.IDB_ERROR,n.name,n.message))}function o(e,t,n,o){function a(e,o){function a(t,n,r){var i=t.id+"::"+r;I.get(i).onsuccess=function(r){n.doc=d(r.target.result),e.conflicts&&(n.doc._conflicts=s.collectConflicts(t)),v(n.doc,e,C)}}function c(t,n,r){var i={id:r.id,key:r.id,value:{rev:n}},o=r.deleted;if("ok"===e.deleted)N.push(i),o?(i.value.deleted=!0,i.doc=null):e.include_docs&&a(r,i,n);else if(!o&&k--<=0&&(N.push(i),e.include_docs&&a(r,i,n),0===--x))return;t["continue"]()}function u(e){B=t._meta.docCount;var n=e.target.result;if(n){var r=p(n.value),i=r.winningRev;c(n,i,r)}}function m(){o(null,{total_rows:B,offset:e.skip,rows:N})}function b(){e.attachments?g(N).then(m):m()}var _="startkey"in e&&e.startkey,w="endkey"in e&&e.endkey,E="key"in e&&e.key,k=e.skip||0,x="number"==typeof e.limit?e.limit:-1,S=e.inclusive_end!==!1,A="descending"in e&&e.descending?"prev":null,T=r(_,w,S,E,A);if(T&&T.error)return i(t,e,T.error,o);var O=[h,l];e.attachments&&O.push(f);var R=y(n,O,"readonly");if(R.error)return o(R.error);var C=R.txn,j=C.objectStore(h),D=C.objectStore(l),L=A?j.openCursor(T,A):j.openCursor(T),I=D.index("_doc_id_rev"),N=[],B=0;C.oncomplete=b,L.onsuccess=u}function c(e,n){return 0===e.limit?n(null,{total_rows:t._meta.docCount,offset:e.skip,rows:[]}):void a(e,n)}c(e,o)}var s=n(8),a=n(15),c=n(71),u=n(72),f=u.ATTACH_STORE,l=u.BY_SEQ_STORE,h=u.DOC_STORE,d=c.decodeDoc,p=c.decodeMetadata,v=c.fetchAttachmentsIfNecessary,g=c.postProcessAttachments,y=c.openTransactionSafely;e.exports=o},function(e,t,n){"use strict";function r(e,t){return new i.Promise(function(n,r){var o=i.createBlob([""],{type:"image/png"});e.objectStore(s).put(o,"key"),e.oncomplete=function(){var e=t.transaction([s],"readwrite"),o=e.objectStore(s).get("key");o.onerror=r,o.onsuccess=function(e){var t=e.target.result,r=URL.createObjectURL(t);i.ajax({url:r,cache:!0,binary:!0},function(e,t){e&&405===e.status?n(!0):(n(!(!t||"image/png"!==t.type)),e&&404===e.status&&i.explain404("PouchDB is just detecting blob URL support.")),URL.revokeObjectURL(r)})}}})["catch"](function(){return!1})}var i=n(7),o=n(72),s=o.DETECT_BLOB_SUPPORT_STORE;e.exports=r},function(e,t,n){"use strict";function r(e,t,n,r,i){function s(){++u===c.length&&i&&i()}function a(e,t){var i=e._attachments[t],a={encode:!0,ctx:r};n._getAttachment(i,a,function(n,r){e._attachments[t]=o.extend(o.pick(i,["digest","content_type"]),{data:r}),s()})}var c=Object.keys(e._attachments||{});if(!c.length)return i&&i();var u=0;c.forEach(function(n){t.attachments&&t.include_docs?a(e,n):(e._attachments[n].stub=!0,s())})}function i(e,t){function n(){o.hasLocalStorage()&&(window.localStorage["_pouch__websqldb_"+Y._name]=!0),t(null,Y)}function f(e,t){e.executeSql(j),e.executeSql("ALTER TABLE "+v+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){e.executeSql(R),e.executeSql("ALTER TABLE "+p+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){e.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+p+" (local, id)");var n="SELECT "+p+".winningseq AS seq, "+p+".json AS metadata FROM "+v+" JOIN "+p+" ON "+v+".seq = "+p+".winningseq";e.executeSql(n,[],function(e,n){for(var r=[],i=[],s=0;s<n.rows.length;s++){var a=n.rows.item(s),c=a.seq,u=JSON.parse(a.metadata);o.isDeleted(u)&&r.push(c),o.isLocalId(u.id)&&i.push(u.id)}e.executeSql("UPDATE "+p+"SET local = 1 WHERE id IN "+_(i.length),i,function(){e.executeSql("UPDATE "+v+" SET deleted = 1 WHERE seq IN "+_(r.length),r,t)})})})})}function B(e,t){var n="CREATE TABLE IF NOT EXISTS "+y+" (id UNIQUE, rev, json)";e.executeSql(n,[],function(){var n="SELECT "+p+".id AS id, "+v+".json AS data FROM "+v+" JOIN "+p+" ON "+v+".seq = "+p+".winningseq WHERE local = 1";e.executeSql(n,[],function(e,n){function r(){if(!i.length)return t(e);var n=i.shift(),o=JSON.parse(n.data)._rev;e.executeSql("INSERT INTO "+y+" (id, rev, json) VALUES (?,?,?)",[n.id,o,n.data],function(e){e.executeSql("DELETE FROM "+p+" WHERE id=?",[n.id],function(e){e.executeSql("DELETE FROM "+v+" WHERE seq=?",[n.seq],function(){r()})})})}for(var i=[],o=0;o<n.rows.length;o++)i.push(n.rows.item(o));r()})})}function M(e,t){function n(n){function r(){if(!n.length)return t(e);var i=n.shift(),o=c(i.hex,K),s=o.lastIndexOf("::"),a=o.substring(0,s),u=o.substring(s+2),f="UPDATE "+v+" SET doc_id=?, rev=? WHERE doc_id_rev=?";e.executeSql(f,[a,u,o],function(){r()})}r()}var r="ALTER TABLE "+v+" ADD COLUMN doc_id";e.executeSql(r,[],function(e){var t="ALTER TABLE "+v+" ADD COLUMN rev";e.executeSql(t,[],function(e){e.executeSql(C,[],function(e){var t="SELECT hex(doc_id_rev) as hex FROM "+v;e.executeSql(t,[],function(e,t){for(var r=[],i=0;i<t.rows.length;i++)r.push(t.rows.item(i));n(r)})})})})}function P(e,t){function n(e){var n="SELECT COUNT(*) AS cnt FROM "+g;e.executeSql(n,[],function(e,n){function r(){var n=k(N+", "+p+".id AS id",[p,v],I,null,p+".id ");n+=" LIMIT "+s+" OFFSET "+o,o+=s,e.executeSql(n,[],function(e,n){function i(e,t){var n=o[e]=o[e]||[];n.indexOf(t)===-1&&n.push(t)}if(!n.rows.length)return t(e);for(var o={},s=0;s<n.rows.length;s++)for(var a=n.rows.item(s),c=E(a.data,a.id,a.rev),u=Object.keys(c._attachments||{}),f=0;f<u.length;f++){var l=c._attachments[u[f]];i(l.digest,a.seq)}var h=[];if(Object.keys(o).forEach(function(e){var t=o[e];t.forEach(function(t){h.push([e,t])})}),!h.length)return r();var d=0;h.forEach(function(t){var n="INSERT INTO "+b+" (digest, seq) VALUES (?,?)";e.executeSql(n,t,function(){++d===h.length&&r()})})})}var i=n.rows.item(0).cnt;if(!i)return t(e);var o=0,s=10;r()})}var r="CREATE TABLE IF NOT EXISTS "+b+" (digest, seq INTEGER)";e.executeSql(r,[],function(e){e.executeSql(L,[],function(e){e.executeSql(D,[],n)})})}function q(e,t){var n="ALTER TABLE "+g+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";e.executeSql(n,[],t)}function U(e,t){var n="ALTER TABLE "+p+" ADD COLUMN max_seq INTEGER";e.executeSql(n,[],function(e){var n="UPDATE "+p+" SET max_seq=(SELECT MAX(seq) FROM "+v+" WHERE doc_id=id)";e.executeSql(n,[],function(e){var n="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+p+" (max_seq)";e.executeSql(n,[],t)})})}function F(e,t){e.executeSql('SELECT HEX("a") AS hex',[],function(e,n){var r=n.rows.item(0).hex;K=2===r.length?"UTF-8":"UTF-16",t()})}function H(){for(;Q.length>0;){var e=Q.pop();e(null,G)}}function W(e,t){if(0===t){var n="CREATE TABLE IF NOT EXISTS "+m+" (dbid, db_version INTEGER)",r="CREATE TABLE IF NOT EXISTS "+g+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",i="CREATE TABLE IF NOT EXISTS "+b+" (digest, seq INTEGER)",s="CREATE TABLE IF NOT EXISTS "+p+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",a="CREATE TABLE IF NOT EXISTS "+v+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",c="CREATE TABLE IF NOT EXISTS "+y+" (id UNIQUE, rev, json)";e.executeSql(r),e.executeSql(c),e.executeSql(i,[],function(){e.executeSql(D),e.executeSql(L)}),e.executeSql(s,[],function(){e.executeSql(j),e.executeSql(a,[],function(){e.executeSql(R),e.executeSql(C),e.executeSql(n,[],function(){var t="INSERT INTO "+m+" (db_version, dbid) VALUES (?,?)";G=o.uuid();var n=[d,G];e.executeSql(t,n,function(){H()})})})})}else{var u=function(){var n=t<d;n&&e.executeSql("UPDATE "+m+" SET db_version = "+d);var r="SELECT dbid FROM "+m;e.executeSql(r,[],function(e,t){G=t.rows.item(0).dbid,H()})},l=[f,B,M,P,q,U,u],h=t,_=function(e){l[h-1](e,_),h++};_(e)}}function z(){$.transaction(function(e){F(e,function(){J(e)})},S(t),n)}function J(e){var t="SELECT sql FROM sqlite_master WHERE tbl_name = "+m;e.executeSql(t,[],function(e,t){t.rows.length?/db_version/.test(t.rows.item(0).sql)?e.executeSql("SELECT db_version FROM "+m,[],function(e,t){var n=t.rows.item(0).db_version;W(e,n)}):e.executeSql("ALTER TABLE "+m+" ADD COLUMN db_version INTEGER",[],function(){W(e,1)}):W(e,0)})}function V(e,t){if(Y._docCount!==-1)return t(Y._docCount);var n=k("COUNT("+p+".id) AS 'num'",[p,v],I,v+".deleted=0");e.executeSql(n,[],function(e,n){Y._docCount=n.rows.item(0).num,t(Y._docCount)})}var K,Y=this,G=null,X=A(e),Q=[];Y._docCount=-1,Y._name=e.name;var $=T({name:Y._name,version:O,description:Y._name,size:X,location:e.location,createFromLocation:e.createFromLocation,androidDatabaseImplementation:e.androidDatabaseImplementation});return $?("function"!=typeof $.readTransaction&&($.readTransaction=$.transaction),o.isCordova()?window.addEventListener(Y._name+"_pouch",function Z(){window.removeEventListener(Y._name+"_pouch",Z,!1),z()},!1):z(),Y.type=function(){return"websql"},Y._id=o.toPromise(function(e){e(null,G)}),Y._info=function(e){$.readTransaction(function(t){V(t,function(n){var r="SELECT MAX(seq) AS seq FROM "+v;t.executeSql(r,[],function(t,r){var i=r.rows.item(0).seq||0;e(null,{doc_count:n,update_seq:i,sqlite_plugin:$._sqlitePlugin,websql_encoding:K})})})},S(e))},Y._bulkDocs=function(e,t,n){h(e,t,Y,$,i.Changes,n)},Y._get=function(e,t,n){function r(){n(c,{doc:i,metadata:s,ctx:l})}t=o.clone(t);var i,s,c;if(!t.ctx)return void $.readTransaction(function(r){t.ctx=r,Y._get(e,t,n)});var u,f,l=t.ctx;t.rev?(u=k(N,[p,v],p+".id="+v+".doc_id",[v+".doc_id=?",v+".rev=?"]),f=[e,t.rev]):(u=k(N,[p,v],I,p+".id=?"),f=[e]),l.executeSql(u,f,function(e,n){if(!n.rows.length)return c=a.error(a.MISSING_DOC,"missing"),r();var u=n.rows.item(0);return s=o.safeJsonParse(u.metadata),u.deleted&&!t.rev?(c=a.error(a.MISSING_DOC,"deleted"),r()):(i=E(u.data,s.id,u.rev),void r())})},Y._allDocs=function(e,t){var n,i=[],a="startkey"in e&&e.startkey,c="endkey"in e&&e.endkey,u="key"in e&&e.key,f="descending"in e&&e.descending,l="limit"in e?e.limit:-1,h="skip"in e?e.skip:0,d=e.inclusive_end!==!1,g=[],y=[];if(u!==!1)y.push(p+".id = ?"),g.push(u);else if(a!==!1||c!==!1){if(a!==!1&&(y.push(p+".id "+(f?"<=":">=")+" ?"),g.push(a)),c!==!1){var m=f?">":"<";d&&(m+="="),y.push(p+".id "+m+" ?"),g.push(c)}u!==!1&&(y.push(p+".id = ?"),g.push(u))}"ok"!==e.deleted&&y.push(v+".deleted = 0"),$.readTransaction(function(t){V(t,function(a){if(n=a,0!==l){var c=k(N,[p,v],I,y,p+".id "+(f?"DESC":"ASC"));c+=" LIMIT "+l+" OFFSET "+h,t.executeSql(c,g,function(t,n){for(var a=0,c=n.rows.length;a<c;a++){var u=n.rows.item(a),f=o.safeJsonParse(u.metadata),l=f.id,h=E(u.data,l,u.rev),d=h._rev,p={id:l,key:l,value:{rev:d}};if(e.include_docs&&(p.doc=h,p.doc._rev=d,e.conflicts&&(p.doc._conflicts=s.collectConflicts(f)),r(p.doc,e,Y,t)),u.deleted){if("ok"!==e.deleted)continue;p.value.deleted=!0,p.doc=null}i.push(p)}})}})},S(t),function(){t(null,{total_rows:n,offset:e.skip,rows:i})})},Y._changes=function(e){function t(){var t=p+".json AS metadata, "+p+".max_seq AS maxSeq, "+v+".json AS winningDoc, "+v+".rev AS winningRev ",n=p+" JOIN "+v,i=p+".id="+v+".doc_id AND "+p+".winningseq="+v+".seq",l=["maxSeq > ?"],h=[e.since];e.doc_ids&&(l.push(p+".id IN "+_(e.doc_ids.length)),h=h.concat(e.doc_ids));var d="maxSeq "+(s?"DESC":"ASC"),g=k(t,n,i,l,d),y=o.filterChange(e);e.view||e.filter||(g+=" LIMIT "+a);var m=e.since||0;$.readTransaction(function(t){t.executeSql(g,h,function(t,n){function i(t){return function(){e.onChange(t)}}for(var s=0,l=n.rows.length;s<l;s++){var h=n.rows.item(s),d=o.safeJsonParse(h.metadata);m=h.maxSeq;var p=E(h.winningDoc,d.id,h.winningRev),v=e.processChange(p,d,e);if(v.seq=h.maxSeq,y(v)&&(f++,c&&u.push(v),e.attachments&&e.include_docs?r(p,e,Y,t,i(v)):i(v)()),f===a)break}})},S(e.complete),function(){e.continuous||e.complete(null,{results:u,last_seq:m})})}if(e=o.clone(e),e.continuous){var n=Y._name+":"+o.uuid();return i.Changes.addListener(Y._name,n,Y,e),i.Changes.notify(Y._name),{cancel:function(){i.Changes.removeListener(Y._name,n)}}}var s=e.descending;e.since=e.since&&!s?e.since:0;var a="limit"in e?e.limit:-1;0===a&&(a=1);var c;c=!("returnDocs"in e)||e.returnDocs;var u=[],f=0;t()},Y._close=function(e){e()},Y._getAttachment=function(e,t,n){var r,i=t.ctx,s=e.digest,a=e.content_type,f="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+g+" WHERE digest=?";i.executeSql(f,[s],function(e,i){var s=i.rows.item(0),f=s.escaped?l.unescapeBlob(s.body):c(s.body,K);r=t.encode?o.btoa(f):u(f,a),n(null,r)})},Y._getRevisionTree=function(e,t){$.readTransaction(function(n){var r="SELECT json AS metadata FROM "+p+" WHERE id = ?";n.executeSql(r,[e],function(e,n){if(n.rows.length){var r=o.safeJsonParse(n.rows.item(0).metadata);t(null,r.rev_tree)}else t(a.error(a.MISSING_DOC))})})},Y._doCompaction=function(e,t,n){return t.length?void $.transaction(function(n){var r="SELECT json AS metadata FROM "+p+" WHERE id = ?";n.executeSql(r,[e],function(n,r){var i=o.safeJsonParse(r.rows.item(0).metadata);s.traverseRevTree(i.rev_tree,function(e,n,r,i,o){var s=n+"-"+r;t.indexOf(s)!==-1&&(o.status="missing")});var a="UPDATE "+p+" SET json = ? WHERE id = ?";n.executeSql(a,[o.safeJsonStringify(i),e])}),x(t,e,n)},S(n),function(){n()}):n()},Y._getLocal=function(e,t){$.readTransaction(function(n){var r="SELECT json, rev FROM "+y+" WHERE id=?";n.executeSql(r,[e],function(n,r){if(r.rows.length){var i=r.rows.item(0),o=E(i.json,e,i.rev);t(null,o)}else t(a.error(a.MISSING_DOC))})})},Y._putLocal=function(e,t,n){function r(e){var r,f;o?(r="UPDATE "+y+" SET rev=?, json=? WHERE id=? AND rev=?",f=[i,u,s,o]):(r="INSERT INTO "+y+" (id, rev, json) VALUES (?,?,?)",f=[s,i,u]),e.executeSql(r,f,function(e,r){r.rowsAffected?(c={ok:!0,id:s,rev:i},t.ctx&&n(null,c)):n(a.error(a.REV_CONFLICT))},function(){return n(a.error(a.REV_CONFLICT)),!1})}"function"==typeof t&&(n=t,t={}),delete e._revisions;var i,o=e._rev,s=e._id;i=o?e._rev="0-"+(parseInt(o.split("-")[1],10)+1):e._rev="0-1";var c,u=w(e);t.ctx?r(t.ctx):$.transaction(function(e){r(e)},S(n),function(){c&&n(null,c)})},Y._removeLocal=function(e,t){var n;$.transaction(function(r){var i="DELETE FROM "+y+" WHERE id=? AND rev=?",o=[e._id,e._rev];r.executeSql(i,o,function(r,i){return i.rowsAffected?void(n={ok:!0,id:e._id,rev:"0-0"}):t(a.error(a.MISSING_DOC))})},S(t),function(){n&&t(null,n)})},void(Y._destroy=function(e){i.Changes.removeAllListeners(Y._name),$.transaction(function(e){var t=[p,v,g,m,y,b];t.forEach(function(t){e.executeSql("DROP TABLE IF EXISTS "+t,[])})},S(e),function(){o.hasLocalStorage()&&(delete window.localStorage["_pouch__websqldb_"+Y._name],delete window.localStorage[Y._name]),e(null,{ok:!0})})})):t(a.error(a.UNKNOWN_ERROR))}var o=n(7),s=n(8),a=n(15),c=n(77),u=n(38),f=n(78),l=n(79),h=n(80),d=f.ADAPTER_VERSION,p=f.DOC_STORE,v=f.BY_SEQ_STORE,g=f.ATTACH_STORE,y=f.LOCAL_STORE,m=f.META_STORE,b=f.ATTACH_AND_SEQ_STORE,_=l.qMarks,w=l.stringifyDoc,E=l.unstringifyDoc,k=l.select,x=l.compactRevs,S=l.unknownError,A=l.getSize,T=l.openDB,O=1,R="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+v+" (seq, deleted)",C="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+v+" (doc_id, rev)",j="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+p+" (winningseq)",D="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+b+" (seq)",L="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+b+" (digest, seq)",I=v+".seq = "+p+".winningseq",N=v+".seq AS seq, "+v+".deleted AS deleted, "+v+".json AS data, "+v+".rev AS rev, "+p+".json AS metadata";i.valid=l.valid,i.Changes=new o.Changes,e.exports=i},function(e,t){"use strict";function n(e){return decodeURIComponent(window.escape(e))}function r(e){return e<65?e-48:e-55}function i(e,t,n){for(var i="";t<n;)i+=String.fromCharCode(r(e.charCodeAt(t++))<<4|r(e.charCodeAt(t++)));return i}function o(e,t,n){for(var i="";t<n;)i+=String.fromCharCode(r(e.charCodeAt(t+2))<<12|r(e.charCodeAt(t+3))<<8|r(e.charCodeAt(t))<<4|r(e.charCodeAt(t+1))),t+=4;return i}function s(e,t){return"UTF-8"===t?n(i(e,0,e.length)):o(e,0,e.length)}e.exports=s},function(e,t){"use strict";function n(e){return"'"+e+"'"}t.ADAPTER_VERSION=7,t.DOC_STORE=n("document-store"),t.BY_SEQ_STORE=n("by-sequence"),t.ATTACH_STORE=n("attach-store"),t.LOCAL_STORE=n("local-store"),t.META_STORE=n("metadata-store"),t.ATTACH_AND_SEQ_STORE=n("attach-seq-store")},function(e,t,n){"use strict";function r(e){return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function i(e){return e.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function o(e){return delete e._id,delete e._rev,JSON.stringify(e)}function s(e,t,n){return e=JSON.parse(e),e._id=t,e._rev=n,e}function a(e){for(var t="(";e--;)t+="?",e&&(t+=",");return t+")"}function c(e,t,n,r,i){return"SELECT "+e+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(n?" ON "+n:"")+(r?" WHERE "+("string"==typeof r?r:r.join(" AND ")):"")+(i?" ORDER BY "+i:"")}function u(e,t,n){function r(){++o===e.length&&i()}function i(){if(s.length){var e="SELECT DISTINCT digest AS digest FROM "+_+" WHERE seq IN "+a(s.length);n.executeSql(e,s,function(e,t){for(var n=[],r=0;r<t.rows.length;r++)n.push(t.rows.item(r).digest);if(n.length){var i="DELETE FROM "+_+" WHERE seq IN ("+s.map(function(){return"?"}).join(",")+")";e.executeSql(i,s,function(e){var t="SELECT digest FROM "+_+" WHERE digest IN ("+n.map(function(){return"?"}).join(",")+")";e.executeSql(t,n,function(e,t){for(var r=new v.Set,i=0;i<t.rows.length;i++)r.add(t.rows.item(i).digest);n.forEach(function(t){r.has(t)||(e.executeSql("DELETE FROM "+_+" WHERE digest=?",[t]),e.executeSql("DELETE FROM "+b+" WHERE digest=?",[t]))})})})}})}}if(e.length){var o=0,s=[];e.forEach(function(e){var i="SELECT seq FROM "+m+" WHERE doc_id=? AND rev=?";n.executeSql(i,[t,e],function(e,t){if(!t.rows.length)return r();var n=t.rows.item(0).seq;s.push(n),e.executeSql("DELETE FROM "+m+" WHERE seq=?",[n],r)})})}}function f(e){return function(t){var n=t&&t.constructor.toString().match(/function ([^\(]+)/),r=n&&n[1]||t.type,i=t.target||t.message;e(g.error(g.WSQ_ERROR,i,r))}}function l(e){if("size"in e)return 1e6*e.size;var t=/Android/.test(window.navigator.userAgent);return t?5e6:1}function h(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(e){return openDatabase(e.name,e.version,e.description,e.size)}:void 0}function d(e){var t=h(),n=w[e.name];return n||(n=w[e.name]=t(e),n._sqlitePlugin="undefined"!=typeof sqlitePlugin),n}function p(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}var v=n(7),g=n(15),y=n(78),m=y.BY_SEQ_STORE,b=y.ATTACH_STORE,_=y.ATTACH_AND_SEQ_STORE,w={};e.exports={escapeBlob:r,unescapeBlob:i,stringifyDoc:o,unstringifyDoc:s,qMarks:a,select:c,compactRevs:u,unknownError:f,getSize:l,openDB:d,valid:p}},function(e,t,n){"use strict";function r(e,t,n,r,a,g){function y(){return R?g(R):(a.notify(n._name),n._docCount=-1,void g(null,C))}function m(e,t){var n="SELECT count(*) as cnt FROM "+f+" WHERE digest=?";O.executeSql(n,[e],function(n,r){if(0===r.rows.item(0).cnt){var i=o.error(o.MISSING_STUB,"unknown stub attachment with digest "+e);t(i)}else t()})}function b(e){function t(){++i===n.length&&e(r)}var n=[];if(A.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(t){var r=e.data._attachments[t];r.stub&&n.push(r.digest)})}),!n.length)return e();var r,i=0;n.forEach(function(e){m(e,function(e){e&&!r&&(r=e),t()})})}function _(e,t,r,o,s,a,f,v){function g(){function t(e,t){function r(){return++o===s.length&&t(),!1}function i(t){var i="INSERT INTO "+l+" (digest, seq) VALUES (?,?)",o=[n._attachments[t].digest,e];O.executeSql(i,o,r,r)}var o=0,s=Object.keys(n._attachments||{});if(!s.length)return t();for(var a=0;a<s.length;a++)i(s[a])}var n=e.data,r=o?1:0,i=n._id,s=n._rev,a=d(n),c="INSERT INTO "+u+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",f=[i,s,a,r];O.executeSql(c,f,function(e,n){var r=n.insertId;t(r,function(){_(e,r)})},function(){var e=h("seq",u,null,"doc_id=? AND rev=?");return O.executeSql(e,[i,s],function(e,n){var o=n.rows.item(0).seq,c="UPDATE "+u+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",f=[a,r,i,s];e.executeSql(c,f,function(e){t(o,function(){_(e,o)})})}),!1})}function y(e){w||(e?(w=e,v(w)):E===x.length&&g())}function m(e){E++,y(e)}function b(){if(s&&n.auto_compaction){var t=e.metadata.id,r=i.compactTree(e.metadata);p(r,t,O)}}function _(n,r){b(),e.metadata.seq=r,delete e.metadata.rev;var o=s?"UPDATE "+c+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+u+" WHERE doc_id="+c+".id AND rev=?) WHERE id=?":"INSERT INTO "+c+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",a=i.safeJsonStringify(e.metadata),l=e.metadata.id,h=s?[a,r,t,l]:[l,r,r,a];
n.executeSql(o,h,function(){C[f]={ok:!0,id:e.metadata.id,rev:t},j.set(l,e.metadata),v()})}var w=null,E=0;e.data._id=e.metadata.id,e.data._rev=e.metadata.rev;var x=Object.keys(e.data._attachments||{});o&&(e.data._deleted=!0),x.forEach(function(t){var n=e.data._attachments[t];if(n.stub)E++,y();else{var r=n.data;delete n.data;var i=n.digest;k(i,r,m)}}),x.length||g()}function w(){i.processDocs(A,n,j,O,C,_,t)}function E(e){function t(){++n===A.length&&e()}if(!A.length)return e();var n=0;A.forEach(function(e){if(e._id&&i.isLocalId(e._id))return t();var n=e.metadata.id;O.executeSql("SELECT json FROM "+c+" WHERE id = ?",[n],function(e,r){if(r.rows.length){var o=i.safeJsonParse(r.rows.item(0).json);j.set(n,o)}t()})})}function k(e,t,n){var r="SELECT digest FROM "+f+" WHERE digest=?";O.executeSql(r,[e],function(i,o){return o.rows.length?n():(r="INSERT INTO "+f+" (digest, body, escaped) VALUES (?,?,1)",void i.executeSql(r,[e,s.escapeBlob(t)],function(){n()},function(){return n(),!1}))})}var x=t.new_edits,S=e.docs,A=S.map(function(e){if(e._id&&i.isLocalId(e._id))return e;var t=i.parseDoc(e,x);return t}),T=A.filter(function(e){return e.error});if(T.length)return g(T[0]);var O,R,C=new Array(A.length),j=new i.Map;i.preprocessAttachments(A,"binary",function(e){return e?g(e):void r.transaction(function(e){O=e,b(function(e){e?R=e:E(w)})},v(g),y)})}var i=n(7),o=n(15),s=n(79),a=n(78),c=a.DOC_STORE,u=a.BY_SEQ_STORE,f=a.ATTACH_STORE,l=a.ATTACH_AND_SEQ_STORE,h=s.select,d=s.stringifyDoc,p=s.compactRevs,v=s.unknownError;e.exports=r},function(e,t,n){(function(e){"use strict";function r(e){return e.indexOf("/")===-1?[e,e]:e.split("/")}function i(e){return 1===e.length&&/^1-/.test(e[0].rev)}function o(e,t){try{e.emit("error",t)}catch(n){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(t)}}function s(e,t,n){try{return{output:t.apply(null,n)}}catch(r){return o(e,r),{error:r}}}function a(e,t){var n=L(e.key,t.key);return 0!==n?n:L(e.value,t.value)}function c(e,t,n){return n=n||0,"number"==typeof t?e.slice(n,t+n):n>0?e.slice(n):e}function u(e){var t=e.value,n=t&&"object"==typeof t&&t._id||e.id;return n}function f(e){var t="builtin "+e+" function requires map values to be numbers or number arrays";return new R(t)}function l(e){for(var t=0,n=0,r=e.length;n<r;n++){var i=e[n];if("number"!=typeof i){if(!Array.isArray(i))throw f("_sum");t="number"==typeof t?[t]:t;for(var o=0,s=i.length;o<s;o++){var a=i[o];if("number"!=typeof a)throw f("_sum");"undefined"==typeof t[o]?t.push(a):t[o]+=a}}else"number"==typeof t?t+=i:t[0]+=i}return t}function h(e,t,n,r){var i=t[e];"undefined"!=typeof i&&(r&&(i=encodeURIComponent(JSON.stringify(i))),n.push(e+"="+i))}function d(e,t){var n=e.descending?"endkey":"startkey",r=e.descending?"startkey":"endkey";if("undefined"!=typeof e[n]&&"undefined"!=typeof e[r]&&L(e[n],e[r])>0)throw new T("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(t.reduce&&e.reduce!==!1){if(e.include_docs)throw new T("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new T("Multi-key fetches for reduce views must use {group: true}")}if(e.group_level){if("number"!=typeof e.group_level)throw new T('Invalid value for integer: "'+e.group_level+'"');if(e.group_level<0)throw new T('Invalid value for positive integer: "'+e.group_level+'"')}}function p(e,t,n){var i,o=[],s="GET";if(h("reduce",n,o),h("include_docs",n,o),h("attachments",n,o),h("limit",n,o),h("descending",n,o),h("group",n,o),h("group_level",n,o),h("skip",n,o),h("stale",n,o),h("conflicts",n,o),h("startkey",n,o,!0),h("endkey",n,o,!0),h("inclusive_end",n,o),h("key",n,o,!0),o=o.join("&"),o=""===o?"":"?"+o,"undefined"!=typeof n.keys){var a=2e3,c="keys="+encodeURIComponent(JSON.stringify(n.keys));c.length+o.length+1<=a?o+=("?"===o[0]?"&":"?")+c:(s="POST","string"==typeof t?i=JSON.stringify({keys:n.keys}):t.keys=n.keys)}if("string"==typeof t){var u=r(t);return e.request({method:s,url:"_design/"+u[0]+"/_view/"+u[1]+o,body:i})}return i=i||{},Object.keys(t).forEach(function(e){Array.isArray(t[e])?i[e]=t[e]:i[e]=t[e].toString()}),e.request({method:"POST",url:"_temp_view"+o,body:i})}function v(e){return function(t){if(404===t.status)return e;throw t}}function g(e,t,n){function r(){return i(l)?q.resolve(c):t.db.get(a)["catch"](v(c))}function o(e){return e.keys.length?t.db.allDocs({keys:e.keys,include_docs:!0}):q.resolve({rows:[]})}function s(e,t){for(var n=[],r={},i=0,o=t.rows.length;i<o;i++){var s=t.rows[i],a=s.doc;if(a&&(n.push(a),r[a._id]=!0,a._deleted=!f[a._id],!a._deleted)){var c=f[a._id];"value"in c&&(a.value=c.value)}}var u=Object.keys(f);return u.forEach(function(e){if(!r[e]){var t={_id:e},i=f[e];"value"in i&&(t.value=i.value),n.push(t)}}),e.keys=P.uniq(u.concat(e.keys)),n.push(e),n}var a="_local/doc_"+e,c={_id:a,keys:[]},u=n[e],f=u.indexableKeysToKeyValues,l=u.changes;return r().then(function(e){return o(e).then(function(t){return s(e,t)})})}function y(e,t,n){var r="_local/lastSeq";return e.db.get(r)["catch"](v({_id:r,seq:0})).then(function(r){var i=Object.keys(t);return q.all(i.map(function(n){return g(n,e,t)})).then(function(t){var i=P.flatten(t);return r.seq=n,i.push(r),e.db.bulkDocs({docs:i})})})}function m(e){var t="string"==typeof e?e:e.name,n=U[t];return n||(n=U[t]=new D),n}function b(e){return P.sequentialize(m(e),function(){return _(e)})()}function _(e){function t(e,t){var n={id:i._id,key:N(e)};"undefined"!=typeof t&&null!==t&&(n.value=N(t)),r.push(n)}function n(t,n){return function(){return y(e,t,n)}}var r,i,o;if("function"==typeof e.mapFun&&2===e.mapFun.length){var c=e.mapFun;o=function(e){return c(e,t)}}else o=M(e.mapFun.toString(),t,l,C,Array.isArray,JSON.parse);var u=e.seq||0,f=new D;return new q(function(t,c){function l(){f.finish().then(function(){e.seq=u,t()})}function h(){function t(e){c(e)}e.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:u,limit:H}).on("complete",function(t){var c=t.results;if(!c.length)return l();for(var d={},p=0,v=c.length;p<v;p++){var g=c[p];if("_"!==g.doc._id[0]){r=[],i=g.doc,i._deleted||s(e.sourceDB,o,[i]),r.sort(a);for(var y,m={},b=0,_=r.length;b<_;b++){var w=r[b],E=[w.key,w.id];0===L(w.key,y)&&E.push(b);var k=I(E);m[k]=w,y=w.key}d[g.doc._id]={indexableKeysToKeyValues:m,changes:g.changes}}u=g.seq}return f.add(n(d,u)),c.length<H?l():h()}).on("error",t)}h()})}function w(e,t,n){0===n.group_level&&delete n.group_level;var r,i=n.group||n.group_level;r=W[e.reduceFun]?W[e.reduceFun]:M(e.reduceFun.toString(),null,l,C,Array.isArray,JSON.parse);var o=[],a=n.group_level;t.forEach(function(e){var t=o[o.length-1],n=i?e.key:null;return i&&Array.isArray(n)&&"number"==typeof a&&(n=n.length>a?n.slice(0,a):n),t&&0===L(t.key[0][0],n)?(t.key.push([n,e.id]),void t.value.push(e.value)):void o.push({key:[[n,e.id]],value:[e.value]})});for(var u=0,f=o.length;u<f;u++){var h=o[u],d=s(e.sourceDB,r,[h.key,h.value,!1]);if(d.error&&d.error instanceof R)throw d.error;h.value=d.error?null:d.output,h.key=h.key[0][0]}return{rows:c(o,n.limit,n.skip)}}function E(e,t){return P.sequentialize(m(e),function(){return k(e,t)})()}function k(e,t){function n(t){return t.include_docs=!0,e.db.allDocs(t).then(function(e){return i=e.total_rows,e.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){var t=Object.keys(e.doc.value).sort(),n=["id","key","value"];if(!(t<n||t>n))return e.doc.value}var r=j.parseIndexableString(e.doc._id);return{key:r[0],id:r[1],value:"value"in e.doc?e.doc.value:null}})})}function r(n){var r;if(r=o?w(e,n,t):{total_rows:i,offset:s,rows:n},t.include_docs){var a=P.uniq(n.map(u));return e.sourceDB.allDocs({keys:a,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments}).then(function(e){var t={};return e.rows.forEach(function(e){e.doc&&(t["$"+e.id]=e.doc)}),n.forEach(function(e){var n=u(e),r=t["$"+n];r&&(e.doc=r)}),r})}return r}var i,o=e.reduceFun&&t.reduce!==!1,s=t.skip||0;"undefined"==typeof t.keys||t.keys.length||(t.limit=0,delete t.keys);var a=function(e){return e.reduce(function(e,t){return e.concat(t)})};if("undefined"!=typeof t.keys){var c=t.keys,f=c.map(function(e){var t={startkey:I([e]),endkey:I([e,{}])};return n(t)});return q.all(f).then(a).then(r)}var l={descending:t.descending};if("undefined"!=typeof t.startkey&&(l.startkey=I(t.descending?[t.startkey,{}]:[t.startkey])),"undefined"!=typeof t.endkey){var h=t.inclusive_end!==!1;t.descending&&(h=!h),l.endkey=I(h?[t.endkey,{}]:[t.endkey])}if("undefined"!=typeof t.key){var d=I([t.key]),p=I([t.key,{}]);l.descending?(l.endkey=d,l.startkey=p):(l.startkey=d,l.endkey=p)}return o||("number"==typeof t.limit&&(l.limit=t.limit),l.skip=s),n(l).then(r)}function x(e){return e.request({method:"POST",url:"_view_cleanup"})}function S(e){return e.get("_local/mrviews").then(function(t){var n={};Object.keys(t.views).forEach(function(e){var t=r(e),i="_design/"+t[0],o=t[1];n[i]=n[i]||{},n[i][o]=!0});var i={keys:Object.keys(n),include_docs:!0};return e.allDocs(i).then(function(r){var i={};r.rows.forEach(function(e){var r=e.key.substring(8);Object.keys(n[e.key]).forEach(function(n){var o=r+"/"+n;t.views[o]||(o=n);var s=Object.keys(t.views[o]),a=e.doc&&e.doc.views&&e.doc.views[n];s.forEach(function(e){i[e]=i[e]||a})})});var o=Object.keys(i).filter(function(e){return!i[e]}),s=o.map(function(t){return P.sequentialize(m(t),function(){return new e.constructor(t,e.__opts).destroy()})()});return q.all(s).then(function(){return{ok:!0}})})},v({ok:!0}))}function A(t,n,i){if("http"===t.type())return p(t,n,i);if("string"!=typeof n){d(i,n);var o={db:t,viewName:"temp_view/temp_view",map:n.map,reduce:n.reduce,temporary:!0};return F.add(function(){return B(o).then(function(e){function t(){return e.db.destroy()}return P.fin(b(e).then(function(){return E(e,i)}),t)})}),F.finish()}var s=n,a=r(s),c=a[0],u=a[1];return t.get("_design/"+c).then(function(n){var r=n.views&&n.views[u];if(!r||"string"!=typeof r.map)throw new O("ddoc "+c+" has no view named "+u);d(i,r);var o={db:t,viewName:s,map:r.map,reduce:r.reduce};return B(o).then(function(t){return"ok"===i.stale||"update_after"===i.stale?("update_after"===i.stale&&e.nextTick(function(){b(t)}),E(t,i)):b(t).then(function(){return E(t,i)})})})}function T(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,T)}catch(t){}}function O(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,O)}catch(t){}}function R(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,R)}catch(t){}}var C,j=n(59),D=n(82),L=j.collate,I=j.toIndexableString,N=j.normalizeKey,B=n(85),M=n(87);C="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var P=n(83),q=P.Promise,U={},F=new D,H=50,W={_sum:function(e,t){return l(t)},_count:function(e,t){return t.length},_stats:function(e,t){function n(e){for(var t=0,n=0,r=e.length;n<r;n++){var i=e[n];t+=i*i}return t}return{sum:l(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:n(t)}}};t.viewCleanup=P.callbackify(function(){var e=this;return"http"===e.type()?x(e):S(e)}),t.query=function(e,t,n){"function"==typeof t&&(n=t,t={}),t=P.extend(!0,{},t),"function"==typeof e&&(e={map:e});var r=this,i=q.resolve().then(function(){return A(r,e,t)});return P.promisedCallback(i,n),i},P.inherits(T,Error),P.inherits(O,Error),P.inherits(R,Error)}).call(t,n(1))},function(e,t,n){"use strict";function r(){this.promise=new i(function(e){e()})}var i=n(83).Promise;r.prototype.add=function(e){return this.promise=this.promise["catch"](function(){}).then(function(){return e()}),this.promise},r.prototype.finish=function(){return this.promise},e.exports=r},function(e,t,n){(function(e,r){"use strict";"function"==typeof e.Promise?t.Promise=e.Promise:t.Promise=n(23),t.inherits=n(16),t.extend=n(9);var i=n(18);t.promisedCallback=function(e,t){return t&&e.then(function(e){r.nextTick(function(){t(null,e)})},function(e){r.nextTick(function(){t(e)})}),e},t.callbackify=function(e){return i(function(n){var r=n.pop(),i=e.apply(this,n);return"function"==typeof r&&t.promisedCallback(i,r),i})},t.fin=function(e,t){return e.then(function(e){var n=t();return"function"==typeof n.then?n.then(function(){return e}):e},function(e){var n=t();if("function"==typeof n.then)return n.then(function(){throw e});throw e})},t.sequentialize=function(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}},t.flatten=function(e){for(var t=[],n=0,r=e.length;n<r;n++)t=t.concat(e[n]);return t},t.uniq=function(e){for(var t={},n=0,r=e.length;n<r;n++)t["$"+e[n]]=!0;var i=Object.keys(t),o=new Array(i.length);for(n=0,r=i.length;n<r;n++)o[n]=i[n].substring(1);return o};var o=n(84),s=n(46);t.MD5=function(e){return r.browser?s.hash(e):o.createHash("md5").update(e).digest("hex")}}).call(t,function(){return this}(),n(1))},function(e,t){},function(e,t,n){"use strict";var r=n(86),i=n(83),o=i.Promise;e.exports=function(e){var t=e.db,n=e.viewName,s=e.map,a=e.reduce,c=e.temporary,u=s.toString()+(a&&a.toString())+"undefined";if(!c&&t._cachedViews){var f=t._cachedViews[u];if(f)return o.resolve(f)}return t.info().then(function(e){function o(e){e.views=e.views||{};var t=n;t.indexOf("/")===-1&&(t=n+"/"+n);var r=e.views[t]=e.views[t]||{};if(!r[f])return r[f]=!0,e}var f=e.db_name+"-mrview-"+(c?"temp":i.MD5(u));return r(t,"_local/mrviews",o).then(function(){return t.registerDependentDatabase(f).then(function(e){var n=e.db;n.auto_compaction=!0;var r={name:f,db:n,sourceDB:t,adapter:t.adapter,mapFun:s,reduceFun:a};return r.db.get("_local/lastSeq")["catch"](function(e){if(404!==e.status)throw e}).then(function(e){return r.seq=e?e.seq:0,c||(t._cachedViews=t._cachedViews||{},t._cachedViews[u]=r,r.db.on("destroyed",function(){delete t._cachedViews[u]})),r})})})})}},function(e,t,n){"use strict";var r=n(51).upsert;e.exports=function(e,t,n){return r.apply(e,[t,n])}},function(module,exports){"use strict";module.exports=function(func,emit,sum,log,isArray,toJSON){return eval("'use strict'; ("+func.replace(/;\s*$/,"")+");")}},function(e,t,n){(function(t,r){"use strict";function i(){try{a=n(169)}catch(e){}}function o(e,t){return d.Promise.all(e.map(function(e){if(e.doc&&e.doc._attachments){var n=Object.keys(e.doc._attachments);return d.Promise.all(n.map(function(n){var r=e.doc._attachments[n];if(!("data"in r))return new d.Promise(function(i,o){t.binaryStore.get(r.digest,function(t,s){var a="";return t&&"NotFoundError"!==t.name?o(t):(t||(a=d.btoa(s)),e.doc._attachments[n]=d.extend(d.pick(r,["digest","content_type"]),{data:a}),void i())})})}))}}))}function s(e,n){function i(){z.docStore=H.sublevel(b,{valueEncoding:C}),z.bySeqStore=H.sublevel(_,{valueEncoding:"json"}),z.attachmentStore=H.sublevel(w,{valueEncoding:"json"}),z.binaryStore=H.sublevel(E,{valueEncoding:"binary"}),z.localStore=H.sublevel(k,{valueEncoding:"json"}),z.metaStore=H.sublevel(x,{valueEncoding:"json"}),p.localAndMetaStores(H,z,function(){z.metaStore.get(A,function(e,r){"undefined"==typeof H._updateSeq&&(H._updateSeq=r||0),z.metaStore.get(T,function(e,r){H._docCount=e?0:r,z.metaStore.get(O,function(e,r){F=e?d.uuid():r,z.metaStore.put(O,F,function(e,r){t.nextTick(function(){n(null,W)})})})})})})}function j(e){return H.isClosed()?e(new Error("database is closed")):e(null,H._docCount)}function D(e,t){try{e.apply(null,t)}catch(n){t[t.length-1](n)}}function L(){var e=H._queue.peekFront();"read"===e.type?I(e):N(e)}function I(e){for(var n=[e],r=1,i=H._queue.get(r);"undefined"!=typeof i&&"read"===i.type;)n.push(i),r++,i=H._queue.get(r);var o=0;n.forEach(function(e){var r=e.args,i=r[r.length-1];r[r.length-1]=d.getArguments(function(e){i.apply(null,e),++o===n.length&&t.nextTick(function(){n.forEach(function(){H._queue.shift()}),H._queue.length&&L()})}),D(e.fun,r)})}function N(e){var n=e.args,r=n[n.length-1];n[n.length-1]=d.getArguments(function(e){r.apply(null,e),t.nextTick(function(){H._queue.shift(),H._queue.length&&L()})}),D(e.fun,n)}function B(e){return d.getArguments(function(n){H._queue.push({fun:e,args:n,type:"write"}),1===H._queue.length&&t.nextTick(L)})}function M(e){return d.getArguments(function(n){H._queue.push({fun:e,args:n,type:"read"}),1===H._queue.length&&t.nextTick(L)})}function P(e){return("0000000000000000"+e).slice(-16)}function q(e){return parseInt(e,10)}function U(e,n){"function"==typeof V.destroy?V.destroy(e,n):t.nextTick(n)}e=d.clone(e);var F,H,W=this,z={},J=e.name;"undefined"==typeof e.createIfMissing&&(e.createIfMissing=!0);var V=e.db||a;if(!V)return n(new Error("leveldown not available (specify another backend using the 'db' option)"));"function"!=typeof V.destroy&&(V.destroy=function(e,t){t()});var K;S.has(V.name)?K=S.get(V.name):(K=new d.Map,S.set(V.name,K)),K.has(J)?(H=K.get(J),i()):K.set(J,u(c(J,e,function(t){return t?(K["delete"](J),n(t)):(H=K.get(J),H._docCount=-1,H._queue=new v,void(e.db||e.noMigrate?i():p.toSublevel(J,H,i)))}))),W.type=function(){return"leveldb"},W._id=function(e){e(null,F)},W._info=function(e){var n={doc_count:H._docCount,update_seq:H._updateSeq};return t.nextTick(function(){e(null,n)})},W._get=M(function(e,t,n){t=d.clone(t),z.docStore.get(e,function(e,r){if(e||!r)return n(l.error(l.MISSING_DOC,"missing"));if(d.isDeleted(r)&&!t.rev)return n(l.error(l.MISSING_DOC,"deleted"));var i=h.winningRev(r);i=t.rev?t.rev:i;var o=r.rev_map[i];z.bySeqStore.get(P(o),function(e,t){if(!t)return n(l.error(l.MISSING_DOC));if("_id"in t&&t._id!==r.id)return n(new Error("wrong doc returned"));if(t._id=r.id,"_rev"in t){if(t._rev!==i)return n(new Error("wrong doc returned"))}else t._rev=i;return n(null,{doc:t,metadata:r})})})}),W._getAttachment=function(e,n,i){var o=e.digest;z.binaryStore.get(o,function(o,s){var a;return o&&"NotFoundError"===o.name?(a=n.encode?"":t.browser?d.createBlob([""],{type:e.content_type}):new r(""),i(null,a)):o?i(o):(a=t.browser?n.encode?d.btoa(s):y(s,e.content_type):n.encode?d.btoa(s):s,void i(null,a))})},W._bulkDocs=B(function(e,n,i){function o(e,t){E.get(z.attachmentStore,e,function(n){if(n){var r=l.error(l.MISSING_STUB,"unknown stub attachment with digest "+e);t(r)}else t()})}function a(e){var t=[];if(S.forEach(function(e){e&&e._attachments&&Object.keys(e._attachments).forEach(function(n){var r=e._attachments[n];r.stub&&t.push(r.digest)})}),!t.length)return e();var n,r=0;t.forEach(function(i){o(i,function(i){i&&!n&&(n=i),++r===t.length&&e(n)})})}function c(e){function t(){if(++r===S.length)return e(n)}var n,r=0;S.forEach(function(e){return e._id&&d.isLocalId(e._id)?t():void E.get(z.docStore,e._id,function(r,i){r?"NotFoundError"!==r.name&&(n=r):w.set(e._id,i),t()})})}function u(e){var t=d.Promise.resolve();w.forEach(function(e,n){t=t.then(function(){return new d.Promise(function(t,r){var i=d.compactTree(e);W._doCompactionNoLock(n,i,{ctx:E},function(e){return e?r(e):void t()})})})}),t.then(function(){e()},e)}function f(){return W.auto_compaction?u(y):y()}function h(e,n,r,o,s,a,c,u){function f(e){S++,b||(e?(b=e,u(b)):S===A.length&&m())}function h(e,t,n,r){return function(i){v(e,R+i,t,n,r)}}function y(e,t,n){return function(r){d.MD5(r).then(h(e,t,r,n))}}function m(){var t=e.metadata.rev_map[e.metadata.rev];if(t)return u();t=++x,e.metadata.rev_map[e.metadata.rev]=e.metadata.seq=t;var r=P(t),i=[{key:r,value:e.data,prefix:z.bySeqStore,type:"put",valueEncoding:"json"},{key:e.metadata.id,value:e.metadata,prefix:z.docStore,type:"put",valueEncoding:C}];E.batch(i),_[c]={ok:!0,id:e.metadata.id,rev:n},w.set(e.metadata.id,e.metadata),u()}k+=a;var b=null,S=0;e.data._id=e.metadata.id,e.data._rev=e.metadata.rev,o&&(e.data._deleted=!0);for(var A=e.data._attachments?Object.keys(e.data._attachments):[],T=0;T<A.length;T++){var O=A[T],j=e.data._attachments[O];if(j.stub){var D=e.data._id,L=e.data._rev;p(D,L,j.digest,f)}else{var I;if("string"==typeof j.data)try{I=d.atob(j.data)}catch(N){return void i(l.error(l.BAD_ARG,"Attachments need to be base64 encoded"))}else{if(t.browser){g(j.data,y(e,O,f));continue}I=j.data}d.MD5(I).then(h(e,O,I,f))}}A.length||m()}function p(e,t,n,r){function i(){return new d.Promise(function(e,t){E.get(z.attachmentStore,n,function(n,r){return n&&"NotFoundError"!==n.name?t(n):void e(r)})})}function o(r){var i=[e,t].join("@"),o={};return r?r.refs&&(o.refs=r.refs,o.refs[i]=!0):(o.refs={},o.refs[i]=!0),new d.Promise(function(e,t){E.batch([{type:"put",prefix:z.attachmentStore,key:n,value:o,valueEncoding:"json"}]),e(!r)})}var s=D[n]||d.Promise.resolve();D[n]=s.then(function(){return i().then(o).then(function(e){r(null,e)},r)})}function v(e,t,n,i,o){var s=e.data._attachments[n];delete s.data,s.digest=t,s.length=i.length;var a=e.metadata.id,c=e.metadata.rev;p(a,c,t,function(e,n){return e?o(e):0===i.length?o(e):n?(E.batch([{type:"put",prefix:z.binaryStore,key:t,value:new r(i,"binary"),encoding:"binary"}]),void o()):o(e)})}function y(e){return e?t.nextTick(function(){i(e)}):(E.batch([{prefix:z.metaStore,type:"put",key:A,value:x,encoding:"json"},{prefix:z.metaStore,type:"put",key:T,value:H._docCount+k,encoding:"json"}]),void E.execute(H,function(e){return e?i(e):(H._docCount+=k,H._updateSeq=x,s.Changes.notify(J),void t.nextTick(function(){i(null,_)}))}))}var b=n.new_edits,_=new Array(e.docs.length),w=new d.Map,E=new m,k=0,x=H._updateSeq,S=e.docs,O=S.map(function(e,t){if(e._id&&d.isLocalId(e._id))return e;var n=d.parseDoc(e,b);return n.metadata&&!n.metadata.rev_map&&(n.metadata.rev_map={}),n}),j=O.filter(function(e){return e.error});if(j.length)return i(j[0]);var D={};return O.length?void a(function(e){return e?i(e):void c(function(e){return e?i(e):void d.processDocs(O,W,w,E,_,h,n,f)})}):i(null,[])}),W._allDocs=M(function(e,t){e=d.clone(e),j(function(n,r){if(n)return t(n);var i={},s=e.skip||0;if(e.startkey&&(i.start=e.startkey),e.endkey&&(i.end=e.endkey),e.key&&(i.start=i.end=e.key),e.descending){i.reverse=!0;var a=i.start;i.start=i.end,i.end=a}var c;if("number"==typeof e.limit&&(c=e.limit),0===c||"start"in i&&"end"in i&&i.start>i.end)return t(null,{total_rows:r,offset:e.skip,rows:[]});var u=[],l=z.docStore.readStream(i),p=f(function(t,n,r){function i(t,n){var i={id:t.id,key:t.id,value:{rev:h.winningRev(t)}};if(e.include_docs){i.doc=n,i.doc._rev=i.value.rev,e.conflicts&&(i.doc._conflicts=h.collectConflicts(t));for(var o in i.doc._attachments)i.doc._attachments.hasOwnProperty(o)&&(i.doc._attachments[o].stub=!0)}if(e.inclusive_end===!1&&t.id===e.endkey)return r();if(d.isDeleted(t)){if("ok"!==e.deleted)return r();i.value.deleted=!0,i.doc=null}u.push(i),r()}if(d.isDeleted(t.value)){if("ok"!==e.deleted)return void r()}else{if(s-- >0)return void r();if("number"==typeof c&&c--<=0)return l.unpipe(),l.destroy(),void r()}var o=t.value;if(e.include_docs){var a=o.rev_map[h.winningRev(o)];z.bySeqStore.get(P(a),function(e,t){i(o,t)})}else i(o)},function(n){d.Promise.resolve().then(function(){return e.attachments&&o(u,z)}).then(function(){t(null,{total_rows:r,offset:e.skip,rows:u})},t),n()}).on("unpipe",function(){p.end()});l.on("error",t),l.pipe(p)})}),W._changes=function(e){function t(){e.done=!0,p&&e.limit&&e.limit<a.length&&(a.length=e.limit),m.unpipe(b),m.destroy(),e.continuous||e.cancelled||d.Promise.resolve().then(function(){if(e.include_docs&&e.attachments)return o(a,z)}).then(function(){e.complete(null,{results:a,last_seq:c})})}if(e=d.clone(e),e.continuous){var n=J+":"+d.uuid();return s.Changes.addListener(J,n,W,e),s.Changes.notify(J),{cancel:function(){s.Changes.removeListener(J,n)}}}var r,i=e.descending,a=[],c=e.since||0,u=0,l={reverse:i};"limit"in e&&e.limit>0&&(r=e.limit),l.reverse||(l.start=P(e.since||0));var p,v=e.doc_ids&&new d.Set(e.doc_ids),g=d.filterChange(e),y=new d.Map;p=!("returnDocs"in e)||e.returnDocs;var m=z.bySeqStore.readStream(l),b=f(function(n,s,f){function l(t){function n(n){var r=e.processChange(n,t,e);r.seq=t.seq,g(r)&&(u++,e.attachments&&e.include_docs?o([r],z).then(function(){e.onChange(r)}):e.onChange(r),p&&a.push(r)),f()}var r=h.winningRev(t);if(t.seq!==m)return f();if(c=m,r===b._rev)return n(b);var i=t.rev_map[r];z.bySeqStore.get(P(i),function(e,t){n(t)})}if(r&&u>=r)return t(),f();if(e.cancelled||e.done)return f();var m=q(n.key),b=n.value;if(m===e.since&&!i)return f();if(v&&!v.has(b._id))return f();var _;return(_=y.get(b._id))?l(_):void z.docStore.get(b._id,function(t,n){return e.cancelled||e.done||H.isClosed()||d.isLocalId(n.id)?f():(y.set(b._id,n),void l(n))})},function(t){return e.cancelled?t():(p&&e.limit&&e.limit<a.length&&(a.length=e.limit),void t())}).on("unpipe",function(){b.end(),t()});return m.pipe(b),{cancel:function(){e.cancelled=!0,t()}}},W._close=function(e){return H.isClosed()?e(l.error(l.NOT_OPEN)):void H.close(function(t){t?e(t):(K["delete"](J),e())})},W._getRevisionTree=function(e,t){z.docStore.get(e,function(e,n){e?t(l.error(l.MISSING_DOC)):t(null,n.rev_tree)})},W._doCompaction=B(function(e,t,n,r){W._doCompactionNoLock(e,t,n,r)}),W._doCompactionNoLock=function(e,t,n,r){if("function"==typeof n&&(r=n,n={}),!t.length)return r();var i=n.ctx||new m;i.get(z.docStore,e,function(o,s){function a(e){if(e&&(p=e),++g===t.length){if(p)return r(p);u()}}function c(e){return e?r(e):(i.batch(l),n.ctx?r():void i.execute(H,r))}function u(){function n(e){e&&(o=e),++s===r.length&&c(o)}var r=Object.keys(v);if(!r.length)return c();var o,s=0,a=new d.Map;t.forEach(function(t){a.set(e+"@"+t,!0)}),r.forEach(function(e){i.get(z.attachmentStore,e,function(t,r){if(t)return"NotFoundError"===t.name?n():n(t);var i=Object.keys(r.refs||{}).filter(function(e){return!a.has(e)}),o={};i.forEach(function(e){o[e]=!0}),i.length?l.push({key:e,type:"put",valueEncoding:"json",value:{refs:o},prefix:z.attachmentStore}):l=l.concat([{key:e,type:"del",prefix:z.attachmentStore},{key:e,type:"del",prefix:z.binaryStore}]),n()})})}if(o)return r(o);var f=s.rev_map;h.traverseRevTree(s.rev_tree,function(e,n,r,i,o){var s=n+"-"+r;t.indexOf(s)!==-1&&(o.status="missing")});var l=[];l.push({key:s.id,value:s,type:"put",valueEncoding:C,prefix:z.docStore});var p,v={},g=0;t.forEach(function(e){var t=f[e];l.push({key:P(t),type:"del",prefix:z.bySeqStore}),i.get(z.bySeqStore,P(t),function(e,t){if(e)return"NotFoundError"===e.name?a():a(e);var n=Object.keys(t._attachments||{});n.forEach(function(e){var n=t._attachments[e].digest;v[n]=!0}),a()})})})},W._getLocal=function(e,t){z.localStore.get(e,function(e,n){e?t(l.error(l.MISSING_DOC)):t(null,n)})},W._putLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),t.ctx?W._putLocalNoLock(e,t,n):W._putLocalWithLock(e,t,n)},W._putLocalWithLock=B(function(e,t,n){W._putLocalNoLock(e,t,n)}),W._putLocalNoLock=function(e,t,n){delete e._revisions;var r=e._rev,i=e._id,o=t.ctx||new m;o.get(z.localStore,i,function(s,a){if(s&&r)return n(l.error(l.REV_CONFLICT));if(a&&a._rev!==r)return n(l.error(l.REV_CONFLICT));e._rev=r?"0-"+(parseInt(r.split("-")[1],10)+1):"0-1";var c=[{type:"put",prefix:z.localStore,key:i,value:e,valueEncoding:"json"}];o.batch(c);var u={ok:!0,id:e._id,rev:e._rev};return t.ctx?n(null,u):void o.execute(H,function(e){return e?n(e):void n(null,u)})})},W._removeLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),t.ctx?W._removeLocalNoLock(e,t,n):W._removeLocalWithLock(e,t,n)},W._removeLocalWithLock=B(function(e,t,n){W._removeLocalNoLock(e,t,n)}),W._removeLocalNoLock=function(e,t,n){var r=t.ctx||new m;r.get(z.localStore,e._id,function(i,o){if(i)return n(i);if(o._rev!==e._rev)return n(l.error(l.REV_CONFLICT));r.batch([{prefix:z.localStore,type:"del",key:e._id}]);var s={ok:!0,id:e._id,rev:"0-0"};return t.ctx?n(null,s):void r.execute(H,function(e){return e?n(e):void n(null,s)})})},W._destroy=function(e){var t;return S.has(V.name)?(t=S.get(V.name),void(t.has(J)?(s.Changes.removeAllListeners(J),t.get(J).close(function(){t["delete"](J),U(J,e)})):U(J,e))):U(J,e)}}var a,c=n(93),u=n(141),f=n(154).obj;i();var l=n(15),h=n(8),d=n(7),p=n(170),v=n(171),g=n(68),y=n(38),m=n(172),b="document-store",_="by-sequence",w="attach-store",E="attach-binary-store",k="local-store",x="meta-store",S=new d.Map,A="_local_last_update_seq",T="_local_doc_count",O="_local_uuid",R="md5-",C={encode:d.safeJsonStringify,decode:d.safeJsonParse,buffer:!1,type:"cheap-json"};s.valid=function(){return t&&!t.browser},s.use_prefix=!1,s.Changes=new d.Changes,e.exports=s}).call(t,n(1),n(89).Buffer)},function(e,t,n){(function(e,r){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function i(){function e(){}try{var t=new Uint8Array(1);return t.foo=function(){return 42},t.constructor=e,42===t.foo()&&t.constructor===e&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(n){return!1}}function o(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function e(t){return this instanceof e?(e.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof t?s(this,t):"string"==typeof t?a(this,t,arguments.length>1?arguments[1]:"utf8"):c(this,t)):arguments.length>1?new e(t,arguments[1]):new e(t)}function s(t,n){if(t=v(t,n<0?0:0|g(n)),!e.TYPED_ARRAY_SUPPORT)for(var r=0;r<n;r++)t[r]=0;return t}function a(e,t,n){"string"==typeof n&&""!==n||(n="utf8");var r=0|m(t,n);return e=v(e,r),e.write(t,n),e}function c(t,n){if(e.isBuffer(n))return u(t,n);if(X(n))return f(t,n);if(null==n)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(n.buffer instanceof ArrayBuffer)return l(t,n);if(n instanceof ArrayBuffer)return h(t,n)}return n.length?d(t,n):p(t,n)}function u(e,t){var n=0|g(t.length);return e=v(e,n),t.copy(e,0,0,n),e}function f(e,t){var n=0|g(t.length);e=v(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function l(e,t){var n=0|g(t.length);e=v(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(t,n){return e.TYPED_ARRAY_SUPPORT?(n.byteLength,t=e._augment(new Uint8Array(n))):t=l(t,new Uint8Array(n)),t}function d(e,t){var n=0|g(t.length);e=v(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e,t){var n,r=0;"Buffer"===t.type&&X(t.data)&&(n=t.data,r=0|g(n.length)),e=v(e,r);for(var i=0;i<r;i+=1)e[i]=255&n[i];return e}function v(t,n){e.TYPED_ARRAY_SUPPORT?(t=e._augment(new Uint8Array(n)),t.__proto__=e.prototype):(t.length=n,t._isBuffer=!0);var r=0!==n&&n<=e.poolSize>>>1;return r&&(t.parent=Q),t}function g(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function y(t,n){if(!(this instanceof y))return new y(t,n);var r=new e(t,n);return delete r.parent,r}function m(e,t){"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(r)return W(e).length;t=(""+t).toLowerCase(),r=!0}}function b(e,t,n){var r=!1;if(t=0|t,n=void 0===n||n===1/0?this.length:0|n,e||(e="utf8"),t<0&&(t=0),n>this.length&&(n=this.length),n<=t)return"";for(;;)switch(e){case"hex":return j(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return R(this,t,n);case"binary":return C(this,t,n);case"base64":return A(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function _(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=t.length;if(o%2!==0)throw new Error("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;s++){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");e[n+s]=a}return s}function w(e,t,n,r){return K(W(t,e.length-n),e,n,r)}function E(e,t,n,r){return K(z(t),e,n,r)}function k(e,t,n,r){return E(e,t,n,r)}function x(e,t,n,r){return K(V(t),e,n,r)}function S(e,t,n,r){return K(J(t,e.length-n),e,n,r)}function A(e,t,n){return 0===t&&n===e.length?Y.fromByteArray(e):Y.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o=e[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=n){var c,u,f,l;switch(a){case 1:o<128&&(s=o);break;case 2:c=e[i+1],128===(192&c)&&(l=(31&o)<<6|63&c,l>127&&(s=l));break;case 3:c=e[i+1],u=e[i+2],128===(192&c)&&128===(192&u)&&(l=(15&o)<<12|(63&c)<<6|63&u,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:c=e[i+1],u=e[i+2],f=e[i+3],128===(192&c)&&128===(192&u)&&128===(192&f)&&(l=(15&o)<<18|(63&c)<<12|(63&u)<<6|63&f,l>65535&&l<1114112&&(s=l))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),i+=a}return O(r)}function O(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=$));return n}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;i++)r+=String.fromCharCode(127&e[i]);return r}function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;i++)r+=String.fromCharCode(e[i]);return r}function j(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;o++)i+=H(e[o]);return i}function D(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function L(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function I(t,n,r,i,o,s){if(!e.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(n>o||n<s)throw new RangeError("value is out of bounds");if(r+i>t.length)throw new RangeError("index out of range")}function N(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;i++)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function B(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;i++)e[n+i]=t>>>8*(r?i:3-i)&255}function M(e,t,n,r,i,o){if(t>i||t<o)throw new RangeError("value is out of bounds");if(n+r>e.length)throw new RangeError("index out of range");if(n<0)throw new RangeError("index out of range")}function P(e,t,n,r,i){return i||M(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),G.write(e,t,n,r,23,4),n+4}function q(e,t,n,r,i){return i||M(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),G.write(e,t,n,r,52,8),n+8}function U(e){if(e=F(e).replace(ee,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function F(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function W(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],s=0;s<r;s++){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=(i-55296<<10|n-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function J(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);s++)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function V(e){return Y.toByteArray(U(e))}function K(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);i++)t[i+n]=e[i];return i}var Y=n(90),G=n(91),X=n(92);t.Buffer=e,t.SlowBuffer=y,t.INSPECT_MAX_BYTES=50,e.poolSize=8192;var Q={};e.TYPED_ARRAY_SUPPORT=void 0!==r.TYPED_ARRAY_SUPPORT?r.TYPED_ARRAY_SUPPORT:i(),e.TYPED_ARRAY_SUPPORT?(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array):(e.prototype.length=void 0,e.prototype.parent=void 0),e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,n){if(!e.isBuffer(t)||!e.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var r=t.length,i=n.length,o=0,s=Math.min(r,i);o<s&&t[o]===n[o];)++o;return o!==s&&(r=t[o],i=n[o]),r<i?-1:i<r?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,n){if(!X(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new e(0);var r;if(void 0===n)for(n=0,r=0;r<t.length;r++)n+=t[r].length;var i=new e(n),o=0;for(r=0;r<t.length;r++){var s=t[r];s.copy(i,o),o+=s.length}return i},e.byteLength=m,e.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):b.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:e.compare(this,t)},e.prototype.indexOf=function(t,n){function r(e,t,n){for(var r=-1,i=0;n+i<e.length;i++)if(e[n+i]===t[r===-1?0:i-r]){if(r===-1&&(r=i),i-r+1===t.length)return n+r}else r=-1;return-1}if(n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n>>=0,0===this.length)return-1;if(n>=this.length)return-1;if(n<0&&(n=Math.max(this.length+n,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,n);if(e.isBuffer(t))return r(this,t,n);if("number"==typeof t)return e.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,n):r(this,[t],n);throw new TypeError("val must be string, number or Buffer")},e.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},e.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},e.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t=0|t,isFinite(n)?(n=0|n,void 0===r&&(r="utf8")):(r=n,n=void 0);else{var i=r;r=t,t=0|n,n=i}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return E(this,e,t,n);case"binary":return k(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;e.prototype.slice=function(t,n){var r=this.length;t=~~t,n=void 0===n?r:~~n,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),n<0?(n+=r,n<0&&(n=0)):n>r&&(n=r),n<t&&(n=t);var i;if(e.TYPED_ARRAY_SUPPORT)i=e._augment(this.subarray(t,n));else{var o=n-t;i=new e(o,(void 0));for(var s=0;s<o;s++)i[s]=this[s+t]}return i.length&&(i.parent=this.parent||this),i},e.prototype.readUIntLE=function(e,t,n){e=0|e,t=0|t,n||L(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},e.prototype.readUIntBE=function(e,t,n){e=0|e,t=0|t,n||L(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},e.prototype.readUInt8=function(e,t){return t||L(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||L(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||L(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,n){e=0|e,t=0|t,n||L(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},e.prototype.readIntBE=function(e,t,n){e=0|e,t=0|t,n||L(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},e.prototype.readInt8=function(e,t){return t||L(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},e.prototype.readInt16LE=function(e,t){t||L(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt16BE=function(e,t){t||L(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt32LE=function(e,t){return t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||L(e,4,this.length),G.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||L(e,4,this.length),G.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||L(e,8,this.length),G.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||L(e,8,this.length),G.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,n,r){e=+e,t=0|t,n=0|n,r||I(this,e,t,n,Math.pow(2,8*n),0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},e.prototype.writeUIntBE=function(e,t,n,r){e=+e,t=0|t,n=0|n,r||I(this,e,t,n,Math.pow(2,8*n),0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},e.prototype.writeUInt8=function(t,n,r){return t=+t,n=0|n,r||I(this,t,n,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},e.prototype.writeUInt16LE=function(t,n,r){return t=+t,n=0|n,r||I(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):N(this,t,n,!0),n+2},e.prototype.writeUInt16BE=function(t,n,r){return t=+t,n=0|n,r||I(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):N(this,t,n,!1),n+2},e.prototype.writeUInt32LE=function(t,n,r){return t=+t,n=0|n,r||I(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):B(this,t,n,!0),n+4},e.prototype.writeUInt32BE=function(t,n,r){return t=+t,n=0|n,r||I(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):B(this,t,n,!1),n+4},e.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t=0|t,!r){var i=Math.pow(2,8*n-1);I(this,e,t,n,i-1,-i)}var o=0,s=1,a=e<0?1:0;for(this[t]=255&e;++o<n&&(s*=256);)this[t+o]=(e/s>>0)-a&255;return t+n},e.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t=0|t,!r){var i=Math.pow(2,8*n-1);I(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=e<0?1:0;for(this[t+o]=255&e;--o>=0&&(s*=256);)this[t+o]=(e/s>>0)-a&255;return t+n},e.prototype.writeInt8=function(t,n,r){return t=+t,n=0|n,r||I(this,t,n,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},e.prototype.writeInt16LE=function(t,n,r){return t=+t,n=0|n,r||I(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):N(this,t,n,!0),n+2},e.prototype.writeInt16BE=function(t,n,r){return t=+t,n=0|n,r||I(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):N(this,t,n,!1),n+2},e.prototype.writeInt32LE=function(t,n,r){return t=+t,n=0|n,r||I(this,t,n,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):B(this,t,n,!0),n+4},e.prototype.writeInt32BE=function(t,n,r){return t=+t,n=0|n,r||I(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):B(this,t,n,!1),n+4},e.prototype.writeFloatLE=function(e,t,n){return P(this,e,t,!0,n)},e.prototype.writeFloatBE=function(e,t,n){return P(this,e,t,!1,n)},e.prototype.writeDoubleLE=function(e,t,n){return q(this,e,t,!0,n)},e.prototype.writeDoubleBE=function(e,t,n){return q(this,e,t,!1,n)},e.prototype.copy=function(t,n,r,i){if(r||(r=0),i||0===i||(i=this.length),n>=t.length&&(n=t.length),n||(n=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-n<i-r&&(i=t.length-n+r);var o,s=i-r;if(this===t&&r<n&&n<i)for(o=s-1;o>=0;o--)t[o+n]=this[o+r];else if(s<1e3||!e.TYPED_ARRAY_SUPPORT)for(o=0;o<s;o++)t[o+n]=this[o+r];else t._set(this.subarray(r,r+s),n);return s},e.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),n<t)throw new RangeError("end < start");if(n!==t&&0!==this.length){if(t<0||t>=this.length)throw new RangeError("start out of bounds");if(n<0||n>this.length)throw new RangeError("end out of bounds");var r;if("number"==typeof e)for(r=t;r<n;r++)this[r]=e;else{var i=W(e.toString()),o=i.length;for(r=t;r<n;r++)this[r]=i[r%o]}return this}},e.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(e.TYPED_ARRAY_SUPPORT)return new e(this).buffer;for(var t=new Uint8Array(this.length),n=0,r=t.length;n<r;n+=1)t[n]=this[n];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var Z=e.prototype;e._augment=function(t){return t.constructor=e,t._isBuffer=!0,t._set=t.set,t.get=Z.get,t.set=Z.set,t.write=Z.write,t.toString=Z.toString,t.toLocaleString=Z.toString,t.toJSON=Z.toJSON,t.equals=Z.equals,t.compare=Z.compare,t.indexOf=Z.indexOf,t.copy=Z.copy,t.slice=Z.slice,t.readUIntLE=Z.readUIntLE,t.readUIntBE=Z.readUIntBE,t.readUInt8=Z.readUInt8,t.readUInt16LE=Z.readUInt16LE,t.readUInt16BE=Z.readUInt16BE,t.readUInt32LE=Z.readUInt32LE,t.readUInt32BE=Z.readUInt32BE,t.readIntLE=Z.readIntLE,t.readIntBE=Z.readIntBE,t.readInt8=Z.readInt8,t.readInt16LE=Z.readInt16LE,t.readInt16BE=Z.readInt16BE,t.readInt32LE=Z.readInt32LE,t.readInt32BE=Z.readInt32BE,t.readFloatLE=Z.readFloatLE,t.readFloatBE=Z.readFloatBE,t.readDoubleLE=Z.readDoubleLE,t.readDoubleBE=Z.readDoubleBE,t.writeUInt8=Z.writeUInt8,t.writeUIntLE=Z.writeUIntLE,t.writeUIntBE=Z.writeUIntBE,t.writeUInt16LE=Z.writeUInt16LE,t.writeUInt16BE=Z.writeUInt16BE,t.writeUInt32LE=Z.writeUInt32LE,t.writeUInt32BE=Z.writeUInt32BE,t.writeIntLE=Z.writeIntLE,t.writeIntBE=Z.writeIntBE,t.writeInt8=Z.writeInt8,t.writeInt16LE=Z.writeInt16LE,t.writeInt16BE=Z.writeInt16BE,t.writeInt32LE=Z.writeInt32LE,t.writeInt32BE=Z.writeInt32BE,t.writeFloatLE=Z.writeFloatLE,t.writeFloatBE=Z.writeFloatBE,t.writeDoubleLE=Z.writeDoubleLE,t.writeDoubleBE=Z.writeDoubleBE,t.fill=Z.fill,t.inspect=Z.inspect,t.toArrayBuffer=Z.toArrayBuffer,t};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,n(89).Buffer,function(){return this}())},function(e,t,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===s||t===l?62:t===a||t===h?63:t<c?-1:t<c+10?t-c+26+26:t<f+26?t-f:t<u+26?t-u+26:void 0}function n(e){function n(e){u[l++]=e}var r,i,s,a,c,u;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var f=e.length;c="="===e.charAt(f-2)?2:"="===e.charAt(f-1)?1:0,u=new o(3*e.length/4-c),s=c>0?e.length-4:e.length;var l=0;for(r=0,i=0;r<s;r+=4,i+=3)a=t(e.charAt(r))<<18|t(e.charAt(r+1))<<12|t(e.charAt(r+2))<<6|t(e.charAt(r+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===c?(a=t(e.charAt(r))<<2|t(e.charAt(r+1))>>4,n(255&a)):1===c&&(a=t(e.charAt(r))<<10|t(e.charAt(r+1))<<4|t(e.charAt(r+2))>>2,n(a>>8&255),n(255&a)),u}function i(e){function t(e){return r.charAt(e)}function n(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var i,o,s,a=e.length%3,c="";for(i=0,s=e.length-a;i<s;i+=3)o=(e[i]<<16)+(e[i+1]<<8)+e[i+2],c+=n(o);switch(a){case 1:o=e[e.length-1],c+=t(o>>2),c+=t(o<<4&63),c+="==";break;case 2:o=(e[e.length-2]<<8)+e[e.length-1],c+=t(o>>10),c+=t(o>>4&63),c+=t(o<<2&63),c+="="}return c}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),c="0".charCodeAt(0),u="a".charCodeAt(0),f="A".charCodeAt(0),l="-".charCodeAt(0),h="_".charCodeAt(0);e.toByteArray=n,e.fromByteArray=i}(t)},function(e,t){t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,f=-7,l=n?i-1:0,h=n?-1:1,d=e[t+l];for(l+=h,o=d&(1<<-f)-1,d>>=-f,f+=a;f>0;o=256*o+e[t+l],l+=h,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=256*s+e[t+l],l+=h,f-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:(d?-1:1)*(1/0);s+=Math.pow(2,r),o-=u}return(d?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,f=(1<<u)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),t+=s+l>=1?h/c:h*Math.pow(2,1-l),t*c>=2&&(s++,c/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(t*c-1)*Math.pow(2,i),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+d]=255&s,d+=p,s/=256,u-=8);e[n+d-p]|=128*v}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(t){function r(e,t){return"function"==typeof e?e:t}function i(e,n,r){if(!(this instanceof i))return new i(e,n,r);var o;if(s.call(this),this.setMaxListeners(1/0),"function"==typeof e?(n="object"==typeof n?n:{},n.db=e,e=null):"object"==typeof e&&"function"==typeof e.db&&(n=e,e=null),"function"==typeof n&&(r=n,n={}),(!n||"function"!=typeof n.db)&&"string"!=typeof e){if(o=new g("Must provide a location for the database"),r)return t.nextTick(function(){r(o)});throw o}n=w(this,n),this.options=c(E,n),this._status="new",u(this,"location",e,"e"),this.open(r)}function o(e){return function(t,n){k()[e](t,n||function(){})}}var s=n(19).EventEmitter,a=n(94).inherits,c=n(97),u=n(98),f=n(99),l=n(103).WriteError,h=n(103).ReadError,d=n(103).NotFoundError,p=n(103).OpenError,v=n(103).EncodingError,g=n(103).InitializationError,y=n(106),m=n(138),b=n(133),_=n(140),w=b.getOptions,E=b.defaultOptions,k=b.getLevelDOWN,x=b.dispatchError;a(i,s),i.prototype.open=function(e){var n,r,i=this;return this.isOpen()?(e&&t.nextTick(function(){e(null,i)}),this):this._isOpening()?e&&this.once("open",function(){e(null,i)}):(this.emit("opening"),this._status="opening",this.db=new f(this.location),n=this.options.db||k(),r=n(this.location),void r.open(this.options,function(t){return t?x(i,new p(t),e):(i.db.setDb(r),i.db=r,i._status="open",e&&e(null,i),i.emit("open"),i.emit("ready"),void 0)}))},i.prototype.close=function(e){var n=this;if(this.isOpen())this._status="closing",this.db.close(function(){n._status="closed",n.emit("closed"),e&&e.apply(null,arguments)}),this.emit("closing"),this.db=null;else{if("closed"==this._status&&e)return t.nextTick(e);"closing"==this._status&&e?this.once("closed",e):this._isOpening()&&this.once("open",function(){n.close(e)})}},i.prototype.isOpen=function(){return"open"==this._status},i.prototype._isOpening=function(){return"opening"==this._status},i.prototype.isClosed=function(){return/^clos/.test(this._status)},i.prototype.get=function(e,t,n){var i,o=this;return n=r(t,n),"function"!=typeof n?x(this,new h("get() requires key and callback arguments")):this._isOpening()||this.isOpen()?(t=b.getOptions(this,t),i=b.encodeKey(e,t),t.asBuffer=b.isValueAsBuffer(t),void this.db.get(i,t,function(r,i){if(r)return r=/notfound/i.test(r)?new d("Key not found in database ["+e+"]",r):new h(r),x(o,r,n);if(n){try{i=b.decodeValue(i,t)}catch(s){return n(new v(s))}n(null,i)}})):x(this,new h("Database is not open"),n)},i.prototype.put=function(e,t,n,i){var o,s,a=this;return i=r(n,i),null===e||void 0===e||null===t||void 0===t?x(this,new l("put() requires key and value arguments"),i):this._isOpening()||this.isOpen()?(n=w(this,n),o=b.encodeKey(e,n),s=b.encodeValue(t,n),void this.db.put(o,s,n,function(n){return n?x(a,new l(n),i):(a.emit("put",e,t),void(i&&i()))})):x(this,new l("Database is not open"),i)},i.prototype.del=function(e,t,n){var i,o=this;return n=r(t,n),null===e||void 0===e?x(this,new l("del() requires a key argument"),n):this._isOpening()||this.isOpen()?(t=w(this,t),i=b.encodeKey(e,t),void this.db.del(i,t,function(t){return t?x(o,new l(t),n):(o.emit("del",e),void(n&&n()))})):x(this,new l("Database is not open"),n)},i.prototype.batch=function(e,t,n){var i,o,s,a=this;return arguments.length?(n=r(t,n),Array.isArray(e)?this._isOpening()||this.isOpen()?(t=w(this,t),i=t.keyEncoding,o=t.valueEncoding,s=e.map(function(e){if(void 0===e.type||void 0===e.key)return{};var n,r=e.keyEncoding||i,s=e.valueEncoding||e.encoding||o;return"utf8"!=r&&"binary"!=r||"utf8"!=s&&"binary"!=s?(n={type:e.type,key:b.encodeKey(e.key,t,e)},void 0!==e.value&&(n.value=b.encodeValue(e.value,t,e)),n):e}),void this.db.batch(s,t,function(t){return t?x(a,new l(t),n):(a.emit("batch",e),void(n&&n()))})):x(this,new l("Database is not open"),n):x(this,new l("batch() requires an array argument"),n)):new _(this)},i.prototype.approximateSize=function(e,t,n){var r,i,o=this;return null===e||void 0===e||null===t||void 0===t||"function"!=typeof n?x(this,new h("approximateSize() requires start, end and callback arguments"),n):(r=b.encodeKey(e,this.options),i=b.encodeKey(t,this.options),this._isOpening()||this.isOpen()?void this.db.approximateSize(r,i,function(e,t){return e?x(o,new p(e),n):void(n&&n(null,t))}):x(this,new l("Database is not open"),n))},i.prototype.readStream=i.prototype.createReadStream=function(e){var t=this;return e=c(this.options,e),new y(e,this,function(e){return t.db.iterator(e)})},i.prototype.keyStream=i.prototype.createKeyStream=function(e){return this.createReadStream(c(e,{keys:!0,values:!1}))},i.prototype.valueStream=i.prototype.createValueStream=function(e){return this.createReadStream(c(e,{keys:!1,values:!0}))},i.prototype.writeStream=i.prototype.createWriteStream=function(e){return new m(c(e),this)},i.prototype.toString=function(){return"LevelUP"},e.exports=i,e.exports.copy=b.copy,e.exports.destroy=o("destroy"),e.exports.repair=o("repair")}).call(t,n(1))},function(e,t,n){(function(e,r){function i(e,n){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&t._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),c(r,e,r.depth)}function o(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function s(e,t){return e}function a(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function c(e,n,r){if(e.customInspect&&n&&A(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return b(i)||(i=c(e,i,r)),i}var o=u(e,n);if(o)return o;var s=Object.keys(n),v=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),S(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(n);if(0===s.length){if(A(n)){var g=n.name?": "+n.name:"";return e.stylize("[Function"+g+"]","special")}if(E(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(x(n))return e.stylize(Date.prototype.toString.call(n),"date");if(S(n))return f(n)}var y="",m=!1,_=["{","}"];if(p(n)&&(m=!0,_=["[","]"]),A(n)){var w=n.name?": "+n.name:"";y=" [Function"+w+"]"}if(E(n)&&(y=" "+RegExp.prototype.toString.call(n)),x(n)&&(y=" "+Date.prototype.toUTCString.call(n)),S(n)&&(y=" "+f(n)),0===s.length&&(!m||0==n.length))return _[0]+y+_[1];if(r<0)return E(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n);var k;return k=m?l(e,n,r,v,s):s.map(function(t){return h(e,n,r,v,t,m)}),e.seen.pop(),d(k,y,_)}function u(e,t){if(w(t))return e.stylize("undefined","undefined");if(b(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return m(t)?e.stylize(""+t,"number"):v(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)j(t,String(s))?o.push(h(e,t,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(e,t,n,r,i,!0))}),o}function h(e,t,n,r,i,o){var s,a,u;if(u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},u.get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),j(r,i)||(s="["+i+"]"),a||(e.seen.indexOf(u.value)<0?(a=g(n)?c(e,u.value,null):c(e,u.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function d(e,t,n){var r=0,i=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function p(e){return Array.isArray(e)}function v(e){return"boolean"==typeof e}function g(e){return null===e}function y(e){return null==e}function m(e){return"number"==typeof e}function b(e){return"string"==typeof e}function _(e){return"symbol"==typeof e}function w(e){return void 0===e}function E(e){return k(e)&&"[object RegExp]"===O(e)}function k(e){return"object"==typeof e&&null!==e}function x(e){return k(e)&&"[object Date]"===O(e)}function S(e){return k(e)&&("[object Error]"===O(e)||e instanceof Error)}function A(e){return"function"==typeof e}function T(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function O(e){return Object.prototype.toString.call(e)}function R(e){return e<10?"0"+e.toString(10):e.toString(10)}function C(){var e=new Date,t=[R(e.getHours()),R(e.getMinutes()),R(e.getSeconds())].join(":");return[e.getDate(),N[e.getMonth()],t].join(" ")}function j(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var D=/%[sdj%]/g;t.format=function(e){if(!b(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,o=r.length,s=String(e).replace(D,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),a=r[n];n<o;a=r[++n])s+=g(a)||!k(a)?" "+a:" "+i(a);return s},t.deprecate=function(n,i){function o(){if(!s){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),s=!0}return n.apply(this,arguments)}if(w(e.process))return function(){return t.deprecate(n,i).apply(this,arguments)};if(r.noDeprecation===!0)return n;var s=!1;return o};var L,I={};t.debuglog=function(e){if(w(L)&&(L=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!I[e])if(new RegExp("\\b"+e+"\\b","i").test(L)){var n=r.pid;I[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else I[e]=function(){};return I[e]},t.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=v,t.isNull=g,t.isNullOrUndefined=y,t.isNumber=m,t.isString=b,t.isSymbol=_,t.isUndefined=w,t.isRegExp=E,t.isObject=k,t.isDate=x,t.isError=S,t.isFunction=A,t.isPrimitive=T,t.isBuffer=n(95);var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",C(),t.format.apply(t,arguments))},t.inherits=n(96),t._extend=function(e,t){if(!t||!k(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(t,function(){return this;
}(),n(1))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){function n(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}return e}e.exports=n},function(e,t){/*!
	  * prr
	  * (c) 2013 Rod Vagg <rod@vagg.org>
	  * https://github.com/rvagg/prr
	  * License: MIT
	  */
!function(t,n,r){"undefined"!=typeof e&&e.exports?e.exports=r():n[t]=r()}("prr",this,function(){var e="function"==typeof Object.defineProperty?function(e,t,n){return Object.defineProperty(e,t,n),e}:function(e,t,n){return e[t]=n.value,e},t=function(e,t){var n="object"==typeof t,r=!n&&"string"==typeof t,i=function(e){return n?!!t[e]:!!r&&t.indexOf(e[0])>-1};return{enumerable:i("enumerable"),configurable:i("configurable"),writable:i("writable"),value:e}},n=function(n,r,i,o){var s;if(o=t(i,o),"object"==typeof r){for(s in r)Object.hasOwnProperty.call(r,s)&&(o.value=r[s],e(n,s,o));return n}return e(n,r,o)};return n})},function(e,t,n){(function(t,r){function i(e){s.call(this,"string"==typeof e?e:""),this._db=void 0,this._operations=[]}var o=n(94),s=n(100).AbstractLevelDOWN;o.inherits(i,s),i.prototype.setDb=function(e){this._db=e,this._operations.forEach(function(t){e[t.method].apply(e,t.args)})},i.prototype._open=function(e,n){return t.nextTick(n)},i.prototype._operation=function(e,t){return this._db?this._db[e].apply(this._db,t):void this._operations.push({method:e,args:t})},"put get del batch approximateSize".split(" ").forEach(function(e){i.prototype["_"+e]=function(){this._operation(e,arguments)}}),i.prototype._isBuffer=function(e){return r.isBuffer(e)},i.prototype._iterator=function(){throw new TypeError("not implemented")},e.exports=i}).call(t,n(1),n(89).Buffer)},function(e,t,n){(function(t,r){function i(e){if(!arguments.length||void 0===e)throw new Error("constructor requires at least a location argument");if("string"!=typeof e)throw new Error("constructor requires a location string argument");this.location=e}var o=n(97),s=n(101),a=n(102);i.prototype.open=function(e,n){if("function"==typeof e&&(n=e),"function"!=typeof n)throw new Error("open() requires a callback argument");return"object"!=typeof e&&(e={}),"function"==typeof this._open?this._open(e,n):void t.nextTick(n)},i.prototype.close=function(e){if("function"!=typeof e)throw new Error("close() requires a callback argument");return"function"==typeof this._close?this._close(e):void t.nextTick(e)},i.prototype.get=function(e,n,r){var i;if("function"==typeof n&&(r=n),"function"!=typeof r)throw new Error("get() requires a callback argument");return(i=this._checkKeyValue(e,"key",this._isBuffer))?r(i):(this._isBuffer(e)||(e=String(e)),"object"!=typeof n&&(n={}),"function"==typeof this._get?this._get(e,n,r):void t.nextTick(function(){r(new Error("NotFound"))}))},i.prototype.put=function(e,n,r,i){var o;if("function"==typeof r&&(i=r),"function"!=typeof i)throw new Error("put() requires a callback argument");return(o=this._checkKeyValue(e,"key",this._isBuffer))?i(o):(o=this._checkKeyValue(n,"value",this._isBuffer))?i(o):(this._isBuffer(e)||(e=String(e)),this._isBuffer(n)||t.browser||(n=String(n)),"object"!=typeof r&&(r={}),"function"==typeof this._put?this._put(e,n,r,i):void t.nextTick(i))},i.prototype.del=function(e,n,r){var i;if("function"==typeof n&&(r=n),"function"!=typeof r)throw new Error("del() requires a callback argument");return(i=this._checkKeyValue(e,"key",this._isBuffer))?r(i):(this._isBuffer(e)||(e=String(e)),"object"!=typeof n&&(n={}),"function"==typeof this._del?this._del(e,n,r):void t.nextTick(r))},i.prototype.batch=function(e,n,r){if(!arguments.length)return this._chainedBatch();if("function"==typeof n&&(r=n),"function"!=typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(e))return r(new Error("batch(array) requires an array argument"));"object"!=typeof n&&(n={});for(var i,o,s=0,a=e.length;s<a;s++)if(i=e[s],"object"==typeof i){if(o=this._checkKeyValue(i.type,"type",this._isBuffer))return r(o);if(o=this._checkKeyValue(i.key,"key",this._isBuffer))return r(o);if("put"==i.type&&(o=this._checkKeyValue(i.value,"value",this._isBuffer)))return r(o)}return"function"==typeof this._batch?this._batch(e,n,r):void t.nextTick(r)},i.prototype.approximateSize=function(e,n,r){if(null==e||null==n||"function"==typeof e||"function"==typeof n)throw new Error("approximateSize() requires valid `start`, `end` and `callback` arguments");if("function"!=typeof r)throw new Error("approximateSize() requires a callback argument");return this._isBuffer(e)||(e=String(e)),this._isBuffer(n)||(n=String(n)),"function"==typeof this._approximateSize?this._approximateSize(e,n,r):void t.nextTick(function(){r(null,0)})},i.prototype._setupIteratorOptions=function(e){var t=this;return e=o(e),["start","end","gt","gte","lt","lte"].forEach(function(n){e[n]&&t._isBuffer(e[n])&&0===e[n].length&&delete e[n]}),e.reverse=!!e.reverse,e.reverse&&e.lt&&(e.start=e.lt),e.reverse&&e.lte&&(e.start=e.lte),!e.reverse&&e.gt&&(e.start=e.gt),!e.reverse&&e.gte&&(e.start=e.gte),(e.reverse&&e.lt&&!e.lte||!e.reverse&&e.gt&&!e.gte)&&(e.exclusiveStart=!0),e},i.prototype.iterator=function(e){return"object"!=typeof e&&(e={}),e=this._setupIteratorOptions(e),"function"==typeof this._iterator?this._iterator(e):new s(this)},i.prototype._chainedBatch=function(){return new a(this)},i.prototype._isBuffer=function(e){return r.isBuffer(e)},i.prototype._checkKeyValue=function(e,t){if(null===e||void 0===e)return new Error(t+" cannot be `null` or `undefined`");if(this._isBuffer(e)){if(0===e.length)return new Error(t+" cannot be an empty Buffer")}else if(""===String(e))return new Error(t+" cannot be an empty String")},e.exports.AbstractLevelDOWN=i,e.exports.AbstractIterator=s,e.exports.AbstractChainedBatch=a}).call(t,n(1),n(89).Buffer)},function(e,t,n){(function(t){function n(e){this.db=e,this._ended=!1,this._nexting=!1}n.prototype.next=function(e){var n=this;if("function"!=typeof e)throw new Error("next() requires a callback argument");return n._ended?e(new Error("cannot call next() after end()")):n._nexting?e(new Error("cannot call next() before previous next() has completed")):(n._nexting=!0,"function"==typeof n._next?n._next(function(){n._nexting=!1,e.apply(null,arguments)}):void t.nextTick(function(){n._nexting=!1,e()}))},n.prototype.end=function(e){if("function"!=typeof e)throw new Error("end() requires a callback argument");return this._ended?e(new Error("end() already called on iterator")):(this._ended=!0,"function"==typeof this._end?this._end(e):void t.nextTick(e))},e.exports=n}).call(t,n(1))},function(e,t,n){(function(t){function n(e){this._db=e,this._operations=[],this._written=!1}n.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},n.prototype.put=function(e,t){this._checkWritten();var n=this._db._checkKeyValue(e,"key",this._db._isBuffer);if(n)throw n;if(n=this._db._checkKeyValue(t,"value",this._db._isBuffer))throw n;return this._db._isBuffer(e)||(e=String(e)),this._db._isBuffer(t)||(t=String(t)),"function"==typeof this._put?this._put(e,t):this._operations.push({type:"put",key:e,value:t}),this},n.prototype.del=function(e){this._checkWritten();var t=this._db._checkKeyValue(e,"key",this._db._isBuffer);if(t)throw t;return this._db._isBuffer(e)||(e=String(e)),"function"==typeof this._del?this._del(e):this._operations.push({type:"del",key:e}),this},n.prototype.clear=function(){return this._checkWritten(),this._operations=[],"function"==typeof this._clear&&this._clear(),this},n.prototype.write=function(e,n){if(this._checkWritten(),"function"==typeof e&&(n=e),"function"!=typeof n)throw new Error("write() requires a callback argument");return"object"!=typeof e&&(e={}),this._written=!0,"function"==typeof this._write?this._write(n):"function"==typeof this._db._batch?this._db._batch(this._operations,e,n):void t.nextTick(n)},e.exports=n}).call(t,n(1))},function(e,t,n){var r=n(104).create,i=r("LevelUPError"),o=r("NotFoundError",i);o.prototype.notFound=!0,o.prototype.status=404,e.exports={LevelUPError:i,InitializationError:r("InitializationError",i),OpenError:r("OpenError",i),ReadError:r("ReadError",i),WriteError:r("WriteError",i),NotFoundError:o,EncodingError:r("EncodingError",i)}},function(e,t,n){var r=e.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];e.exports.errno={},e.exports.code={},r.forEach(function(t){e.exports.errno[t.errno]=t,e.exports.code[t.code]=t}),e.exports.custom=n(105)(e.exports),e.exports.create=e.exports.custom.createError},function(e,t,n){function r(e,t,n){s(this,{type:e,name:e,cause:"string"!=typeof t?t:n,message:t&&"string"!=typeof t?t.message:t},"ewr")}function i(e,t){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),r.call(this,"CustomError",e,t)}function o(e,t,n){var o=function(n,i){r.call(this,t,n,i),"FilesystemError"==t&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(e.errno[this.cause.errno]?e.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee)};return o.prototype=n?new n:new i,o}var s=n(98);i.prototype=new Error,e.exports=function(e){var t=function(t,n){return o(e,t,n)};return{CustomError:i,FilesystemError:t("FilesystemError"),createError:t}}},function(e,t,n){function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);i.call(this,{objectMode:!0,highWaterMark:e.highWaterMark}),this._db=t,e=this._options=s(u,e),this._keyEncoding=e.keyEncoding||e.encoding,this._valueEncoding=e.valueEncoding||e.encoding,"undefined"!=typeof this._options.start&&(this._options.start=c.encodeKey(this._options.start,this._options)),"undefined"!=typeof this._options.end&&(this._options.end=c.encodeKey(this._options.end,this._options)),"number"!=typeof this._options.limit&&(this._options.limit=-1),this._options.keyAsBuffer=c.isKeyAsBuffer(this._options),this._options.valueAsBuffer=c.isValueAsBuffer(this._options),this._makeData=this._options.keys&&this._options.values?f:this._options.keys?l:this._options.values?h:d;var o=this;this._db.isOpen()?this._iterator=n(this._options):this._db.once("ready",function(){o._destroyed||(o._iterator=n(o._options))})}var i=n(107).Readable,o=n(94).inherits,s=n(97),a=n(103).EncodingError,c=n(133),u={keys:!0,values:!0},f=function(e,t){return{key:c.decodeKey(e,this._options),value:c.decodeValue(t,this._options)}},l=function(e){return c.decodeKey(e,this._options)},h=function(e,t){return c.decodeValue(t,this._options)},d=function(){return null};o(r,i),r.prototype._read=function p(){var e=this;return e._db.isOpen()?void(e._destroyed||e._iterator.next(function(t,n,r){if(t||void 0===n&&void 0===r)return t||e._destroyed||e.push(null),e._cleanup(t);try{r=e._makeData(n,r)}catch(i){return e._cleanup(new a(i))}e._destroyed||e.push(r)})):e._db.once("ready",function(){p.call(e)})},r.prototype._cleanup=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;e&&t.emit("error",e),t._iterator?t._iterator.end(function(){t._iterator=null,t.emit("close")}):t.emit("close")}},r.prototype.destroy=function(){this._cleanup()},r.prototype.toString=function(){return"LevelUP.ReadStream"},e.exports=r},function(e,t,n){(function(r){var i=n(108);t=e.exports=n(125),t.Stream=i,t.Readable=t,t.Writable=n(129),t.Duplex=n(130),t.Transform=n(131),t.PassThrough=n(132),r.browser||"disable"!==r.env.READABLE_STREAM||(e.exports=n(108))}).call(t,n(1))},function(e,t,n){function r(){i.call(this)}e.exports=r;var i=n(19).EventEmitter,o=n(109);o(r,i),r.Readable=n(110),r.Writable=n(121),r.Duplex=n(122),r.Transform=n(123),r.PassThrough=n(124),r.Stream=r,r.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&u.pause&&u.pause()}function r(){u.readable&&u.resume&&u.resume()}function o(){f||(f=!0,e.end())}function s(){f||(f=!0,"function"==typeof e.destroy&&e.destroy())}function a(e){if(c(),0===i.listenerCount(this,"error"))throw e}function c(){u.removeListener("data",n),e.removeListener("drain",r),u.removeListener("end",o),u.removeListener("close",s),u.removeListener("error",a),e.removeListener("error",a),u.removeListener("end",c),u.removeListener("close",c),e.removeListener("close",c)}var u=this;u.on("data",n),e.on("drain",r),e._isStdio||t&&t.end===!1||(u.on("end",o),u.on("close",s));var f=!1;return u.on("error",a),e.on("error",a),u.on("end",c),u.on("close",c),e.on("close",c),e.emit("pipe",u),e}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){(function(r){t=e.exports=n(111),t.Stream=n(108),t.Readable=t,t.Writable=n(117),t.Duplex=n(116),t.Transform=n(119),t.PassThrough=n(120),r.browser||"disable"!==r.env.READABLE_STREAM||(e.exports=n(108))}).call(t,n(1))},function(e,t,n){(function(t){function r(e,t){var r=n(116);e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,t instanceof r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(O||(O=n(118).StringDecoder),this.decoder=new O(e.encoding),this.encoding=e.encoding)}function i(e){n(116);return this instanceof i?(this._readableState=new r(e,this),this.readable=!0,void A.call(this)):new i(e)}function o(e,t,n,r,i){var o=u(t,n);if(o)e.emit("error",o);else if(T.isNullOrUndefined(n))t.reading=!1,t.ended||f(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var a=new Error("stream.unshift() after end event");e.emit("error",a)}else!t.decoder||i||r||(n=t.decoder.write(n)),i||(t.reading=!1),t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&l(e)),d(e,t);else i||(t.reading=!1);return s(t)}function s(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function a(e){if(e>=C)e=C;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function c(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||T.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=a(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function u(e,t){var n=null;return T.isBuffer(t)||T.isString(t)||T.isNullOrUndefined(t)||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function f(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,l(e)}function l(e){var n=e._readableState;n.needReadable=!1,n.emittedReadable||(R("emitReadable",n.flowing),n.emittedReadable=!0,n.sync?t.nextTick(function(){h(e)}):h(e))}function h(e){R("emit readable"),e.emit("readable"),m(e)}function d(e,n){n.readingMore||(n.readingMore=!0,t.nextTick(function(){p(e,n)}))}function p(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(R("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function v(e){return function(){var t=e._readableState;R("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&S.listenerCount(e,"data")&&(t.flowing=!0,m(e))}}function g(e,n){n.resumeScheduled||(n.resumeScheduled=!0,t.nextTick(function(){y(e,n)}))}function y(e,t){t.resumeScheduled=!1,e.emit("resume"),m(e),t.flowing&&!t.reading&&e.read(0)}function m(e){var t=e._readableState;if(R("flow",t.flowing),t.flowing)do var n=e.read();while(null!==n&&t.flowing)}function b(e,t){var n,r=t.buffer,i=t.length,o=!!t.decoder,s=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(s)n=r.shift();else if(!e||e>=i)n=o?r.join(""):x.concat(r,i),r.length=0;else if(e<r[0].length){var a=r[0];n=a.slice(0,e),r[0]=a.slice(e)}else if(e===r[0].length)n=r.shift();else{n=o?"":new x(e);for(var c=0,u=0,f=r.length;u<f&&c<e;u++){var a=r[0],l=Math.min(e-c,a.length);o?n+=a.slice(0,l):a.copy(n,c,0,l),l<a.length?r[0]=a.slice(l):r.shift(),c+=l}}return n}function _(e){var n=e._readableState;if(n.length>0)throw new Error("endReadable called on non-empty stream");n.endEmitted||(n.ended=!0,t.nextTick(function(){n.endEmitted||0!==n.length||(n.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function w(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function E(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}e.exports=i;var k=n(112),x=n(89).Buffer;i.ReadableState=r;var S=n(19).EventEmitter;S.listenerCount||(S.listenerCount=function(e,t){return e.listeners(t).length});var A=n(108),T=n(113);T.inherits=n(114);var O,R=n(115);R=R&&R.debuglog?R.debuglog("stream"):function(){},T.inherits(i,A),i.prototype.push=function(e,t){var n=this._readableState;return T.isString(e)&&!n.objectMode&&(t=t||n.defaultEncoding,t!==n.encoding&&(e=new x(e,t),t="")),o(this,n,e,t,!1)},i.prototype.unshift=function(e){var t=this._readableState;return o(this,t,e,"",!0)},i.prototype.setEncoding=function(e){return O||(O=n(118).StringDecoder),this._readableState.decoder=new O(e),this._readableState.encoding=e,this};var C=8388608;i.prototype.read=function(e){R("read",e);var t=this._readableState,n=e;if((!T.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return R("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?_(this):l(this),null;if(e=c(e,t),0===e&&t.ended)return 0===t.length&&_(this),null;var r=t.needReadable;R("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,R("length less than watermark",r)),(t.ended||t.reading)&&(r=!1,R("reading or ended",r)),r&&(R("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=c(n,t));var i;return i=e>0?b(e,t):null,T.isNull(i)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&_(this),T.isNull(i)||this.emit("data",i),i},i.prototype._read=function(e){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(e,n){function r(e){R("onunpipe"),e===l&&o()}function i(){R("onend"),e.end()}function o(){R("cleanup"),e.removeListener("close",c),e.removeListener("finish",u),e.removeListener("drain",g),e.removeListener("error",a),e.removeListener("unpipe",r),l.removeListener("end",i),l.removeListener("end",o),l.removeListener("data",s),!h.awaitDrain||e._writableState&&!e._writableState.needDrain||g()}function s(t){R("ondata");var n=e.write(t);!1===n&&(R("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,l.pause())}function a(t){R("onerror",t),f(),e.removeListener("error",a),0===S.listenerCount(e,"error")&&e.emit("error",t)}function c(){e.removeListener("finish",u),f()}function u(){R("onfinish"),e.removeListener("close",c),f()}function f(){R("unpipe"),l.unpipe(e)}var l=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=e;break;case 1:h.pipes=[h.pipes,e];break;default:h.pipes.push(e)}h.pipesCount+=1,R("pipe count=%d opts=%j",h.pipesCount,n);var d=(!n||n.end!==!1)&&e!==t.stdout&&e!==t.stderr,p=d?i:o;h.endEmitted?t.nextTick(p):l.once("end",p),e.on("unpipe",r);var g=v(l);return e.on("drain",g),l.on("data",s),e._events&&e._events.error?k(e._events.error)?e._events.error.unshift(a):e._events.error=[a,e._events.error]:e.on("error",a),e.once("close",c),e.once("finish",u),e.emit("pipe",l),h.flowing||(R("pipe resume"),l.resume()),e},i.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var i=E(t.pipes,e);return i===-1?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},i.prototype.on=function(e,n){var r=A.prototype.on.call(this,e,n);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var i=this._readableState;if(!i.readableListening)if(i.readableListening=!0,i.emittedReadable=!1,i.needReadable=!0,i.reading)i.length&&l(this,i);else{var o=this;t.nextTick(function(){R("readable nexttick read 0"),o.read(0)})}}return r},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var e=this._readableState;return e.flowing||(R("resume"),e.flowing=!0,e.reading||(R("resume read 0"),this.read(0)),g(this,e)),this},i.prototype.pause=function(){return R("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(R("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(R("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(R("wrapped data"),t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length)){var o=r.push(i);o||(n=!0,e.pause())}});for(var i in e)T.isFunction(e[i])&&T.isUndefined(this[i])&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return w(o,function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){R("wrapped _read",t),n&&(n=!1,e.resume())},r},i._fromList=b}).call(t,n(1))},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){(function(e){function n(e){return Array.isArray?Array.isArray(e):"[object Array]"===g(e)}function r(e){return"boolean"==typeof e}function i(e){return null===e}function o(e){return null==e}function s(e){return"number"==typeof e}function a(e){return"string"==typeof e}function c(e){return"symbol"==typeof e}function u(e){return void 0===e}function f(e){return"[object RegExp]"===g(e)}function l(e){return"object"==typeof e&&null!==e}function h(e){return"[object Date]"===g(e)}function d(e){return"[object Error]"===g(e)||e instanceof Error}function p(e){return"function"==typeof e}function v(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function g(e){return Object.prototype.toString.call(e)}t.isArray=n,t.isBoolean=r,t.isNull=i,t.isNullOrUndefined=o,t.isNumber=s,t.isString=a,t.isSymbol=c,t.isUndefined=u,t.isRegExp=f,t.isObject=l,t.isDate=h,t.isError=d,t.isFunction=p,t.isPrimitive=v,t.isBuffer=e.isBuffer}).call(t,n(89).Buffer)},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){},function(e,t,n){(function(t){function r(e){return this instanceof r?(c.call(this,e),u.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(e)}function i(){this.allowHalfOpen||this._writableState.ended||t.nextTick(this.end.bind(this))}function o(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}e.exports=r;var s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},a=n(113);a.inherits=n(114);var c=n(111),u=n(117);a.inherits(r,c),o(s(u.prototype),function(e){r.prototype[e]||(r.prototype[e]=u.prototype[e])})}).call(t,n(1))},function(e,t,n){(function(t){function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n}function i(e,t){var r=n(116);e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.objectMode=!!e.objectMode,t instanceof r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=e.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){d(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function o(e){var t=n(116);return this instanceof o||this instanceof t?(this._writableState=new i(e,this),this.writable=!0,void k.call(this)):new o(e)}function s(e,n,r){var i=new Error("write after end");e.emit("error",i),t.nextTick(function(){r(i)})}function a(e,n,r,i){var o=!0;if(!(E.isBuffer(r)||E.isString(r)||E.isNullOrUndefined(r)||n.objectMode)){var s=new TypeError("Invalid non-string/buffer chunk");e.emit("error",s),t.nextTick(function(){i(s)}),o=!1}return o}function c(e,t,n){return!e.objectMode&&e.decodeStrings!==!1&&E.isString(t)&&(t=new w(t,n)),t}function u(e,t,n,i,o){n=c(t,n,i),E.isBuffer(n)&&(i="buffer");var s=t.objectMode?1:n.length;t.length+=s;var a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing||t.corked?t.buffer.push(new r(n,i,o)):f(e,t,!1,s,n,i,o),a}function f(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function l(e,n,r,i,o){r?t.nextTick(function(){n.pendingcb--,o(i)}):(n.pendingcb--,o(i)),e._writableState.errorEmitted=!0,e.emit("error",i)}function h(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function d(e,n){var r=e._writableState,i=r.sync,o=r.writecb;if(h(r),n)l(e,r,i,n,o);else{var s=y(e,r);s||r.corked||r.bufferProcessing||!r.buffer.length||g(e,r),i?t.nextTick(function(){p(e,r,s,o)}):p(e,r,s,o)}}function p(e,t,n,r){n||v(e,t),t.pendingcb--,r(),b(e,t)}function v(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function g(e,t){if(t.bufferProcessing=!0,e._writev&&t.buffer.length>1){for(var n=[],r=0;r<t.buffer.length;r++)n.push(t.buffer[r].callback);t.pendingcb++,f(e,t,!0,t.length,t.buffer,"",function(e){for(var r=0;r<n.length;r++)t.pendingcb--,n[r](e)}),t.buffer=[]}else{for(var r=0;r<t.buffer.length;r++){var i=t.buffer[r],o=i.chunk,s=i.encoding,a=i.callback,c=t.objectMode?1:o.length;if(f(e,t,!1,c,o,s,a),t.writing){r++;break}}r<t.buffer.length?t.buffer=t.buffer.slice(r):t.buffer.length=0}t.bufferProcessing=!1}function y(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function m(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function b(e,t){var n=y(e,t);return n&&(0===t.pendingcb?(m(e,t),t.finished=!0,e.emit("finish")):m(e,t)),n}function _(e,n,r){n.ending=!0,b(e,n),r&&(n.finished?t.nextTick(r):e.once("finish",r)),n.ended=!0}e.exports=o;var w=n(89).Buffer;o.WritableState=i;var E=n(113);E.inherits=n(114);var k=n(108);E.inherits(o,k),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(e,t,n){var r=this._writableState,i=!1;return E.isFunction(t)&&(n=t,t=null),E.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),E.isFunction(n)||(n=function(){}),r.ended?s(this,r,n):a(this,r,e,n)&&(r.pendingcb++,i=u(this,r,e,t,n)),i},o.prototype.cork=function(){var e=this._writableState;e.corked++},o.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||g(this,e))},o.prototype._write=function(e,t,n){n(new Error("not implemented"))},o.prototype._writev=null,o.prototype.end=function(e,t,n){var r=this._writableState;E.isFunction(e)?(n=e,e=null,t=null):E.isFunction(t)&&(n=t,t=null),E.isNullOrUndefined(e)||this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||_(this,r,n)}}).call(t,n(1))},function(e,t,n){function r(e){if(e&&!c(e))throw new Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function s(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var a=n(89).Buffer,c=a.isEncoding||function(e){
switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},u=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(!(r>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&r<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},u.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},u.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},function(e,t,n){function r(e,t){this.afterTransform=function(e,n){return i(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,c.isNullOrUndefined(n)||e.push(n),i&&i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);a.call(this,e),this._transformState=new r(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){c.isFunction(this._flush)?this._flush(function(e){s(t,e)}):s(t)})}function s(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}e.exports=o;var a=n(116),c=n(113);c.inherits=n(114),c.inherits(o,a),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;c.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))}},function(e,t,n){function r(e){return this instanceof r?void i.call(this,e):new r(e)}e.exports=r;var i=n(119),o=n(113);o.inherits=n(114),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(117)},function(e,t,n){e.exports=n(116)},function(e,t,n){e.exports=n(119)},function(e,t,n){e.exports=n(120)},function(e,t,n){(function(t){function r(e,t){e=e||{};var r=e.highWaterMark;this.highWaterMark=r||0===r?r:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(O||(O=n(128).StringDecoder),this.decoder=new O(e.encoding),this.encoding=e.encoding)}function i(e){return this instanceof i?(this._readableState=new r(e,this),this.readable=!0,void A.call(this)):new i(e)}function o(e,t,n,r,i){var o=u(t,n);if(o)e.emit("error",o);else if(null===n||void 0===n)t.reading=!1,t.ended||f(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var a=new Error("stream.unshift() after end event");e.emit("error",a)}else!t.decoder||i||r||(n=t.decoder.write(n)),t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):(t.reading=!1,t.buffer.push(n)),t.needReadable&&l(e),d(e,t);else i||(t.reading=!1);return s(t)}function s(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function a(e){if(e>=R)e=R;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function c(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=a(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function u(e,t){var n=null;return x.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function f(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.length>0?l(e):_(e)}function l(e){var n=e._readableState;n.needReadable=!1,n.emittedReadable||(n.emittedReadable=!0,n.sync?t.nextTick(function(){h(e)}):h(e))}function h(e){e.emit("readable")}function d(e,n){n.readingMore||(n.readingMore=!0,t.nextTick(function(){p(e,n)}))}function p(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function v(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&g(e)}}function g(e){function t(e,t,i){var o=e.write(n);!1===o&&r.awaitDrain++}var n,r=e._readableState;for(r.awaitDrain=0;r.pipesCount&&null!==(n=e.read());)if(1===r.pipesCount?t(r.pipes,0,null):w(r.pipes,t),e.emit("data",n),r.awaitDrain>0)return;return 0===r.pipesCount?(r.flowing=!1,void(S.listenerCount(e,"data")>0&&m(e))):void(r.ranOut=!0)}function y(){this._readableState.ranOut&&(this._readableState.ranOut=!1,g(this))}function m(e,n){var r=e._readableState;if(r.flowing)throw new Error("Cannot switch to old mode now.");var i=n||!1,o=!1;e.readable=!0,e.pipe=A.prototype.pipe,e.on=e.addListener=A.prototype.on,e.on("readable",function(){o=!0;for(var t;!i&&null!==(t=e.read());)e.emit("data",t);null===t&&(o=!1,e._readableState.needReadable=!0)}),e.pause=function(){i=!0,this.emit("pause")},e.resume=function(){i=!1,o?t.nextTick(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function b(e,t){var n,r=t.buffer,i=t.length,o=!!t.decoder,s=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(s)n=r.shift();else if(!e||e>=i)n=o?r.join(""):x.concat(r,i),r.length=0;else if(e<r[0].length){var a=r[0];n=a.slice(0,e),r[0]=a.slice(e)}else if(e===r[0].length)n=r.shift();else{n=o?"":new x(e);for(var c=0,u=0,f=r.length;u<f&&c<e;u++){var a=r[0],l=Math.min(e-c,a.length);o?n+=a.slice(0,l):a.copy(n,c,0,l),l<a.length?r[0]=a.slice(l):r.shift(),c+=l}}return n}function _(e){var n=e._readableState;if(n.length>0)throw new Error("endReadable called on non-empty stream");!n.endEmitted&&n.calledRead&&(n.ended=!0,t.nextTick(function(){n.endEmitted||0!==n.length||(n.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function w(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function E(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}e.exports=i;var k=n(126),x=n(89).Buffer;i.ReadableState=r;var S=n(19).EventEmitter;S.listenerCount||(S.listenerCount=function(e,t){return e.listeners(t).length});var A=n(108),T=n(127);T.inherits=n(16);var O;T.inherits(i,A),i.prototype.push=function(e,t){var n=this._readableState;return"string"!=typeof e||n.objectMode||(t=t||n.defaultEncoding,t!==n.encoding&&(e=new x(e,t),t="")),o(this,n,e,t,!1)},i.prototype.unshift=function(e){var t=this._readableState;return o(this,t,e,"",!0)},i.prototype.setEncoding=function(e){O||(O=n(128).StringDecoder),this._readableState.decoder=new O(e),this._readableState.encoding=e};var R=8388608;i.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var n,r=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return l(this),null;if(e=c(e,t),0===e&&t.ended)return n=null,t.length>0&&t.decoder&&(n=b(e,t),t.length-=n.length),0===t.length&&_(this),n;var i=t.needReadable;return t.length-e<=t.highWaterMark&&(i=!0),(t.ended||t.reading)&&(i=!1),i&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=c(r,t)),n=e>0?b(e,t):null,null===n&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&_(this),n},i.prototype._read=function(e){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(e,n){function r(e){e===f&&o()}function i(){e.end()}function o(){e.removeListener("close",a),e.removeListener("finish",c),e.removeListener("drain",p),e.removeListener("error",s),e.removeListener("unpipe",r),f.removeListener("end",i),f.removeListener("end",o),e._writableState&&!e._writableState.needDrain||p()}function s(t){u(),e.removeListener("error",s),0===S.listenerCount(e,"error")&&e.emit("error",t)}function a(){e.removeListener("finish",c),u()}function c(){e.removeListener("close",a),u()}function u(){f.unpipe(e)}var f=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=e;break;case 1:l.pipes=[l.pipes,e];break;default:l.pipes.push(e)}l.pipesCount+=1;var h=(!n||n.end!==!1)&&e!==t.stdout&&e!==t.stderr,d=h?i:o;l.endEmitted?t.nextTick(d):f.once("end",d),e.on("unpipe",r);var p=v(f);return e.on("drain",p),e._events&&e._events.error?k(e._events.error)?e._events.error.unshift(s):e._events.error=[s,e._events.error]:e.on("error",s),e.once("close",a),e.once("finish",c),e.emit("pipe",f),l.flowing||(this.on("readable",y),l.flowing=!0,t.nextTick(function(){g(f)})),e},i.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",y),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",y),t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var i=E(t.pipes,e);return i===-1?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},i.prototype.on=function(e,t){var n=A.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||m(this),"readable"===e&&this.readable){var r=this._readableState;r.readableListening||(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading?r.length&&l(this,r):this.read(0))}return n},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){m(this),this.read(0),this.emit("resume")},i.prototype.pause=function(){m(this,!0),this.emit("pause")},i.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)){var o=r.push(i);o||(n=!0,e.pause())}});for(var i in e)"function"==typeof e[i]&&"undefined"==typeof this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return w(o,function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){n&&(n=!1,e.resume())},r},i._fromList=b}).call(t,n(1))},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){(function(e){function n(e){return Array.isArray?Array.isArray(e):"[object Array]"===g(e)}function r(e){return"boolean"==typeof e}function i(e){return null===e}function o(e){return null==e}function s(e){return"number"==typeof e}function a(e){return"string"==typeof e}function c(e){return"symbol"==typeof e}function u(e){return void 0===e}function f(e){return"[object RegExp]"===g(e)}function l(e){return"object"==typeof e&&null!==e}function h(e){return"[object Date]"===g(e)}function d(e){return"[object Error]"===g(e)||e instanceof Error}function p(e){return"function"==typeof e}function v(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function g(e){return Object.prototype.toString.call(e)}t.isArray=n,t.isBoolean=r,t.isNull=i,t.isNullOrUndefined=o,t.isNumber=s,t.isString=a,t.isSymbol=c,t.isUndefined=u,t.isRegExp=f,t.isObject=l,t.isDate=h,t.isError=d,t.isFunction=p,t.isPrimitive=v,t.isBuffer=e.isBuffer}).call(t,n(89).Buffer)},function(e,t,n){function r(e){if(e&&!c(e))throw new Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function s(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var a=n(89).Buffer,c=a.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},u=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(!(r>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&r<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},u.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},u.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},function(e,t,n){(function(t){function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n}function i(e,t){e=e||{};var n=e.highWaterMark;this.highWaterMark=n||0===n?n:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=e.decodeStrings===!1;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){d(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function o(e){var t=n(130);return this instanceof o||this instanceof t?(this._writableState=new i(e,this),this.writable=!0,void E.call(this)):new o(e)}function s(e,n,r){var i=new Error("write after end");e.emit("error",i),t.nextTick(function(){r(i)})}function a(e,n,r,i){var o=!0;if(!_.isBuffer(r)&&"string"!=typeof r&&null!==r&&void 0!==r&&!n.objectMode){var s=new TypeError("Invalid non-string/buffer chunk");e.emit("error",s),t.nextTick(function(){i(s)}),o=!1}return o}function c(e,t,n){return e.objectMode||e.decodeStrings===!1||"string"!=typeof t||(t=new _(t,n)),t}function u(e,t,n,i,o){n=c(t,n,i),_.isBuffer(n)&&(i="buffer");var s=t.objectMode?1:n.length;t.length+=s;var a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing?t.buffer.push(new r(n,i,o)):f(e,t,s,n,i,o),a}function f(e,t,n,r,i,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,e._write(r,i,t.onwrite),t.sync=!1}function l(e,n,r,i,o){r?t.nextTick(function(){o(i)}):o(i),e._writableState.errorEmitted=!0,e.emit("error",i)}function h(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function d(e,n){var r=e._writableState,i=r.sync,o=r.writecb;if(h(r),n)l(e,r,i,n,o);else{var s=y(e,r);s||r.bufferProcessing||!r.buffer.length||g(e,r),i?t.nextTick(function(){p(e,r,s,o)}):p(e,r,s,o)}}function p(e,t,n,r){n||v(e,t),r(),n&&m(e,t)}function v(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function g(e,t){t.bufferProcessing=!0;for(var n=0;n<t.buffer.length;n++){var r=t.buffer[n],i=r.chunk,o=r.encoding,s=r.callback,a=t.objectMode?1:i.length;if(f(e,t,a,i,o,s),t.writing){n++;break}}t.bufferProcessing=!1,n<t.buffer.length?t.buffer=t.buffer.slice(n):t.buffer.length=0}function y(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function m(e,t){var n=y(e,t);return n&&(t.finished=!0,e.emit("finish")),n}function b(e,n,r){n.ending=!0,m(e,n),r&&(n.finished?t.nextTick(r):e.once("finish",r)),n.ended=!0}e.exports=o;var _=n(89).Buffer;o.WritableState=i;var w=n(127);w.inherits=n(16);var E=n(108);w.inherits(o,E),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(e,t,n){var r=this._writableState,i=!1;return"function"==typeof t&&(n=t,t=null),_.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=function(){}),r.ended?s(this,r,n):a(this,r,e,n)&&(i=u(this,r,e,t,n)),i},o.prototype._write=function(e,t,n){n(new Error("not implemented"))},o.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),"undefined"!=typeof e&&null!==e&&this.write(e,t),r.ending||r.finished||b(this,r,n)}}).call(t,n(1))},function(e,t,n){(function(t){function r(e){return this instanceof r?(c.call(this,e),u.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(e)}function i(){this.allowHalfOpen||this._writableState.ended||t.nextTick(this.end.bind(this))}function o(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}e.exports=r;var s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},a=n(127);a.inherits=n(16);var c=n(125),u=n(129);a.inherits(r,c),o(s(u.prototype),function(e){r.prototype[e]||(r.prototype[e]=u.prototype[e])})}).call(t,n(1))},function(e,t,n){function r(e,t){this.afterTransform=function(e,n){return i(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),i&&i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);a.call(this,e);var t=(this._transformState=new r(e,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(e){s(t,e)}):s(t)})}function s(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=(e._readableState,e._transformState);if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}e.exports=o;var a=n(130),c=n(127);c.inherits=n(16),c.inherits(o,a),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},function(e,t,n){function r(e){return this instanceof r?void i.call(this,e):new r(e)}e.exports=r;var i=n(131),o=n(127);o.inherits=n(16),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){(function(t,r){function i(e,t,n){e.readStream().pipe(t.writeStream()).on("close",n?n:function(){}).on("error",n?n:function(e){throw e})}function o(e,t){var n="string"==typeof t;return!n&&t&&t.encoding&&!t.valueEncoding&&(t.valueEncoding=t.encoding),y(e&&e.options||{},n?E[t]||E[_.valueEncoding]:t)}function s(){if(g)return g;var e,t=n(134).devDependencies.leveldown,r="Could not locate LevelDOWN, try `npm install leveldown`";try{e=n(135).version}catch(i){throw new m(r)}if(!n(136).satisfies(e,t))throw new m("Installed version of LevelDOWN ("+e+") does not match required version ("+t+")");try{return g=n(137)}catch(i){throw new m(r)}}function a(e,t,n){return"function"==typeof n?n(t):e.emit("error",t)}function c(e,t){var n=t&&t.keyEncoding||e.keyEncoding||"utf8";return w[n]||n}function u(e,t){var n=t&&(t.valueEncoding||t.encoding)||e.valueEncoding||e.encoding||"utf8";return w[n]||n}function f(e,t,n){return c(t,n).encode(e)}function l(e,t,n){return u(t,n).encode(e)}function h(e,t){return c(t).decode(e)}function d(e,t){return u(t).decode(e)}function p(e,t){return u(e,t).buffer}function v(e,t){return c(e,t).buffer}var g,y=n(97),m=n(103).LevelUPError,b=["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le"],_={createIfMissing:!0,errorIfExists:!1,keyEncoding:"utf8",valueEncoding:"utf8",compression:!0},w=function(){function e(e){return void 0===e||null===e||t.isBuffer(e)}var n={};return n.utf8=n["utf-8"]={encode:function(t){return e(t)?t:String(t)},decode:function(e){return e},buffer:!1,type:"utf8"},n.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},b.forEach(function(i){n[i]||(n[i]={encode:function(n){return e(n)?n:new t(n,i)},decode:function(e){return r.browser?e.toString(i):e},buffer:!0,type:i})}),n}(),E=function(){var e={};return b.forEach(function(t){e[t]={valueEncoding:t}}),e}();e.exports={defaultOptions:_,copy:i,getOptions:o,getLevelDOWN:s,dispatchError:a,encodeKey:f,encodeValue:l,isValueAsBuffer:p,isKeyAsBuffer:v,decodeValue:d,decodeKey:h}}).call(t,n(89).Buffer,n(1))},function(e,t){e.exports={name:"levelup",description:"Fast & simple storage - a Node.js-style LevelDB wrapper",version:"0.18.6",contributors:[{name:"Rod Vagg",email:"r@va.gg",url:"https://github.com/rvagg"},{name:"John Chesley",email:"john@chesl.es",url:"https://github.com/chesles/"},{name:"Jake Verbaten",email:"raynos2@gmail.com",url:"https://github.com/raynos"},{name:"Dominic Tarr",email:"dominic.tarr@gmail.com",url:"https://github.com/dominictarr"},{name:"Max Ogden",email:"max@maxogden.com",url:"https://github.com/maxogden"},{name:"Lars-Magnus Skog",email:"lars.magnus.skog@gmail.com",url:"https://github.com/ralphtheninja"},{name:"David Bjrklund",email:"david.bjorklund@gmail.com",url:"https://github.com/kesla"},{name:"Julian Gruber",email:"julian@juliangruber.com",url:"https://github.com/juliangruber"},{name:"Paolo Fragomeni",email:"paolo@async.ly",url:"https://github.com/hij1nx"},{name:"Anton Whalley",email:"anton.whalley@nearform.com",url:"https://github.com/No9"},{name:"Matteo Collina",email:"matteo.collina@gmail.com",url:"https://github.com/mcollina"},{name:"Pedro Teixeira",email:"pedro.teixeira@gmail.com",url:"https://github.com/pgte"},{name:"James Halliday",email:"mail@substack.net",url:"https://github.com/substack"}],repository:{type:"git",url:"https://github.com/rvagg/node-levelup.git"},homepage:"https://github.com/rvagg/node-levelup",keywords:["leveldb","stream","database","db","store","storage","json"],main:"lib/levelup.js",dependencies:{bl:"~0.8.1","deferred-leveldown":"~0.2.0",errno:"~0.1.1",prr:"~0.0.0","readable-stream":"~1.0.26",semver:"~2.3.1",xtend:"~3.0.0"},devDependencies:{leveldown:"~0.10.0",bustermove:"*",tap:"*",referee:"*",rimraf:"*",async:"*",fstream:"*",tar:"*",mkfiletree:"*",readfiletree:"*","slow-stream":">=0.0.4",delayed:"*",boganipsum:"*",du:"*",memdown:"*","msgpack-js":"*"},browser:{leveldown:!1,"leveldown/package":!1,semver:!1},scripts:{test:"tap test/*-test.js --stderr",functionaltests:"node ./test/functional/fstream-test.js && node ./test/functional/binary-data-test.js && node ./test/functional/compat-test.js",alltests:"npm test && npm run-script functionaltests"},license:"MIT",gitHead:"213e989e2b75273e2b44c23f84f95e35bff7ea11",bugs:{url:"https://github.com/rvagg/node-levelup/issues"},_id:"levelup@0.18.6",_shasum:"e6a01cb089616c8ecc0291c2a9bd3f0c44e3e5eb",_from:"levelup@>=0.18.4 <0.19.0",_npmVersion:"1.4.14",_npmUser:{name:"rvagg",email:"rod@vagg.org"},maintainers:[{name:"rvagg",email:"rod@vagg.org"}],dist:{shasum:"e6a01cb089616c8ecc0291c2a9bd3f0c44e3e5eb",tarball:"http://registry.npmjs.org/levelup/-/levelup-0.18.6.tgz"},directories:{},_resolved:"https://registry.npmjs.org/levelup/-/levelup-0.18.6.tgz",readme:"ERROR: No README data found!"}},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){(function(t,r){function i(e,t){if(!(this instanceof i))return new i(e,t);o.call(this),this._options=a(l,f(t,e)),this._db=t,this._buffer=[],this._status="init",this._end=!1,this.writable=!0,this.readable=!1;var n=this,r=function(){n.writable&&(n._status="ready",n.emit("ready"),n._process())};t.isOpen()?u(r):t.once("ready",r)}var o=n(108).Stream,s=n(94).inherits,a=n(97),c=n(139),u=t.setImmediate||r.nextTick,f=n(133).getOptions,l={type:"put"};s(i,o),i.prototype.write=function(e){return!!this.writable&&(this._buffer.push(e),"init"!=this._status&&this._processDelayed(),!(this._options.maxBufferLength&&this._buffer.length>this._options.maxBufferLength)||(this._writeBlock=!0,!1))},i.prototype.end=function(e){var t=this;e&&this.write(e),u(function(){t._end=!0,t._process()})},i.prototype.destroy=function(){this.writable=!1,this.end()},i.prototype.destroySoon=function(){this.end()},i.prototype.add=function(e){if(e.props)return e.props.Directory?e.pipe(this._db.writeStream(this._options)):(e.props.File||e.File||"File"==e.type)&&this._write(e),!0},i.prototype._processDelayed=function(){var e=this;u(function(){e._process()})},i.prototype._process=function(){var e,t=this,n=function(e){if(t.writable)return"closed"!=t._status&&(t._status="ready"),e?(t.writable=!1,t.emit("error",e)):void t._process()};return"ready"!=t._status&&t.writable?void(t._buffer.length&&"closed"!=t._status&&t._processDelayed()):t._buffer.length&&t.writable?(t._status="writing",e=t._buffer,t._buffer=[],t._db.batch(e.map(function(e){return{type:e.type||t._options.type,key:e.key,value:e.value,keyEncoding:e.keyEncoding||t._options.keyEncoding,valueEncoding:e.valueEncoding||e.encoding||t._options.valueEncoding}}),n),void(t._writeBlock&&(t._writeBlock=!1,t.emit("drain")))):void(t._end&&"closed"!=t._status&&(t._status="closed",t.writable=!1,t.emit("close")))},i.prototype._write=function(e){var t=e.path||e.props.path,n=this;t&&e.pipe(c(function(e,r){return e?(n.writable=!1,n.emit("error",e)):(n._options.fstreamRoot&&t.indexOf(n._options.fstreamRoot)>-1&&(t=t.substr(n._options.fstreamRoot.length+1)),void n.write({key:t,value:r.slice(0)}))}))},i.prototype.toString=function(){return"LevelUP.WriteStream"},e.exports=i}).call(t,function(){return this}(),n(1))},function(e,t,n){(function(t){function r(e){if(!(this instanceof r))return new r(e);if(this._bufs=[],this.length=0,"function"==typeof e){this._callback=e;var n=function(e){this._callback&&(this._callback(e),this._callback=null)}.bind(this);this.on("pipe",function(e){e.on("error",n)}),this.on("unpipe",function(e){e.removeListener("error",n)})}else t.isBuffer(e)?this.append(e):Array.isArray(e)&&e.forEach(function(e){t.isBuffer(e)&&this.append(e)}.bind(this));i.call(this)}var i=n(107).Duplex,o=n(94);o.inherits(r,i),r.prototype._offset=function(e){for(var t,n=0,r=0;r<this._bufs.length;r++){if(t=n+this._bufs[r].length,e<t)return[r,e-n];n=t}},r.prototype.append=function(e){return this._bufs.push(t.isBuffer(e)?e:new t(e)),this.length+=e.length,this},r.prototype._write=function(e,t,n){this.append(e),n&&n()},r.prototype._read=function(e){return this.length?(e=Math.min(e,this.length),this.push(this.slice(0,e)),void this.consume(e)):this.push(null)},r.prototype.end=function(e){i.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},r.prototype.get=function(e){return this.slice(e,e+1)[0]},r.prototype.slice=function(e,t){return this.copy(null,0,e,t)},r.prototype.copy=function(e,n,r,i){if(("number"!=typeof r||r<0)&&(r=0),("number"!=typeof i||i>this.length)&&(i=this.length),r>=this.length)return e||new t(0);if(i<=0)return e||new t(0);var o,s,a=!!e,c=this._offset(r),u=i-r,f=u,l=a&&n||0,h=c[1];if(0===r&&i==this.length){if(!a)return t.concat(this._bufs);for(s=0;s<this._bufs.length;s++)this._bufs[s].copy(e,l),l+=this._bufs[s].length;return e}if(f<=this._bufs[c[0]].length-h)return a?this._bufs[c[0]].copy(e,n,h,h+f):this._bufs[c[0]].slice(h,h+f);for(a||(e=new t(u)),s=c[0];s<this._bufs.length;s++){if(o=this._bufs[s].length-h,!(f>o)){this._bufs[s].copy(e,l,h,h+f);break}this._bufs[s].copy(e,l,h),l+=o,f-=o,h&&(h=0)}return e},r.prototype.toString=function(e,t,n){return this.slice(t,n).toString(e)},r.prototype.consume=function(e){for(;this._bufs.length;){if(!(e>this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},r.prototype.duplicate=function(){for(var e=0,t=new r;e<this._bufs.length;e++)t.append(this._bufs[e]);return t},r.prototype.destroy=function(){this._bufs.length=0,this.length=0,this.push(null)},function(){var e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};for(var t in e)!function(t){r.prototype[t]=function(n){return this.slice(n,n+e[t])[t](0)}}(t)}(),e.exports=r}).call(t,n(89).Buffer)},function(e,t,n){function r(e){this._levelup=e,this.batch=e.db.batch(),this.ops=[]}var i=n(133),o=n(103).WriteError,s=i.getOptions,a=i.dispatchError;r.prototype.put=function(e,t,n){n=s(this._levelup,n);var r=i.encodeKey(e,n),a=i.encodeValue(t,n);try{this.batch.put(r,a)}catch(c){throw new o(c);
}return this.ops.push({type:"put",key:r,value:a}),this},r.prototype.del=function(e,t){t=s(this._levelup,t);var n=i.encodeKey(e,t);try{this.batch.del(n)}catch(r){throw new o(r)}return this.ops.push({type:"del",key:n}),this},r.prototype.clear=function(){try{this.batch.clear()}catch(e){throw new o(e)}return this.ops=[],this},r.prototype.write=function(e){var t=this._levelup,n=this.ops;try{this.batch.write(function(r){return r?a(t,new o(r),e):(t.emit("batch",n),void(e&&e()))})}catch(r){throw new o(r)}},e.exports=r},function(e,t,n){(function(t){var r=(n(19).EventEmitter,t.nextTick,n(142)),i=n(152),o=n(144),s=n(153);e.exports=function(e,t){function n(){}function a(e){return function(t){return t=t||{},t=o(t),t.reverse?t.start=t.start||u:t.end=t.end||u,e.call(c,t)}}n.prototype=e;var c=new n;if(c.sublevel)return c;t=t||{};var u=t.sep=t.sep||"";c._options=t,s(c),c.sublevels={},c.sublevel=function(e,t){return c.sublevels[e]?c.sublevels[e]:new r(c,e,t||this._options)},c.methods={},c.prefix=function(e){return""+(e||"")},c.pre=function(e,t){return t||(t=e,e={max:u}),c.hooks.pre(e,t)},c.post=function(e,t){return t||(t=e,e={max:u}),c.hooks.post(e,t)},c.readStream=c.createReadStream=a(c.createReadStream),c.keyStream=c.createKeyStream=a(c.createKeyStream),c.valuesStream=c.createValueStream=a(c.createValueStream);var f=c.batch;return c.batch=function(e,t,n){return Array.isArray(e)?(e.forEach(function(e){e.prefix&&("function"==typeof e.prefix.prefix?e.key=e.prefix.prefix(e.key):"string"==typeof e.prefix&&(e.key=e.prefix+e.key))}),void f.call(c,e,t,n)):new i(c)},c}}).call(t,n(1))},function(e,t,n){function r(e,t,n){if("string"==typeof n&&(console.error("db.sublevel(name, seperator<string>) is depreciated"),console.error("use db.sublevel(name, {sep: separator})) if you must"),n={sep:n}),!(this instanceof r))return new r(e,t,n);if(!e)throw new Error("must provide db");if(!t)throw new Error("must provide prefix");n=n||{},n.sep=n.sep||"",this._parent=e,this._options=n,this.options=n,this._prefix=t,this._root=o(this),e.sublevels[t]=this,this.sublevels={},this.methods={};var i=this;this.hooks={pre:function(){return i.pre.apply(i,arguments)},post:function(){return i.post.apply(i,arguments)}}}function i(e,t){["valueEncoding","encoding","keyEncoding","reverse","values","keys","limit","fillCache"].forEach(function(n){t.hasOwnProperty(n)&&(e[n]=t[n])})}function o(e){return e._parent?o(e._parent):e}var s=n(19).EventEmitter,a=n(94).inherits,c=n(143),u=n(144),f=n(146),l=n(152);a(r,s);var h=r.prototype;h._key=function(e){var t=this._options.sep;return t+this._prefix+t+e},h._getOptsAndCb=function(e,t){return"function"==typeof e&&(t=e,e={}),{opts:f(e,this._options),cb:t}},h.sublevel=function(e,t){return this.sublevels[e]?this.sublevels[e]:new r(this,e,t||this._options)},h.put=function(e,t,n,r){var i=this._getOptsAndCb(n,r);this._root.put(this.prefix(e),t,i.opts,i.cb)},h.get=function(e,t,n){var r=this._getOptsAndCb(t,n);this._root.get(this.prefix(e),r.opts,r.cb)},h.del=function(e,t,n){var r=this._getOptsAndCb(t,n);this._root.del(this.prefix(e),r.opts,r.cb)},h.batch=function(e,t,n){if(!Array.isArray(e))return new l(this);var r=this,i=this._getOptsAndCb(t,n);e.forEach(function(e){"string"==typeof e.prefix?e.key=e.prefix+e.key:e.key=(e.prefix||r).prefix(e.key),e.prefix&&(e.prefix=null)}),this._root.batch(e,i.opts,i.cb)},h._getKeyEncoding=function(){return this.options.keyEncoding?this.options.keyEncoding:this._parent&&this._parent._getKeyEncoding?this._parent._getKeyEncoding():void 0},h._getValueEncoding=function(){return this.options.valueEncoding?this.options.valueEncoding:this._parent&&this._parent._getValueEncoding?this._parent._getValueEncoding():void 0},h.prefix=function(e){var t=this._options.sep;return this._parent.prefix()+t+this._prefix+t+(e||"")},h.keyStream=h.createKeyStream=function(e){return e=e||{},e.keys=!0,e.values=!1,this.createReadStream(e)},h.valueStream=h.createValueStream=function(e){return e=e||{},e.keys=!1,e.values=!0,e.keys=!1,this.createReadStream(e)},h.readStream=h.createReadStream=function(e){e=e||{};var t=o(this),n=this.prefix(),r=c.prefix(e,n);i(r,f(e,this._options));var s=t.createReadStream(r);if(r.values===!1){var a=s.read;if(a)s.read=function(e){var t=a.call(this,e);return t&&(t=t.substring(n.length)),t};else{var u=s.emit;s.emit=function(e,t){"data"===e?u.call(this,"data",t.substring(n.length)):u.call(this,e,t)}}return s}if(r.keys===!1)return s;var a=s.read;return a?s.read=function(e){var t=a.call(this,e);return t&&(t.key=t.key.substring(n.length)),t}:s.on("data",function(e){e.key=e.key.substring(n.length)}),s},h.writeStream=h.createWriteStream=function(){var e=o(this),t=this.prefix(),n=e.createWriteStream.apply(e,arguments),r=n.write,i=this._options.encoding,s=this._options.valueEncoding,a=this._options.keyEncoding,c=!i&&!s&&!a;return n.write=c?function(e){return e.key=t+e.key,r.call(n,e)}:function(e){return e.key=t+e.key,i&&"undefined"==typeof e.encoding&&(e.encoding=i),s&&"undefined"==typeof e.valueEncoding&&(e.valueEncoding=s),a&&"undefined"==typeof e.keyEncoding&&(e.keyEncoding=a),r.call(n,e)},n},h.approximateSize=function(){var e=o(db);return e.approximateSize.apply(e,arguments)},h.pre=function(e,t){t||(t=e,e=null),e=c.prefix(e,this.prefix(),this._options.sep);var n=o(this._parent),r=this.prefix();return n.hooks.pre(u(e),function(e,n,i){t({key:e.key.substring(r.length),value:e.value,type:e.type},function(e,t){n(e,e.prefix?t:t||r)},i)})},h.post=function(e,t){t||(t=e,e=null);var n=o(this._parent),r=this.prefix();return e=c.prefix(e,r,this._options.sep),n.hooks.post(u(e),function(e){t({key:e.key.substring(r.length),value:e.value,type:e.type})})};e.exports=r},function(e,t){var n=t.range=function(e){return null==e?{}:"string"==typeof n?{min:n,max:n+""}:e},r=(t.prefix=function(e,n,r){e=t.range(e);var i={};return r=r||"",e instanceof RegExp||"function"==typeof e?(i.min=n,i.max=n+r,i.inner=function(t){var r=t.substring(n.length);return e.test?e.test(r):e(r)}):"object"==typeof e&&(i.min=n+(e.min||e.start||""),i.max=n+(e.max||e.end||r||"~"),i.reverse=!!e.reverse),i},t.checker=function(e){return e||(e={}),"string"==typeof e?function(t){return 0==t.indexOf(e)}:e instanceof RegExp?function(t){return e.test(t)}:"object"==typeof e?function(t){var n=e.min||e.start,r=e.max||e.end;return t=String(t),(!n||t>=n)&&(!r||t<=r)&&(!e.inner||(e.inner.test?e.inner.test(t):e.inner(t)))}:"function"==typeof e?e:void 0});t.satisfies=function(e,t){return r(t)(e)}},function(e,t,n){var r=n(145);e.exports=function(e){e=r(e);var t=e.reverse,n=e.max||e.end,i=e.min||e.start,o=[i,n];return null!=i&&null!=n&&o.sort(),t&&(o=o.reverse()),e.start=o[0],e.end=o[1],delete e.min,delete e.max,e}},function(e,t,n){(function(t){"use strict";function n(e){return Object.prototype.toString.call(e)}function r(e,n,r,o){function s(e,r){if(null===e)return null;if(0==r)return e;var f,l;if("object"!=typeof e)return e;if(i.isArray(e))f=[];else if(i.isRegExp(e))f=new RegExp(e.source,i.getRegExpFlags(e)),e.lastIndex&&(f.lastIndex=e.lastIndex);else if(i.isDate(e))f=new Date(e.getTime());else{if(u&&t.isBuffer(e))return f=new t(e.length),e.copy(f),f;"undefined"==typeof o?(l=Object.getPrototypeOf(e),f=Object.create(l)):(f=Object.create(o),l=o)}if(n){var h=a.indexOf(e);if(h!=-1)return c[h];a.push(e),c.push(f)}for(var d in e){var p;l&&(p=Object.getOwnPropertyDescriptor(l,d)),p&&null==p.set||(f[d]=s(e[d],r-1))}return f}var a=[],c=[],u="undefined"!=typeof t;return"undefined"==typeof n&&(n=!0),"undefined"==typeof r&&(r=1/0),s(e,r)}var i={isArray:function(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"===n(e)},isDate:function(e){return"object"==typeof e&&"[object Date]"===n(e)},isRegExp:function(e){return"object"==typeof e&&"[object RegExp]"===n(e)},getRegExpFlags:function(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}};e.exports=r,r.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t}}).call(t,n(89).Buffer)},function(e,t,n){function r(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];if(o(n))for(var r=i(n),s=0;s<r.length;s++){var a=r[s];e[a]=n[a]}}return e}var i=n(147),o=n(151);e.exports=r},function(e,t,n){e.exports=Object.keys||n(148)},function(e,t,n){!function(){"use strict";var t,r=Object.prototype.hasOwnProperty,i=n(149),o=n(150),s=!{toString:null}.propertyIsEnumerable("toString"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];t=function(e){if(!i.object(e)&&!i.array(e))throw new TypeError("Object.keys called on a non-object");var t,n=[];for(t in e)r.call(e,t)&&n.push(t);return s&&o(a,function(t){r.call(e,t)&&n.push(t)}),n},e.exports=t}()},function(e,t){/**!
	 * is
	 * the definitive JavaScript type testing library
	 * 
	 * @copyright 2013 Enrico Marino
	 * @license MIT
	 */
var n=Object.prototype,r=n.hasOwnProperty,i=n.toString,o=function(e){return e!==e},s={"boolean":1,number:1,string:1,undefined:1},a=e.exports={};a.a=a.type=function(e,t){return typeof e===t},a.defined=function(e){return void 0!==e},a.empty=function(e){var t,n=i.call(e);if("[object Array]"===n||"[object Arguments]"===n)return 0===e.length;if("[object Object]"===n){for(t in e)if(r.call(e,t))return!1;return!0}return"[object String]"===n&&""===e},a.equal=function(e,t){var n,r=i.call(e);if(r!==i.call(t))return!1;if("[object Object]"===r){for(n in e)if(!a.equal(e[n],t[n]))return!1;return!0}if("[object Array]"===r){if(n=e.length,n!==t.length)return!1;for(;--n;)if(!a.equal(e[n],t[n]))return!1;return!0}return"[object Function]"===r?e.prototype===t.prototype:"[object Date]"===r?e.getTime()===t.getTime():e===t},a.hosted=function(e,t){var n=typeof t[e];return"object"===n?!!t[e]:!s[n]},a.instance=a["instanceof"]=function(e,t){return e instanceof t},a["null"]=function(e){return null===e},a.undefined=function(e){return void 0===e},a.arguments=function(e){var t="[object Arguments]"===i.call(e),n=!a.array(e)&&a.arraylike(e)&&a.object(e)&&a.fn(e.callee);return t||n},a.array=function(e){return"[object Array]"===i.call(e)},a.arguments.empty=function(e){return a.arguments(e)&&0===e.length},a.array.empty=function(e){return a.array(e)&&0===e.length},a.arraylike=function(e){return!!e&&!a["boolean"](e)&&r.call(e,"length")&&isFinite(e.length)&&a.number(e.length)&&e.length>=0},a["boolean"]=function(e){return"[object Boolean]"===i.call(e)},a["false"]=function(e){return a["boolean"](e)&&(e===!1||e.valueOf()===!1)},a["true"]=function(e){return a["boolean"](e)&&(e===!0||e.valueOf()===!0)},a.date=function(e){return"[object Date]"===i.call(e)},a.element=function(e){return void 0!==e&&"undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&1===e.nodeType},a.error=function(e){return"[object Error]"===i.call(e)},a.fn=a["function"]=function(e){var t="undefined"!=typeof window&&e===window.alert;return t||"[object Function]"===i.call(e)},a.number=function(e){return"[object Number]"===i.call(e)},a.infinite=function(e){return e===1/0||e===-(1/0)},a.decimal=function(e){return a.number(e)&&!o(e)&&!a.infinite(e)&&e%1!==0},a.divisibleBy=function(e,t){var n=a.infinite(e),r=a.infinite(t),i=a.number(e)&&!o(e)&&a.number(t)&&!o(t)&&0!==t;return n||r||i&&e%t===0},a["int"]=function(e){return a.number(e)&&!o(e)&&e%1===0},a.maximum=function(e,t){if(o(e))throw new TypeError("NaN is not a valid value");if(!a.arraylike(t))throw new TypeError("second argument must be array-like");for(var n=t.length;--n>=0;)if(e<t[n])return!1;return!0},a.minimum=function(e,t){if(o(e))throw new TypeError("NaN is not a valid value");if(!a.arraylike(t))throw new TypeError("second argument must be array-like");for(var n=t.length;--n>=0;)if(e>t[n])return!1;return!0},a.nan=function(e){return!a.number(e)||e!==e},a.even=function(e){return a.infinite(e)||a.number(e)&&e===e&&e%2===0},a.odd=function(e){return a.infinite(e)||a.number(e)&&e===e&&e%2!==0},a.ge=function(e,t){if(o(e)||o(t))throw new TypeError("NaN is not a valid value");return!a.infinite(e)&&!a.infinite(t)&&e>=t},a.gt=function(e,t){if(o(e)||o(t))throw new TypeError("NaN is not a valid value");return!a.infinite(e)&&!a.infinite(t)&&e>t},a.le=function(e,t){if(o(e)||o(t))throw new TypeError("NaN is not a valid value");return!a.infinite(e)&&!a.infinite(t)&&e<=t},a.lt=function(e,t){if(o(e)||o(t))throw new TypeError("NaN is not a valid value");return!a.infinite(e)&&!a.infinite(t)&&e<t},a.within=function(e,t,n){if(o(e)||o(t)||o(n))throw new TypeError("NaN is not a valid value");if(!a.number(e)||!a.number(t)||!a.number(n))throw new TypeError("all arguments must be numbers");var r=a.infinite(e)||a.infinite(t)||a.infinite(n);return r||e>=t&&e<=n},a.object=function(e){return e&&"[object Object]"===i.call(e)},a.hash=function(e){return a.object(e)&&e.constructor===Object&&!e.nodeType&&!e.setInterval},a.regexp=function(e){return"[object RegExp]"===i.call(e)},a.string=function(e){return"[object String]"===i.call(e)}},function(e,t){var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString;e.exports=function(e,t,i){if("[object Function]"!==r.call(t))throw new TypeError("iterator must be a function");var o=e.length;if(o===+o)for(var s=0;s<o;s++)t.call(i,e[s],s,e);else for(var a in e)n.call(e,a)&&t.call(i,e[a],a,e)}},function(e,t){function n(e){return null!==e&&("object"==typeof e||"function"==typeof e)}e.exports=n},function(e,t){function n(e,t,n,r){var i={type:e,key:t,value:n,options:r};return r&&r.prefix&&(i.prefix=r.prefix,delete r.prefix),this._operations.push(i),this}function r(e){this._operations=[],this._sdb=e,this.put=n.bind(this,"put"),this.del=n.bind(this,"del")}var i=r.prototype;i.clear=function(){this._operations=[]},i.write=function(e){this._sdb.batch(this._operations,e)},e.exports=r},function(e,t,n){var r=n(143);e.exports=function(e){function t(e){return e&&("string"==typeof e?e:"string"==typeof e.prefix?e.prefix:"function"==typeof e.prefix?e.prefix():"")}function n(e){if(e&&e._getKeyEncoding)return e._getKeyEncoding(e)}function i(e){if(e&&e._getValueEncoding)return e._getValueEncoding(e)}function o(e,t){return function(){var n=e.indexOf(t);return!!~n&&(e.splice(n,1),!0)}}function s(e){e&&e.type&&c.forEach(function(t){t.test(e.key)&&t.hook(e)})}function a(r,o,s,a){try{o.forEach(function p(e,r){u.forEach(function(s){if(s.test(String(e.key))){var a={add:function(e,a){if("undefined"==typeof e)return this;if(e===!1)return delete o[r];var c=t(e.prefix)||t(a)||s.prefix||"";if(c&&(e.prefix=c),e.key=c+e.key,s.safe&&s.test(String(e.key)))throw new Error("prehook cannot insert into own range");var u=e.keyEncoding||n(e.prefix),f=e.valueEncoding||i(e.prefix);return u&&(e.keyEncoding=u),f&&(e.valueEncoding=f),o.push(e),p(e,o.length-1),this},put:function(e,t){return"object"==typeof e&&(e.type="put"),this.add(e,t)},del:function(e,t){return"object"==typeof e&&(e.type="del"),this.add(e,t)},veto:function(){return this.add(!1)}};s.hook.call(a,e,a.add,o)}})})}catch(c){return(a||s)(c)}if(o=o.filter(function(e){return e&&e.type}),1==o.length&&!r){var d=o[0];return"put"==d.type?f.call(e,d.key,d.value,s,a):l.call(e,d.key,s,a)}return h.call(e,o,s,a)}if(!e.hooks){var c=[],u=[];e.hooks={post:function(e,t){t||(t=e,e="");var n={test:r.checker(e),hook:t};return c.push(n),o(c,n)},pre:function(e,t){t||(t=e,e="");var n={test:r.checker(e),hook:t,safe:!1!==e.safe};return u.push(n),o(u,n)},posthooks:c,prehooks:u},e.on("put",function(e,t){s({type:"put",key:e,value:t})}),e.on("del",function(e,t){s({type:"del",key:e,value:t})}),e.on("batch",function(e){e.forEach(s)});var f=e.put,l=e.del,h=e.batch;e.put=function(e,t,n,r){var i=[{key:e,value:t,type:"put"}];return a(!1,i,n,r)},e.del=function(e,t,n){var r=[{key:e,type:"del"}];return a(!1,r,t,n)},e.batch=function(e,t,n){return a(!0,e,t,n)}}}},function(e,t,n){function r(e,t,n){n(null,e)}function i(e){return function(t,n,i){return"function"==typeof t&&(i=n,n=t,t={}),"function"!=typeof n&&(n=r),"function"!=typeof i&&(i=null),e(t,n,i)}}var o=n(155),s=n(94).inherits,a=n(163);e.exports=i(function(e,t,n){var r=new o(e);return r._transform=t,n&&(r._flush=n),r}),e.exports.ctor=i(function(e,t,n){function r(t){return this instanceof r?(this.options=a(e,t),void o.call(this,this.options)):new r(t)}return s(r,o),r.prototype._transform=t,n&&(r.prototype._flush=n),r}),e.exports.obj=i(function(e,t,n){var r=new o(a({objectMode:!0},e));return r._transform=t,n&&(r._flush=n),r})},function(e,t,n){e.exports=n(156)},function(e,t,n){function r(e,t){this.afterTransform=function(e,n){return i(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),i&&i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);a.call(this,e);var t=(this._transformState=new r(e,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(e){s(t,e)}):s(t)})}function s(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=(e._readableState,e._transformState);if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}e.exports=o;var a=n(157),c=n(158);c.inherits=n(16),c.inherits(o,a),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},function(e,t,n){(function(t){function r(e){return this instanceof r?(c.call(this,e),u.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(e)}function i(){this.allowHalfOpen||this._writableState.ended||t.nextTick(this.end.bind(this))}function o(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}e.exports=r;var s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},a=n(158);a.inherits=n(16);var c=n(159),u=n(162);a.inherits(r,c),o(s(u.prototype),function(e){r.prototype[e]||(r.prototype[e]=u.prototype[e])})}).call(t,n(1))},function(e,t,n){(function(e){function n(e){return Array.isArray?Array.isArray(e):"[object Array]"===g(e)}function r(e){return"boolean"==typeof e}function i(e){return null===e}function o(e){return null==e}function s(e){return"number"==typeof e}function a(e){return"string"==typeof e}function c(e){return"symbol"==typeof e}function u(e){return void 0===e}function f(e){return"[object RegExp]"===g(e)}function l(e){return"object"==typeof e&&null!==e}function h(e){return"[object Date]"===g(e)}function d(e){return"[object Error]"===g(e)||e instanceof Error}function p(e){return"function"==typeof e}function v(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function g(e){return Object.prototype.toString.call(e)}t.isArray=n,t.isBoolean=r,t.isNull=i,t.isNullOrUndefined=o,t.isNumber=s,t.isString=a,t.isSymbol=c,t.isUndefined=u,t.isRegExp=f,t.isObject=l,t.isDate=h,t.isError=d,t.isFunction=p,t.isPrimitive=v,t.isBuffer=e.isBuffer}).call(t,n(89).Buffer)},function(e,t,n){(function(t){function r(e,t){e=e||{};var r=e.highWaterMark;this.highWaterMark=r||0===r?r:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(O||(O=n(161).StringDecoder),this.decoder=new O(e.encoding),this.encoding=e.encoding)}function i(e){return this instanceof i?(this._readableState=new r(e,this),this.readable=!0,void A.call(this)):new i(e)}function o(e,t,n,r,i){var o=u(t,n);if(o)e.emit("error",o);else if(null===n||void 0===n)t.reading=!1,t.ended||f(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var a=new Error("stream.unshift() after end event");e.emit("error",a)}else!t.decoder||i||r||(n=t.decoder.write(n)),t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):(t.reading=!1,t.buffer.push(n)),t.needReadable&&l(e),d(e,t);else i||(t.reading=!1);return s(t)}function s(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function a(e){if(e>=R)e=R;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function c(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=a(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function u(e,t){var n=null;return x.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function f(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.length>0?l(e):_(e)}function l(e){var n=e._readableState;n.needReadable=!1,n.emittedReadable||(n.emittedReadable=!0,n.sync?t.nextTick(function(){h(e)}):h(e))}function h(e){e.emit("readable")}function d(e,n){n.readingMore||(n.readingMore=!0,t.nextTick(function(){p(e,n)}))}function p(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function v(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&g(e)}}function g(e){function t(e,t,i){var o=e.write(n);!1===o&&r.awaitDrain++}var n,r=e._readableState;for(r.awaitDrain=0;r.pipesCount&&null!==(n=e.read());)if(1===r.pipesCount?t(r.pipes,0,null):w(r.pipes,t),e.emit("data",n),r.awaitDrain>0)return;return 0===r.pipesCount?(r.flowing=!1,void(S.listenerCount(e,"data")>0&&m(e))):void(r.ranOut=!0)}function y(){this._readableState.ranOut&&(this._readableState.ranOut=!1,g(this))}function m(e,n){var r=e._readableState;if(r.flowing)throw new Error("Cannot switch to old mode now.");var i=n||!1,o=!1;e.readable=!0,e.pipe=A.prototype.pipe,e.on=e.addListener=A.prototype.on,e.on("readable",function(){o=!0;for(var t;!i&&null!==(t=e.read());)e.emit("data",t);null===t&&(o=!1,e._readableState.needReadable=!0)}),e.pause=function(){i=!0,this.emit("pause")},e.resume=function(){i=!1,o?t.nextTick(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function b(e,t){var n,r=t.buffer,i=t.length,o=!!t.decoder,s=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(s)n=r.shift();else if(!e||e>=i)n=o?r.join(""):x.concat(r,i),r.length=0;else if(e<r[0].length){var a=r[0];n=a.slice(0,e),r[0]=a.slice(e)}else if(e===r[0].length)n=r.shift();else{n=o?"":new x(e);for(var c=0,u=0,f=r.length;u<f&&c<e;u++){var a=r[0],l=Math.min(e-c,a.length);o?n+=a.slice(0,l):a.copy(n,c,0,l),l<a.length?r[0]=a.slice(l):r.shift(),c+=l}}return n}function _(e){var n=e._readableState;if(n.length>0)throw new Error("endReadable called on non-empty stream");!n.endEmitted&&n.calledRead&&(n.ended=!0,t.nextTick(function(){n.endEmitted||0!==n.length||(n.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function w(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function E(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}e.exports=i;var k=n(160),x=n(89).Buffer;i.ReadableState=r;var S=n(19).EventEmitter;S.listenerCount||(S.listenerCount=function(e,t){return e.listeners(t).length});var A=n(108),T=n(158);T.inherits=n(16);var O;T.inherits(i,A),i.prototype.push=function(e,t){var n=this._readableState;return"string"!=typeof e||n.objectMode||(t=t||n.defaultEncoding,t!==n.encoding&&(e=new x(e,t),t="")),o(this,n,e,t,!1)},i.prototype.unshift=function(e){var t=this._readableState;return o(this,t,e,"",!0)},i.prototype.setEncoding=function(e){O||(O=n(161).StringDecoder),this._readableState.decoder=new O(e),this._readableState.encoding=e};var R=8388608;i.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var n,r=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return l(this),null;if(e=c(e,t),0===e&&t.ended)return n=null,t.length>0&&t.decoder&&(n=b(e,t),t.length-=n.length),0===t.length&&_(this),n;var i=t.needReadable;return t.length-e<=t.highWaterMark&&(i=!0),(t.ended||t.reading)&&(i=!1),i&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=c(r,t)),n=e>0?b(e,t):null,null===n&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&_(this),n},i.prototype._read=function(e){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(e,n){function r(e){e===f&&o()}function i(){e.end()}function o(){e.removeListener("close",a),e.removeListener("finish",c),e.removeListener("drain",p),e.removeListener("error",s),e.removeListener("unpipe",r),f.removeListener("end",i),f.removeListener("end",o),e._writableState&&!e._writableState.needDrain||p()}function s(t){u(),e.removeListener("error",s),0===S.listenerCount(e,"error")&&e.emit("error",t)}function a(){e.removeListener("finish",c),u()}function c(){e.removeListener("close",a),u()}function u(){f.unpipe(e)}var f=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=e;break;case 1:l.pipes=[l.pipes,e];break;default:l.pipes.push(e)}l.pipesCount+=1;var h=(!n||n.end!==!1)&&e!==t.stdout&&e!==t.stderr,d=h?i:o;l.endEmitted?t.nextTick(d):f.once("end",d),e.on("unpipe",r);var p=v(f);return e.on("drain",p),e._events&&e._events.error?k(e._events.error)?e._events.error.unshift(s):e._events.error=[s,e._events.error]:e.on("error",s),e.once("close",a),e.once("finish",c),e.emit("pipe",f),l.flowing||(this.on("readable",y),l.flowing=!0,t.nextTick(function(){g(f)})),e},i.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",y),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",y),t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var i=E(t.pipes,e);return i===-1?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},i.prototype.on=function(e,t){var n=A.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||m(this),"readable"===e&&this.readable){var r=this._readableState;r.readableListening||(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading?r.length&&l(this,r):this.read(0))}return n},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){m(this),this.read(0),this.emit("resume")},i.prototype.pause=function(){m(this,!0),this.emit("pause")},i.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)){var o=r.push(i);o||(n=!0,e.pause())}});for(var i in e)"function"==typeof e[i]&&"undefined"==typeof this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return w(o,function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){n&&(n=!1,e.resume())},r},i._fromList=b}).call(t,n(1))},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){function r(e){if(e&&!c(e))throw new Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function s(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var a=n(89).Buffer,c=a.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},u=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(!(r>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&r<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},u.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},u.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},function(e,t,n){(function(t){function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n}function i(e,t){e=e||{};var n=e.highWaterMark;this.highWaterMark=n||0===n?n:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=e.decodeStrings===!1;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){d(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function o(e){var t=n(157);return this instanceof o||this instanceof t?(this._writableState=new i(e,this),this.writable=!0,void E.call(this)):new o(e)}function s(e,n,r){var i=new Error("write after end");e.emit("error",i),t.nextTick(function(){r(i)})}function a(e,n,r,i){var o=!0;if(!_.isBuffer(r)&&"string"!=typeof r&&null!==r&&void 0!==r&&!n.objectMode){var s=new TypeError("Invalid non-string/buffer chunk");e.emit("error",s),t.nextTick(function(){i(s)}),o=!1}return o}function c(e,t,n){return e.objectMode||e.decodeStrings===!1||"string"!=typeof t||(t=new _(t,n)),t}function u(e,t,n,i,o){n=c(t,n,i),_.isBuffer(n)&&(i="buffer");var s=t.objectMode?1:n.length;t.length+=s;var a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing?t.buffer.push(new r(n,i,o)):f(e,t,s,n,i,o),a}function f(e,t,n,r,i,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,e._write(r,i,t.onwrite),t.sync=!1}function l(e,n,r,i,o){r?t.nextTick(function(){o(i)}):o(i),e._writableState.errorEmitted=!0,e.emit("error",i)}function h(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function d(e,n){var r=e._writableState,i=r.sync,o=r.writecb;if(h(r),n)l(e,r,i,n,o);else{var s=y(e,r);s||r.bufferProcessing||!r.buffer.length||g(e,r),i?t.nextTick(function(){p(e,r,s,o)}):p(e,r,s,o)}}function p(e,t,n,r){n||v(e,t),r(),n&&m(e,t)}function v(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function g(e,t){t.bufferProcessing=!0;for(var n=0;n<t.buffer.length;n++){var r=t.buffer[n],i=r.chunk,o=r.encoding,s=r.callback,a=t.objectMode?1:i.length;if(f(e,t,a,i,o,s),t.writing){n++;break}}t.bufferProcessing=!1,n<t.buffer.length?t.buffer=t.buffer.slice(n):t.buffer.length=0}function y(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function m(e,t){var n=y(e,t);return n&&(t.finished=!0,e.emit("finish")),n}function b(e,n,r){n.ending=!0,m(e,n),r&&(n.finished?t.nextTick(r):e.once("finish",r)),n.ended=!0}e.exports=o;var _=n(89).Buffer;o.WritableState=i;var w=n(158);w.inherits=n(16);var E=n(108);w.inherits(o,E),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(e,t,n){var r=this._writableState,i=!1;return"function"==typeof t&&(n=t,t=null),_.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=function(){}),r.ended?s(this,r,n):a(this,r,e,n)&&(i=u(this,r,e,t,n)),i},o.prototype._write=function(e,t,n){n(new Error("not implemented"))},o.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),"undefined"!=typeof e&&null!==e&&this.write(e,t),r.ending||r.finished||b(this,r,n)}}).call(t,n(1))},function(e,t,n){function r(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];if(o(n))for(var r=i(n),s=0;s<r.length;s++){var a=r[s];e[a]=n[a]}}return e}var i=n(164),o=n(168);e.exports=r},function(e,t,n){e.exports=Object.keys||n(165)},function(e,t,n){!function(){"use strict";var t,r=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=n(166),s=n(167),a=!{toString:null}.propertyIsEnumerable("toString"),c=function(){}.propertyIsEnumerable("prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];t=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===i.call(e),f=s(e),l=[];if(!t&&!n&&!f)throw new TypeError("Object.keys called on a non-object");if(f)o(e,function(e){l.push(e)});else{var h,d=c&&n;for(h in e)d&&"prototype"===h||!r.call(e,h)||l.push(h)}if(a){var p=e.constructor,v=p&&p.prototype===e;o(u,function(t){v&&"constructor"===t||!r.call(e,t)||l.push(t)})}return l},e.exports=t}()},function(e,t){var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,i=function(e){var t="function"==typeof e&&!(e instanceof RegExp)||"[object Function]"===r.call(e);return t||"undefined"==typeof window||(t=e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt),t};e.exports=function(e,t){if(!i(t))throw new TypeError("iterator must be a function");var r,o,s="string"==typeof e,a=e.length,c=arguments.length>2?arguments[2]:null;if(a===+a)for(r=0;r<a;r++)null===c?t(s?e.charAt(r):e[r],r,e):t.call(c,s?e.charAt(r):e[r],r,e);else for(o in e)n.call(e,o)&&(null===c?t(e[o],o,e):t.call(c,e[o],o,e))}},function(e,t){var n=Object.prototype.toString;e.exports=function r(e){var t=n.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===n.call(e.callee)),r}},function(e,t){function n(e){return null!==e&&("object"==typeof e||"function"==typeof e)}e.exports=n},function(e,t){},function(e,t,n){(function(e){"use strict";t.toSublevel=function(t,n,r){e.nextTick(function(){r()})},t.localAndMetaStores=function(t,n,r){e.nextTick(function(){r()})}}).call(t,n(1))},function(e,t){"use strict";function n(e){if(this._capacity=o(e),this._length=0,this._front=0,this._makeCapacity(),s(e)){for(var t=e.length,n=0;n<t;++n)this[n]=e[n];this._length=t}}function r(e,t,n,r,i){for(var o=0;o<i;++o)n[o+r]=e[o+t]}function i(e){return e>>>=0,e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e+1}function o(e){if("number"!=typeof e){if(!s(e))return 16;e=e.length}return i(Math.min(Math.max(16,e),1073741824))}n.prototype.toArray=function(){for(var e=this._length,t=new Array(e),n=this._front,r=this._capacity,i=0;i<e;++i)t[i]=this[n+i&r-1];return t},n.prototype.push=function(e){var t=arguments.length,n=this._length;if(t>1){var r=this._capacity;if(n+t>r){for(var i=0;i<t;++i){this._checkCapacity(n+1);var o=this._front+n&this._capacity-1;this[o]=arguments[i],n++,this._length=n}return n}for(var o=this._front,i=0;i<t;++i)this[o+n&r-1]=arguments[i],o++;return this._length=n+t,n+t}if(0===t)return n;this._checkCapacity(n+1);var i=this._front+n&this._capacity-1;return this[i]=e,this._length=n+1,n+1},n.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,n=this[t];return this[t]=void 0,this._length=e-1,n}},n.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,n=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,n}},n.prototype.unshift=function(e){var t=this._length,n=arguments.length;if(n>1){var r=this._capacity;if(t+n>r){for(var i=n-1;i>=0;i--){this._checkCapacity(t+1);var r=this._capacity,o=(this._front-1&r-1^r)-r;this[o]=arguments[i],t++,this._length=t,this._front=o}return t}for(var s=this._front,i=n-1;i>=0;i--){var o=(s-1&r-1^r)-r;this[o]=arguments[i],s=o}return this._front=s,this._length=t+n,t+n}if(0===n)return t;this._checkCapacity(t+1);var r=this._capacity,i=(this._front-1&r-1^r)-r;return this[i]=e,this._length=t+1,this._front=i,t+1},n.prototype.peekBack=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1;return this[t]}},n.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},n.prototype.get=function(e){var t=e;if(t===(0|t)){var n=this._length;if(t<0&&(t+=n),!(t<0||t>=n))return this[this._front+t&this._capacity-1]}},n.prototype.isEmpty=function(){return 0===this._length},n.prototype.clear=function(){this._length=0,this._front=0,this._makeCapacity()},n.prototype.toString=function(){return this.toArray().toString()},n.prototype.valueOf=n.prototype.toString,n.prototype.removeFront=n.prototype.shift,n.prototype.removeBack=n.prototype.pop,n.prototype.insertFront=n.prototype.unshift,n.prototype.insertBack=n.prototype.push,n.prototype.enqueue=n.prototype.push,n.prototype.dequeue=n.prototype.shift,n.prototype.toJSON=n.prototype.toArray,Object.defineProperty(n.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),n.prototype._makeCapacity=function(){for(var e=this._capacity,t=0;t<e;++t)this[t]=void 0},n.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(o(1.5*this._capacity+16))},n.prototype._resizeTo=function(e){var t=this._front,n=this._capacity,i=new Array(n),o=this._length;if(r(this,0,i,0,n),this._capacity=e,this._makeCapacity(),this._front=0,t+o<=n)r(i,t,this,0,o);else{var s=o-(t+o&n-1);r(i,t,this,0,s),r(i,0,this,s,o-s)}};var s=Array.isArray;e.exports=n},function(e,t,n){(function(t){"use strict";function r(e,t){var n=t.prefix(),r=e._cache,i=r.get(n);return i||(i=new o.Map,r.set(n,i)),i}function i(){this._batch=[],this._cache=new o.Map}var o=n(7);i.prototype.get=function(e,n,i){var o=r(this,e),s=o.get(n);return s?t.nextTick(function(){i(null,s)}):null===s?t.nextTick(function(){i({name:"NotFoundError"})}):void e.get(n,function(e,t){return e?("NotFoundError"===e.name&&o.set(n,null),i(e)):(o.set(n,t),void i(null,t))})},i.prototype.batch=function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t],o=r(this,i.prefix);"put"===i.type?o.set(i.key,i.value):o.set(i.key,null)}this._batch=this._batch.concat(e)},i.prototype.execute=function(e,t){for(var n=new o.Set,r=[],i=this._batch.length-1;i>=0;i--){var s=this._batch[i],a=s.prefix.prefix()+""+s.key;n.has(a)||(n.add(a),r.push(s))}e.batch(r,t)},e.exports=i}).call(t,n(1))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(174),o=r(i),s=n(180),a=r(s),c={apiEndpoint:null,apiKey:null,appId:null,UDID:null,authenticationToken:null,tokenUpdateCallback:function(e){}};c.call=function(e,t){var n=this,r=arguments.length<=2||void 0===arguments[2]?function(){}:arguments[2],i=arguments[3];if(!this.apiEndpoint)return r(new Error("No API endpoint set - run Telepat.configure or Telepat.connect first"),null);
var s;s="get"===i?o["default"].get(this.apiEndpoint+e+"?"+t):"delete"===i?o["default"].del(this.apiEndpoint+e):o["default"].post(this.apiEndpoint+e),"get"!==i&&s.send(t),s.set("Content-Type","application/json").set("X-BLGREQ-SIGN",(0,a["default"])(this.apiKey)).set("X-BLGREQ-APPID",this.appId).set("X-BLGREQ-UDID",this.UDID||"TP_EMPTY_UDID"),this.authenticationToken&&s.set("Authorization","Bearer "+this.authenticationToken),s.end(function(o,s){n.needsTokenUpdate(s)?n.updateToken(function(o,s){o?r(o,null):n.call(e,t,r,i)}):r(o,s)})},c.needsTokenUpdate=function(e){return this.authenticationToken&&(401===e.status||500===e.status&&"002"===e.body.code)},c.updateToken=function(e){var t=this;this.get("user/refresh_token","",function(n,r){n?e(n,null):(t.authenticationToken=r.body.content.token,t.tokenUpdateCallback(t.authenticationToken),e(null,r))})},c.get=function(e,t,n){return this.call(e,t,n,"get")},c.del=function(e,t,n){return this.call(e,t,n,"delete")},t["default"]=c,e.exports=t["default"]},function(e,t,n){function r(){}function i(e){var t={}.toString.call(e);switch(t){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function o(e){if(!b(e))return e;var t=[];for(var n in e)null!=e[n]&&s(t,n,e[n]);return t.join("&")}function s(e,t,n){return Array.isArray(n)?n.forEach(function(n){s(e,t,n)}):void e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}function a(e){for(var t,n,r={},i=e.split("&"),o=0,s=i.length;o<s;++o)n=i[o],t=n.split("="),r[decodeURIComponent(t[0])]=decodeURIComponent(t[1]);return r}function c(e){var t,n,r,i,o=e.split(/\r?\n/),s={};o.pop();for(var a=0,c=o.length;a<c;++a)n=o[a],t=n.indexOf(":"),r=n.slice(0,t).toLowerCase(),i=w(n.slice(t+1)),s[r]=i;return s}function u(e){return/[\/+]json\b/.test(e)}function f(e){return e.split(/ *; */).shift()}function l(e){return y(e.split(/ *; */),function(e,t){var n=t.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(e[r]=i),e},{})}function h(e,t){t=t||{},this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this.setStatusProperties(this.xhr.status),this.header=this.headers=c(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text?this.text:this.xhr.response):null}function d(e,t){var n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new h(n)}catch(r){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=r,e.rawResponse=n.xhr&&n.xhr.responseText?n.xhr.responseText:null,e.statusCode=n.xhr&&n.xhr.status?n.xhr.status:null,n.callback(e)}if(n.emit("response",t),e)return n.callback(e,t);if(t.status>=200&&t.status<300)return n.callback(e,t);var i=new Error(t.statusText||"Unsuccessful HTTP response");i.original=e,i.response=t,i.status=t.status,n.callback(i,t)})}function p(e,t){var n=_("DELETE",e);return t&&n.end(t),n}var v,g=n(175),y=n(176),m=n(177),b=n(178);v="undefined"!=typeof window?window:"undefined"!=typeof self?self:this;var _=e.exports=n(179).bind(null,d);_.getXHR=function(){if(!(!v.XMLHttpRequest||v.location&&"file:"==v.location.protocol&&v.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1};var w="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};_.serializeObject=o,_.parseString=a,_.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},_.serialize={"application/x-www-form-urlencoded":o,"application/json":JSON.stringify},_.parse={"application/x-www-form-urlencoded":a,"application/json":JSON.parse},h.prototype.get=function(e){return this.header[e.toLowerCase()]},h.prototype.setHeaderProperties=function(e){var t=this.header["content-type"]||"";this.type=f(t);var n=l(t);for(var r in n)this[r]=n[r]},h.prototype.parseBody=function(e){var t=_.parse[this.type];return!t&&u(this.type)&&(t=_.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null},h.prototype.setStatusProperties=function(e){1223===e&&(e=204);var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.notFound=404==e,this.forbidden=403==e},h.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,r="cannot "+t+" "+n+" ("+this.status+")",i=new Error(r);return i.status=this.status,i.method=t,i.url=n,i},_.Response=h,g(d.prototype);for(var E in m)d.prototype[E]=m[E];d.prototype.abort=function(){if(!this.aborted)return this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this},d.prototype.type=function(e){return this.set("Content-Type",_.types[e]||e),this},d.prototype.responseType=function(e){return this._responseType=e,this},d.prototype.accept=function(e){return this.set("Accept",_.types[e]||e),this},d.prototype.auth=function(e,t,n){switch(n||(n={type:"basic"}),n.type){case"basic":var r=btoa(e+":"+t);this.set("Authorization","Basic "+r);break;case"auto":this.username=e,this.password=t}return this},d.prototype.query=function(e){return"string"!=typeof e&&(e=o(e)),e&&this._query.push(e),this},d.prototype.attach=function(e,t,n){return this._getFormData().append(e,t,n||t.name),this},d.prototype._getFormData=function(){return this._formData||(this._formData=new v.FormData),this._formData},d.prototype.send=function(e){var t=b(e),n=this._header["content-type"];if(t&&b(this._data))for(var r in e)this._data[r]=e[r];else"string"==typeof e?(n||this.type("form"),n=this._header["content-type"],"application/x-www-form-urlencoded"==n?this._data=this._data?this._data+"&"+e:e:this._data=(this._data||"")+e):this._data=e;return!t||i(e)?this:(n||this.type("json"),this)},h.prototype.parse=function(e){return v.console&&console.warn("Client-side parse() method has been renamed to serialize(). This method is not compatible with superagent v2.0"),this.serialize(e),this},h.prototype.serialize=function(e){return this._parser=e,this},d.prototype.callback=function(e,t){var n=this._callback;this.clearTimeout(),n(e,t)},d.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},d.prototype.timeoutError=function(){var e=this._timeout,t=new Error("timeout of "+e+"ms exceeded");t.timeout=e,this.callback(t)},d.prototype.withCredentials=function(){return this._withCredentials=!0,this},d.prototype.end=function(e){var t=this,n=this.xhr=_.getXHR(),o=this._query.join("&"),s=this._timeout,a=this._formData||this._data;this._callback=e||r,n.onreadystatechange=function(){if(4==n.readyState){var e;try{e=n.status}catch(r){e=0}if(0==e){if(t.timedout)return t.timeoutError();if(t.aborted)return;return t.crossDomainError()}t.emit("end")}};var c=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),e.direction="download",t.emit("progress",e)};this.hasListeners("progress")&&(n.onprogress=c);try{n.upload&&this.hasListeners("progress")&&(n.upload.onprogress=c)}catch(f){}if(s&&!this._timer&&(this._timer=setTimeout(function(){t.timedout=!0,t.abort()},s)),o&&(o=_.serializeObject(o),this.url+=~this.url.indexOf("?")?"&"+o:"?"+o),this.username&&this.password?n.open(this.method,this.url,!0,this.username,this.password):n.open(this.method,this.url,!0),this._withCredentials&&(n.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof a&&!i(a)){var l=this._header["content-type"],h=this._parser||_.serialize[l?l.split(";")[0]:""];!h&&u(l)&&(h=_.serialize["application/json"]),h&&(a=h(a))}for(var d in this.header)null!=this.header[d]&&n.setRequestHeader(d,this.header[d]);return this._responseType&&(n.responseType=this._responseType),this.emit("request",this),n.send("undefined"!=typeof a?a:null),this},_.Request=d,_.get=function(e,t,n){var r=_("GET",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},_.head=function(e,t,n){var r=_("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},_.del=p,_["delete"]=p,_.patch=function(e,t,n){var r=_("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},_.post=function(e,t,n){var r=_("POST",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},_.put=function(e,t,n){var r=_("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}},function(e,t,n){function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){e.exports=function(e,t,n){for(var r=0,i=e.length,o=3==arguments.length?n:e[r++];r<i;)o=t.call(null,o,e[r],++r,e);return o}},function(e,t,n){var r=n(178);t.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},t.parse=function(e){return this._parser=e,this},t.timeout=function(e){return this._timeout=e,this},t.then=function(e,t){return this.end(function(n,r){n?t(n):e(r)})},t.use=function(e){return e(this),this},t.get=function(e){return this._header[e.toLowerCase()]},t.getHeader=t.get,t.set=function(e,t){if(r(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},t.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},t.field=function(e,t){return this._getFormData().append(e,t),this}},function(e,t){function n(e){return null!=e&&"object"==typeof e}e.exports=n},function(e,t){function n(e,t,n){return"function"==typeof n?new e("GET",t).end(n):2==arguments.length?new e("GET",t):new e(t,n)}e.exports=n},function(e,t,n){!function(r,i){e.exports=t=i(n(181))}(this,function(e){return function(t){var n=e,r=n.lib,i=r.WordArray,o=r.Hasher,s=n.algo,a=[],c=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)e(r)&&(i<8&&(a[i]=n(t.pow(r,.5))),c[i]=n(t.pow(r,1/3)),i++),r++}();var u=[],f=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],f=n[5],l=n[6],h=n[7],d=0;d<64;d++){if(d<16)u[d]=0|e[t+d];else{var p=u[d-15],v=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,g=u[d-2],y=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;u[d]=v+u[d-7]+y+u[d-16]}var m=a&f^~a&l,b=r&i^r&o^i&o,_=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),w=(a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25),E=h+w+m+c[d]+u[d],k=_+b;h=l,l=f,f=a,a=s+E|0,s=o,o=i,i=r,r=E+k|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+f|0,n[6]=n[6]+l|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[(i+64>>>9<<4)+14]=t.floor(r/4294967296),n[(i+64>>>9<<4)+15]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=o._createHelper(f),n.HmacSHA256=o._createHmacHelper(f)}(Math),e.SHA256})},function(e,t,n){!function(n,r){e.exports=t=r()}(this,function(){var e=e||function(e,t){var n={},r=n.lib={},i=r.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=r.WordArray=i.extend({init:function(e,n){e=this.words=e||[],n!=t?this.sigBytes=n:this.sigBytes=4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=s<<24-(r+o)%4*8}else for(var o=0;o<i;o+=4)t[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],i=function(t){var t=t,n=987654321,r=4294967295;return function(){n=36969*(65535&n)+(n>>16)&r,t=18e3*(65535&t)+(t>>16)&r;var i=(n<<16)+t&r;return i/=4294967296,i+=.5,i*(e.random()>.5?1:-1)}},s=0;s<t;s+=4){var a=i(4294967296*(n||e.random()));n=987654071*a(),r.push(4294967296*a()|0)}return new o.init(r,t)}}),s=n.enc={},a=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(n,t/2)}},c=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(n,t)}},u=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,s=this.blockSize,a=4*s,c=i/a;c=t?e.ceil(c):e.max((0|c)-this._minBufferSize,0);var u=c*s,f=e.min(4*u,i);if(u){for(var l=0;l<u;l+=s)this._doProcessBlock(r,l);var h=r.splice(0,u);n.sigBytes-=f}return new o.init(h,f)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),l=(r.Hasher=f.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new l.HMAC.init(e,n).finalize(t)}}}),n.algo={});return n}(Math);return e})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(183),o=r(i),s=o["default"].methodFactory;o["default"].methodFactory=function(e,t){var n=s(e,t);return function(e){n("Telepat: "+e)}},o["default"].setLevel("warn"),t["default"]=o["default"],e.exports=t["default"]},function(e,t,n){var r,i;!function(o,s){"use strict";r=s,i="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==i&&(e.exports=i))}(this,function(){"use strict";function e(e){return typeof console!==a&&(void 0!==console[e]?t(console,e):void 0!==console.log?t(console,"log"):s)}function t(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(r){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function n(e,t,n){return function(){typeof console!==a&&(r.call(this,t,n),this[e].apply(this,arguments))}}function r(e,t){for(var n=0;n<c.length;n++){var r=c[n];this[r]=n<e?s:this.methodFactory(r,e,t)}}function i(t,r,i){return e(t)||n.apply(this,arguments)}function o(e,t,n){function o(e){var t=(c[e]||"silent").toUpperCase();try{return void(window.localStorage[l]=t)}catch(n){}try{window.document.cookie=encodeURIComponent(l)+"="+t+";"}catch(n){}}function s(){var e;try{e=window.localStorage[l]}catch(t){}if(typeof e===a)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(l)+"=");r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(t){}return void 0===f.levels[e]&&(e=void 0),e}var u,f=this,l="loglevel";e&&(l+=":"+e),f.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},f.methodFactory=n||i,f.getLevel=function(){return u},f.setLevel=function(t,n){if("string"==typeof t&&void 0!==f.levels[t.toUpperCase()]&&(t=f.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=f.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(u=t,n!==!1&&o(t),r.call(f,t,e),typeof console===a&&t<f.levels.SILENT)return"No console available for logging"},f.setDefaultLevel=function(e){s()||f.setLevel(e,!1)},f.enableAll=function(e){f.setLevel(f.levels.TRACE,e)},f.disableAll=function(e){f.setLevel(f.levels.SILENT,e)};var h=s();null==h&&(h=null==t?"WARN":t),f.setLevel(h,!1)}var s=function(){},a="undefined",c=["trace","debug","info","warn","error"],u=new o,f={};u.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=f[e];return t||(t=f[e]=new o(e,u.getLevel(),u.methodFactory)),t};var l=typeof window!==a?window.log:void 0;return u.noConflict=function(){return typeof window!==a&&window.log===u&&(window.log=l),u},u})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return s["default"].error(e),new Error(e)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var o=n(182),s=r(o);e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(182),c=r(a),u=function(){function e(){i(this,e),this.eventFunctions={}}return s(e,[{key:"on",value:function(e,t){var n=Date.now();return"object"!==o(this.eventFunctions[e])&&(this.eventFunctions[e]={}),this.eventFunctions[e][n]=t,n}},{key:"removeCallback",value:function(e,t){delete this.eventFunctions[e][t]}},{key:"emit",value:function(e){c["default"].debug("Emitting "+arguments[0]+" event");var t=Array.prototype.slice.call(arguments);if(t.shift(),"undefined"!=typeof this.eventFunctions[arguments[0]]){var n=this.eventFunctions[arguments[0]];for(var r in n)n[r].apply(this,t)}}}]),e}();t["default"]=u,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(185),c=r(a),u=n(173),f=r(u),l=n(182),h=r(l),d=n(184),p=r(d),v=n(187),g=r(v),y=g["default"].create({objectHash:function(e){return e.id?e.id:JSON.stringify(e)},textDiff:{minLength:1e4}}),m=function(){function e(){function t(e){function t(e){var t={};for(var n in e)"$$"!==n.slice(0,2)&&"function"!=typeof e[n]&&(t[n]=e[n]);return t}e.leftIsArray||"object"!==e.leftType||(e.left=t(e.left)),e.rightIsArray||"object"!==e.rightType||(e.right=t(e.right))}var n=arguments.length<=0||void 0===arguments[0]?150:arguments[0];i(this,e),y.processor.pipes.diff.before("objects",t),this._updateRunning=!1,this._processingPatch=!1,this._timer=null,this._lastObjects={},this._events={},this.objects={},this.options={},this.callbacks={},this.timerInterval=n}return s(e,[{key:"remove",value:function(t){var n=e.subscriptionKeyForOptions(t);delete this.objects[n],delete this._lastObjects[n],delete this.options[n],delete this.callbacks[n],delete this._events[n]}},{key:"add",value:function(t,n,r,i,s,a){function c(e){if("a"===e._t)return!0;for(var t in e)"object"===o(e[t])&&c(e[t])&&delete e[t];return 0===Object.keys(e).length}function u(){if(!f._processingPatch&&!f._updateRunning){var e=y.diff(f._lastObjects,f.objects);if(void 0!==e){h["default"].debug("Found diff: "+JSON.stringify(e));for(var t in e)for(var n=f._lastObjects[t],r=e[t],i=f.options[t],s=f.callbacks[t],a=Object.keys(r),u=0;u<a.length;u++){var l=a[u];if("_t"!==l){var d=r[l];if(Array.isArray(d))1===d.length?(s.add(f.objects[t][l]),delete n[l],delete f.objects[t][l],h["default"].debug("Adding object to "+t+" channel")):3===d.length&&(s.remove(l),delete n[l],h["default"].debug("Removing object from "+t+" channel"));else{var p=Object.keys(d),v=[],g=l;Array.isArray(f.objects[t])&&f.objects[t][l].id&&(g=f.objects[t][l].id);for(var m=0;m<p.length;m++){var b=p[m],_=d[b];c(_)?(v.push({op:"replace",path:i.channel.model+"/"+g+"/"+b,value:f.objects[t][l][b]}),h["default"].debug("Modified "+b+" property on object "+l+", "+i.channel.model+" channel")):"object"===("undefined"==typeof _?"undefined":o(_))?(v.push({op:"replace",path:i.channel.model+"/"+g+"/"+b,value:f.objects[t][l][b]}),h["default"].debug("Modified "+b+" property on object "+l+", "+i.channel.model+" channel")):1===_.length?(v.push({op:"replace",path:i.channel.model+"/"+g+"/"+b,value:_[0]}),h["default"].debug("Added "+b+" property to object "+l+", "+i.channel.model+" channel")):2===_.length?(v.push({op:"replace",path:i.channel.model+"/"+g+"/"+b,value:_[1]}),h["default"].debug("Modified "+b+" property on object "+l+", "+i.channel.model+" channel")):3===_.length&&h["default"].info("Removing object properties is not supported in this version. Try setting to an empty value instead."),n[l][b]=JSON.parse(JSON.stringify(f.objects[t][l][b]))}v.length&&s.update(g,v),h["default"].debug("Sending patch to object "+l+" on "+i.channel.model+" channel: "+JSON.stringify(v))}}}}}}var f=this,l=e.subscriptionKeyForOptions(t);this.objects[l]=n,this.options[l]=t,this.callbacks[l]={add:i,remove:s,update:a},this._events[l]=r,this._lastObjects[l]=JSON.parse(JSON.stringify(this.objects[l])),null===this._timer&&(this._timer=setInterval(u,this.timerInterval))}},{key:"processMessage",value:function(e){function t(e){for(var t,r,i,o,s,a,u,f=0;f<e.subscriptions.length;f++){s=e.subscriptions[f];var l=s.split(":");"context"===l[2]&&4===l.length&&(l.pop(),s=l.join(":")),r=n.objects[s],i=n._lastObjects[s],o=n._events[s],r?"new"===e.op?r.hasOwnProperty(e.object.id)?o.emit("error",(0,p["default"])("Object id already exists "+e)):(e.object.$$event=new c["default"](h["default"]),r[e.object.id]=e.object,i[e.object.id]=JSON.parse(JSON.stringify(e.object)),o.emit("update","add",e.object.id,e.object),h["default"].debug("Added object with id "+e.object.id)):"update"===e.op?(a=e.patch.path.split("/"),r.hasOwnProperty(a[1])?e.patch.hasOwnProperty("value")?(u=r[a[1]],t=u[a[2]],u[a[2]]=e.patch.value,i[a[1]][a[2]]=JSON.parse(JSON.stringify(e.patch.value)),o.emit("update","replace",a[1],u,{path:a[2],oldValue:t}),h["default"].debug("Replaced property "+a[2]+" of object id "+a[1]+" with  value "+e.patch.value)):o.emit("error",(0,p["default"])("Invalid operation "+e)):o.emit("error",(0,p["default"])("Object id doesn't exist "+e))):(t=r[e.object.id],delete r[e.object.id],delete i[e.object.id],o.emit("update","delete",e.object.id,t),h["default"].debug("Removed object id "+e.object.id)):(0,p["default"])("Subscription not found "+s)}}var n=this;this._processingPatch=!0,h["default"].debug("Received update: "+JSON.stringify(e));var r,i;for(r=0;r<e.data["new"].length;r++)i=e.data["new"][r],i.op="new",t(i);for(r=0;r<e.data.updated.length;r++)i=e.data.updated[r],i.op="update",t(i);for(r=0;r<e.data.deleted.length;r++)i=e.data.deleted[r],i.op="remove",t(i);this._processingPatch=!1}}],[{key:"subscriptionKeyForOptions",value:function(e){var t="blg:"+f["default"].appId;return!e.channel.id&&e.channel.context&&(t+=":context:"+e.channel.context),e.channel.parent&&(t+=":"+e.channel.parent.model+":"+e.channel.parent.id),e.channel.user&&(t+=":users:"+e.channel.user),t+=":"+e.channel.model,e.channel.id&&(t+=":"+e.channel.id),e.filters&&(t+=":filter:"+btoa(JSON.stringify(e.filters)).toString("base64")),t}}]),e}();t["default"]=m,e.exports=t["default"]},function(e,t,n){var r=n(188),i=n(189).DiffPatcher;t.DiffPatcher=i,t.create=function(e){return new i(e)},t.dateReviver=n(194);var o;if(t.diff=function(){return o||(o=new i),o.diff.apply(o,arguments)},t.patch=function(){return o||(o=new i),o.patch.apply(o,arguments)},t.unpatch=function(){return o||(o=new i),o.unpatch.apply(o,arguments)},t.reverse=function(){return o||(o=new i),o.reverse.apply(o,arguments)},r.isBrowser)t.homepage="{{package-homepage}}",t.version="{{package-version}}";else{var s="../package.json",a=n(205)(s);t.homepage=a.homepage,t.version=a.version;var c="./formatters",u=n(205)(c);t.formatters=u,t.console=u.console}},function(e,t){t.isBrowser="undefined"!=typeof window},function(e,t,n){var r=n(190).Processor,i=n(191).Pipe,o=n(192).DiffContext,s=n(195).PatchContext,a=n(196).ReverseContext,c=n(197),u=n(198),f=n(199),l=n(201),h=n(202),d=function(e){this.processor=new r(e),this.processor.pipe(new i("diff").append(u.collectChildrenDiffFilter,c.diffFilter,l.diffFilter,h.diffFilter,u.objectsDiffFilter,f.diffFilter).shouldHaveResult()),this.processor.pipe(new i("patch").append(u.collectChildrenPatchFilter,f.collectChildrenPatchFilter,c.patchFilter,h.patchFilter,u.patchFilter,f.patchFilter).shouldHaveResult()),this.processor.pipe(new i("reverse").append(u.collectChildrenReverseFilter,f.collectChildrenReverseFilter,c.reverseFilter,h.reverseFilter,u.reverseFilter,f.reverseFilter).shouldHaveResult())};d.prototype.options=function(){return this.processor.options.apply(this.processor,arguments)},d.prototype.diff=function(e,t){return this.processor.process(new o(e,t))},d.prototype.patch=function(e,t){return this.processor.process(new s(e,t))},d.prototype.reverse=function(e){return this.processor.process(new a(e))},d.prototype.unpatch=function(e,t){return this.patch(e,this.reverse(t))},t.DiffPatcher=d},function(e,t){var n=function(e){this.selfOptions=e||{},this.pipes={}};n.prototype.options=function(e){return e&&(this.selfOptions=e),this.selfOptions},n.prototype.pipe=function(e,t){if("string"==typeof e){if("undefined"==typeof t)return this.pipes[e];this.pipes[e]=t}if(e&&e.name){if(t=e,t.processor===this)return t;this.pipes[t.name]=t}return t.processor=this,t},n.prototype.process=function(e,t){var n=e;n.options=this.options();for(var r,i,o=t||e.pipe||"default";o;)"undefined"!=typeof n.nextAfterChildren&&(n.next=n.nextAfterChildren,n.nextAfterChildren=null),"string"==typeof o&&(o=this.pipe(o)),o.process(n),i=n,r=o,o=null,n&&n.next&&(n=n.next,o=i.nextPipe||n.pipe||r);return n.hasResult?n.result:void 0},t.Processor=n},function(e,t){var n=function(e){this.name=e,this.filters=[]};n.prototype.process=function(e){if(!this.processor)throw new Error("add this pipe to a processor before using it");for(var t=this.debug,n=this.filters.length,r=e,i=0;i<n;i++){var o=this.filters[i];if(t&&this.log("filter: "+o.filterName),o(r),"object"==typeof r&&r.exiting){r.exiting=!1;break}}!r.next&&this.resultCheck&&this.resultCheck(r)},n.prototype.log=function(e){console.log("[jsondiffpatch] "+this.name+" pipe, "+e)},n.prototype.append=function(){return this.filters.push.apply(this.filters,arguments),this},n.prototype.prepend=function(){return this.filters.unshift.apply(this.filters,arguments),this},n.prototype.indexOf=function(e){if(!e)throw new Error("a filter name is required");for(var t=0;t<this.filters.length;t++){var n=this.filters[t];if(n.filterName===e)return t}throw new Error("filter not found: "+e)},n.prototype.list=function(){for(var e=[],t=0;t<this.filters.length;t++){var n=this.filters[t];e.push(n.filterName)}return e},n.prototype.after=function(e){var t=this.indexOf(e),n=Array.prototype.slice.call(arguments,1);if(!n.length)throw new Error("a filter is required");return n.unshift(t+1,0),Array.prototype.splice.apply(this.filters,n),this},n.prototype.before=function(e){var t=this.indexOf(e),n=Array.prototype.slice.call(arguments,1);if(!n.length)throw new Error("a filter is required");return n.unshift(t,0),Array.prototype.splice.apply(this.filters,n),this},n.prototype.clear=function(){return this.filters.length=0,this},n.prototype.shouldHaveResult=function(e){if(e===!1)return void(this.resultCheck=null);if(!this.resultCheck){var t=this;return this.resultCheck=function(e){if(!e.hasResult){console.log(e);var n=new Error(t.name+" failed");throw n.noResult=!0,n}},this}},t.Pipe=n},function(e,t,n){var r=n(193).Context,i=n(194),o=function(e,t){this.left=e,this.right=t,this.pipe="diff"};o.prototype=new r,o.prototype.setResult=function(e){if(this.options.cloneDiffValues){var t="function"==typeof this.options.cloneDiffValues?this.options.cloneDiffValues:function(e){return JSON.parse(JSON.stringify(e),i)};"object"==typeof e[0]&&(e[0]=t(e[0])),"object"==typeof e[1]&&(e[1]=t(e[1]))}return r.prototype.setResult.apply(this,arguments)},t.DiffContext=o},function(e,t,n){var r=n(191).Pipe,i=function(){};i.prototype.setResult=function(e){return this.result=e,this.hasResult=!0,this},i.prototype.exit=function(){return this.exiting=!0,this},i.prototype.switchTo=function(e,t){return"string"==typeof e||e instanceof r?this.nextPipe=e:(this.next=e,t&&(this.nextPipe=t)),this},i.prototype.push=function(e,t){return e.parent=this,"undefined"!=typeof t&&(e.childName=t),e.root=this.root||this,e.options=e.options||this.options,this.children?(this.children[this.children.length-1].next=e,this.children.push(e)):(this.children=[e],this.nextAfterChildren=this.next||null,this.next=e),e.next=this,this},t.Context=i},function(e,t){e.exports=function(e,t){var n;return"string"==typeof t&&(n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?(Z|([+\-])(\d{2}):(\d{2}))$/.exec(t))?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6],+(n[7]||0))):t;
}},function(e,t,n){var r=n(193).Context,i=function(e,t){this.left=e,this.delta=t,this.pipe="patch"};i.prototype=new r,t.PatchContext=i},function(e,t,n){var r=n(193).Context,i=function(e){this.delta=e,this.pipe="reverse"};i.prototype=new r,t.ReverseContext=i},function(e,t){var n="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},r=function(e){if(e.left===e.right)return void e.setResult(void 0).exit();if("undefined"==typeof e.left){if("function"==typeof e.right)throw new Error("functions are not supported");return void e.setResult([e.right]).exit()}if("undefined"==typeof e.right)return void e.setResult([e.left,0,0]).exit();if("function"==typeof e.left||"function"==typeof e.right)throw new Error("functions are not supported");return e.leftType=null===e.left?"null":typeof e.left,e.rightType=null===e.right?"null":typeof e.right,e.leftType!==e.rightType?void e.setResult([e.left,e.right]).exit():"boolean"===e.leftType||"number"===e.leftType?void e.setResult([e.left,e.right]).exit():("object"===e.leftType&&(e.leftIsArray=n(e.left)),"object"===e.rightType&&(e.rightIsArray=n(e.right)),e.leftIsArray!==e.rightIsArray?void e.setResult([e.left,e.right]).exit():void 0)};r.filterName="trivial";var i=function(e){return"undefined"==typeof e.delta?void e.setResult(e.left).exit():(e.nested=!n(e.delta),e.nested?void 0:1===e.delta.length?void e.setResult(e.delta[0]).exit():2===e.delta.length?void e.setResult(e.delta[1]).exit():3===e.delta.length&&0===e.delta[2]?void e.setResult(void 0).exit():void 0)};i.filterName="trivial";var o=function(e){return"undefined"==typeof e.delta?void e.setResult(e.delta).exit():(e.nested=!n(e.delta),e.nested?void 0:1===e.delta.length?void e.setResult([e.delta[0],0,0]).exit():2===e.delta.length?void e.setResult([e.delta[1],e.delta[0]]).exit():3===e.delta.length&&0===e.delta[2]?void e.setResult([e.delta[0]]).exit():void 0)};o.filterName="trivial",t.diffFilter=r,t.patchFilter=i,t.reverseFilter=o},function(e,t,n){var r=n(192).DiffContext,i=n(195).PatchContext,o=n(196).ReverseContext,s=function(e){if(e&&e.children){for(var t,n=e.children.length,r=e.result,i=0;i<n;i++)t=e.children[i],"undefined"!=typeof t.result&&(r=r||{},r[t.childName]=t.result);r&&e.leftIsArray&&(r._t="a"),e.setResult(r).exit()}};s.filterName="collectChildren";var a=function(e){if(!e.leftIsArray&&"object"===e.leftType){var t,n,i=e.options.propertyFilter;for(t in e.left)Object.prototype.hasOwnProperty.call(e.left,t)&&(i&&!i(t,e)||(n=new r(e.left[t],e.right[t]),e.push(n,t)));for(t in e.right)Object.prototype.hasOwnProperty.call(e.right,t)&&(i&&!i(t,e)||"undefined"==typeof e.left[t]&&(n=new r((void 0),e.right[t]),e.push(n,t)));return e.children&&0!==e.children.length?void e.exit():void e.setResult(void 0).exit()}};a.filterName="objects";var c=function(e){if(e.nested&&!e.delta._t){var t,n;for(t in e.delta)n=new i(e.left[t],e.delta[t]),e.push(n,t);e.exit()}};c.filterName="objects";var u=function(e){if(e&&e.children&&!e.delta._t){for(var t,n=e.children.length,r=0;r<n;r++)t=e.children[r],Object.prototype.hasOwnProperty.call(e.left,t.childName)&&void 0===t.result?delete e.left[t.childName]:e.left[t.childName]!==t.result&&(e.left[t.childName]=t.result);e.setResult(e.left).exit()}};u.filterName="collectChildren";var f=function(e){if(e.nested&&!e.delta._t){var t,n;for(t in e.delta)n=new o(e.delta[t]),e.push(n,t);e.exit()}};f.filterName="objects";var l=function(e){if(e&&e.children&&!e.delta._t){for(var t,n=e.children.length,r={},i=0;i<n;i++)t=e.children[i],r[t.childName]!==t.result&&(r[t.childName]=t.result);e.setResult(r).exit()}};l.filterName="collectChildren",t.collectChildrenDiffFilter=s,t.objectsDiffFilter=a,t.patchFilter=c,t.collectChildrenPatchFilter=u,t.reverseFilter=f,t.collectChildrenReverseFilter=l},function(e,t,n){function r(e,t,n,r){for(var i=0;i<n;i++)for(var o=e[i],s=0;s<r;s++){var a=t[s];if(o===a)return!0}}function i(e,t,n,r,i){var o=e[n],s=t[r];if(o===s)return!0;if("object"!=typeof o||"object"!=typeof s)return!1;var a=i.objectHash;if(!a)return i.matchByPosition&&n===r;var c,u;return"number"==typeof n?(i.hashCache1=i.hashCache1||[],c=i.hashCache1[n],"undefined"==typeof c&&(i.hashCache1[n]=c=a(o,n))):c=a(o),"undefined"!=typeof c&&("number"==typeof r?(i.hashCache2=i.hashCache2||[],u=i.hashCache2[r],"undefined"==typeof u&&(i.hashCache2[r]=u=a(s,r))):u=a(s),"undefined"!=typeof u&&c===u)}var o=n(192).DiffContext,s=n(195).PatchContext,a=n(196).ReverseContext,c=n(200),u=3,f="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},l="function"==typeof Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=e.length,r=0;r<n;r++)if(e[r]===t)return r;return-1},h=function(e){if(e.leftIsArray){var t,n,s,a,f={objectHash:e.options&&e.options.objectHash,matchByPosition:e.options&&e.options.matchByPosition},h=0,d=0,p=e.left,v=e.right,g=p.length,y=v.length;for(g>0&&y>0&&!f.objectHash&&"boolean"!=typeof f.matchByPosition&&(f.matchByPosition=!r(p,v,g,y));h<g&&h<y&&i(p,v,h,h,f);)t=h,a=new o(e.left[t],e.right[t]),e.push(a,t),h++;for(;d+h<g&&d+h<y&&i(p,v,g-1-d,y-1-d,f);)n=g-1-d,s=y-1-d,a=new o(e.left[n],e.right[s]),e.push(a,s),d++;var m;if(h+d===g){if(g===y)return void e.setResult(void 0).exit();for(m=m||{_t:"a"},t=h;t<y-d;t++)m[t]=[v[t]];return void e.setResult(m).exit()}if(h+d===y){for(m=m||{_t:"a"},t=h;t<g-d;t++)m["_"+t]=[p[t],0,0];return void e.setResult(m).exit()}delete f.hashCache1,delete f.hashCache2;var b=p.slice(h,g-d),_=v.slice(h,y-d),w=c.get(b,_,i,f),E=[];for(m=m||{_t:"a"},t=h;t<g-d;t++)l(w.indices1,t-h)<0&&(m["_"+t]=[p[t],0,0],E.push(t));var k=!0;e.options&&e.options.arrays&&e.options.arrays.detectMove===!1&&(k=!1);var x=!1;e.options&&e.options.arrays&&e.options.arrays.includeValueOnMove&&(x=!0);var S=E.length;for(t=h;t<y-d;t++){var A=l(w.indices2,t-h);if(A<0){var T=!1;if(k&&S>0)for(var O=0;O<S;O++)if(n=E[O],i(b,_,n-h,t-h,f)){m["_"+n].splice(1,2,t,u),x||(m["_"+n][0]=""),s=t,a=new o(e.left[n],e.right[s]),e.push(a,s),E.splice(O,1),T=!0;break}T||(m[t]=[v[t]])}else n=w.indices1[A]+h,s=w.indices2[A]+h,a=new o(e.left[n],e.right[s]),e.push(a,s)}e.setResult(m).exit()}};h.filterName="arrays";var d={numerically:function(e,t){return e-t},numericallyBy:function(e){return function(t,n){return t[e]-n[e]}}},p=function(e){if(e.nested&&"a"===e.delta._t){var t,n,r=e.delta,i=e.left,o=[],a=[],c=[];for(t in r)if("_t"!==t)if("_"===t[0]){if(0!==r[t][2]&&r[t][2]!==u)throw new Error("only removal or move can be applied at original array indices, invalid diff type: "+r[t][2]);o.push(parseInt(t.slice(1),10))}else 1===r[t].length?a.push({index:parseInt(t,10),value:r[t][0]}):c.push({index:parseInt(t,10),delta:r[t]});for(o=o.sort(d.numerically),t=o.length-1;t>=0;t--){n=o[t];var f=r["_"+n],l=i.splice(n,1)[0];f[2]===u&&a.push({index:f[1],value:l})}a=a.sort(d.numericallyBy("index"));var h=a.length;for(t=0;t<h;t++){var p=a[t];i.splice(p.index,0,p.value)}var v,g=c.length;if(g>0)for(t=0;t<g;t++){var y=c[t];v=new s(e.left[y.index],y.delta),e.push(v,y.index)}return e.children?void e.exit():void e.setResult(e.left).exit()}};p.filterName="arrays";var v=function(e){if(e&&e.children&&"a"===e.delta._t){for(var t,n=e.children.length,r=0;r<n;r++)t=e.children[r],e.left[t.childName]=t.result;e.setResult(e.left).exit()}};v.filterName="arraysCollectChildren";var g=function(e){if(!e.nested)return void(e.delta[2]===u&&(e.newName="_"+e.delta[1],e.setResult([e.delta[0],parseInt(e.childName.substr(1),10),u]).exit()));if("a"===e.delta._t){var t,n;for(t in e.delta)"_t"!==t&&(n=new a(e.delta[t]),e.push(n,t));e.exit()}};g.filterName="arrays";var y=function(e,t,n){if("string"==typeof t&&"_"===t[0])return parseInt(t.substr(1),10);if(f(n)&&0===n[2])return"_"+t;var r=+t;for(var i in e){var o=e[i];if(f(o))if(o[2]===u){var s=parseInt(i.substr(1),10),a=o[1];if(a===+t)return s;s<=r&&a>r?r++:s>=r&&a<r&&r--}else if(0===o[2]){var c=parseInt(i.substr(1),10);c<=r&&r++}else 1===o.length&&i<=r&&r--}return r},m=function(e){if(e&&e.children&&"a"===e.delta._t){for(var t,n=e.children.length,r={_t:"a"},i=0;i<n;i++){t=e.children[i];var o=t.newName;"undefined"==typeof o&&(o=y(e.delta,t.childName,t.result)),r[o]!==t.result&&(r[o]=t.result)}e.setResult(r).exit()}};m.filterName="arraysCollectChildren",t.diffFilter=h,t.patchFilter=p,t.collectChildrenPatchFilter=v,t.reverseFilter=g,t.collectChildrenReverseFilter=m},function(e,t){var n=function(e,t,n,r){return e[n]===t[r]},r=function(e,t,n,r){var i,o,s=e.length,a=t.length,c=[s+1];for(i=0;i<s+1;i++)for(c[i]=[a+1],o=0;o<a+1;o++)c[i][o]=0;for(c.match=n,i=1;i<s+1;i++)for(o=1;o<a+1;o++)n(e,t,i-1,o-1,r)?c[i][o]=c[i-1][o-1]+1:c[i][o]=Math.max(c[i-1][o],c[i][o-1]);return c},i=function(e,t,n,r,o,s){if(0===r||0===o)return{sequence:[],indices1:[],indices2:[]};if(e.match(t,n,r-1,o-1,s)){var a=i(e,t,n,r-1,o-1,s);return a.sequence.push(t[r-1]),a.indices1.push(r-1),a.indices2.push(o-1),a}return e[r][o-1]>e[r-1][o]?i(e,t,n,r,o-1,s):i(e,t,n,r-1,o,s)},o=function(e,t,o,s){s=s||{};var a=r(e,t,o||n,s),c=i(a,e,t,e.length,t.length,s);return"string"==typeof e&&"string"==typeof t&&(c.sequence=c.sequence.join("")),c};t.get=o},function(e,t){var n=function(e){e.left instanceof Date?(e.right instanceof Date?e.left.getTime()!==e.right.getTime()?e.setResult([e.left,e.right]):e.setResult(void 0):e.setResult([e.left,e.right]),e.exit()):e.right instanceof Date&&e.setResult([e.left,e.right]).exit()};n.filterName="dates",t.diffFilter=n},function(e,t,n){var r=2,i=60,o=null,s=function(e){if(!o){var t;if("undefined"!=typeof diff_match_patch)t="function"==typeof diff_match_patch?new diff_match_patch:new diff_match_patch.diff_match_patch;else try{var r="diff_match_patch_uncompressed",i=n(203)("./"+r);t=new i.diff_match_patch}catch(s){t=null}if(!t){if(!e)return null;var a=new Error("text diff_match_patch library not found");throw a.diff_match_patch_not_found=!0,a}o={diff:function(e,n){return t.patch_toText(t.patch_make(e,n))},patch:function(e,n){for(var r=t.patch_apply(t.patch_fromText(n),e),i=0;i<r[1].length;i++)if(!r[1][i]){var o=new Error("text patch failed");o.textPatchFailed=!0}return r[0]}}}return o},a=function(e){if("string"===e.leftType){var t=e.options&&e.options.textDiff&&e.options.textDiff.minLength||i;if(e.left.length<t||e.right.length<t)return void e.setResult([e.left,e.right]).exit();var n=s();if(!n)return void e.setResult([e.left,e.right]).exit();var o=n.diff;e.setResult([o(e.left,e.right),0,r]).exit()}};a.filterName="texts";var c=function(e){if(!e.nested&&e.delta[2]===r){var t=s(!0).patch;e.setResult(t(e.left,e.delta[0])).exit()}};c.filterName="texts";var u=function(e){var t,n,r,i,o,s,a,c,u=null,f=/^@@ +\-(\d+),(\d+) +\+(\d+),(\d+) +@@$/;for(r=e.split("\n"),t=0,n=r.length;t<n;t++){i=r[t];var l=i.slice(0,1);"@"===l?(u=f.exec(i),s=t,a=null,c=null,r[s]="@@ -"+u[3]+","+u[4]+" +"+u[1]+","+u[2]+" @@"):"+"===l?(a=t,r[t]="-"+r[t].slice(1),"+"===r[t-1].slice(0,1)&&(o=r[t],r[t]=r[t-1],r[t-1]=o)):"-"===l&&(c=t,r[t]="+"+r[t].slice(1))}return r.join("\n")},f=function(e){e.nested||e.delta[2]===r&&e.setResult([u(e.delta[0]),0,r]).exit()};f.filterName="texts",t.diffFilter=a,t.patchFilter=c,t.reverseFilter=f},function(e,t,n){function r(e){return n(i(e))}function i(e){return o[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var o={"./diff_match_patch_uncompressed":204,"./diff_match_patch_uncompressed.js":204};r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=203},function(e,t){function n(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}var r=-1,i=1,o=0;n.Diff,n.prototype.diff_main=function(e,t,n,r){"undefined"==typeof r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var i=r;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[[o,e]]:[];"undefined"==typeof n&&(n=!0);var s=n,a=this.diff_commonPrefix(e,t),c=e.substring(0,a);e=e.substring(a),t=t.substring(a),a=this.diff_commonSuffix(e,t);var u=e.substring(e.length-a);e=e.substring(0,e.length-a),t=t.substring(0,t.length-a);var f=this.diff_compute_(e,t,s,i);return c&&f.unshift([o,c]),u&&f.push([o,u]),this.diff_cleanupMerge(f),f},n.prototype.diff_compute_=function(e,t,n,s){var a;if(!e)return[[i,t]];if(!t)return[[r,e]];var c=e.length>t.length?e:t,u=e.length>t.length?t:e,f=c.indexOf(u);if(f!=-1)return a=[[i,c.substring(0,f)],[o,u],[i,c.substring(f+u.length)]],e.length>t.length&&(a[0][0]=a[2][0]=r),a;if(1==u.length)return[[r,e],[i,t]];c=u=null;var l=this.diff_halfMatch_(e,t);if(l){var h=l[0],d=l[1],p=l[2],v=l[3],g=l[4],y=this.diff_main(h,p,n,s),m=this.diff_main(d,v,n,s);return y.concat([[o,g]],m)}return n&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,s):this.diff_bisect_(e,t,s)},n.prototype.diff_lineMode_=function(e,t,n){var s=this.diff_linesToChars_(e,t);e=s[0],t=s[1];var a=s[2],c=this.diff_bisect_(e,t,n);this.diff_charsToLines_(c,a),this.diff_cleanupSemantic(c),c.push([o,""]);for(var u=0,f=0,l=0,h="",d="";u<c.length;){switch(c[u][0]){case i:l++,d+=c[u][1];break;case r:f++,h+=c[u][1];break;case o:if(f>=1&&l>=1){var s=this.diff_main(h,d,!1,n);c.splice(u-f-l,f+l),u=u-f-l;for(var p=s.length-1;p>=0;p--)c.splice(u,0,s[p]);u+=s.length}l=0,f=0,h="",d=""}u++}return c.pop(),c},n.prototype.diff_bisect_=function(e,t,n){for(var o=e.length,s=t.length,a=Math.ceil((o+s)/2),c=a,u=2*a,f=new Array(u),l=new Array(u),h=0;h<u;h++)f[h]=-1,l[h]=-1;f[c+1]=0,l[c+1]=0;for(var d=o-s,p=d%2!=0,v=0,g=0,y=0,m=0,b=0;b<a&&!((new Date).getTime()>n);b++){for(var _=-b+v;_<=b-g;_+=2){var w,E=c+_;w=_==-b||_!=b&&f[E-1]<f[E+1]?f[E+1]:f[E-1]+1;for(var k=w-_;w<o&&k<s&&e.charAt(w)==t.charAt(k);)w++,k++;if(f[E]=w,w>o)g+=2;else if(k>s)v+=2;else if(p){var x=c+d-_;if(x>=0&&x<u&&l[x]!=-1){var S=o-l[x];if(w>=S)return this.diff_bisectSplit_(e,t,w,k,n)}}}for(var A=-b+y;A<=b-m;A+=2){var S,x=c+A;S=A==-b||A!=b&&l[x-1]<l[x+1]?l[x+1]:l[x-1]+1;for(var T=S-A;S<o&&T<s&&e.charAt(o-S-1)==t.charAt(s-T-1);)S++,T++;if(l[x]=S,S>o)m+=2;else if(T>s)y+=2;else if(!p){var E=c+d-A;if(E>=0&&E<u&&f[E]!=-1){var w=f[E],k=c+w-E;if(S=o-S,w>=S)return this.diff_bisectSplit_(e,t,w,k,n)}}}}return[[r,e],[i,t]]},n.prototype.diff_bisectSplit_=function(e,t,n,r,i){var o=e.substring(0,n),s=t.substring(0,r),a=e.substring(n),c=t.substring(r),u=this.diff_main(o,s,!1,i),f=this.diff_main(a,c,!1,i);return u.concat(f)},n.prototype.diff_linesToChars_=function(e,t){function n(e){for(var t="",n=0,o=-1,s=r.length;o<e.length-1;){o=e.indexOf("\n",n),o==-1&&(o=e.length-1);var a=e.substring(n,o+1);n=o+1,(i.hasOwnProperty?i.hasOwnProperty(a):void 0!==i[a])?t+=String.fromCharCode(i[a]):(t+=String.fromCharCode(s),i[a]=s,r[s++]=a)}return t}var r=[],i={};r[0]="";var o=n(e),s=n(t);return[o,s,r]},n.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n][1],i=[],o=0;o<r.length;o++)i[o]=t[r.charCodeAt(o)];e[n][1]=i.join("")}},n.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(o,i)==t.substring(o,i)?(n=i,o=n):r=i,i=Math.floor((r-n)/2+n);return i},n.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?(n=i,o=n):r=i,i=Math.floor((r-n)/2+n);return i},n.prototype.diff_commonOverlap_=function(e,t){var n=e.length,r=t.length;if(0==n||0==r)return 0;n>r?e=e.substring(n-r):n<r&&(t=t.substring(0,n));var i=Math.min(n,r);if(e==t)return i;for(var o=0,s=1;;){var a=e.substring(i-s),c=t.indexOf(a);if(c==-1)return o;s+=c,0!=c&&e.substring(i-s)!=t.substring(0,s)||(o=s,s++)}},n.prototype.diff_halfMatch_=function(e,t){function n(e,t,n){for(var r,i,o,a,c=e.substring(n,n+Math.floor(e.length/4)),u=-1,f="";(u=t.indexOf(c,u+1))!=-1;){var l=s.diff_commonPrefix(e.substring(n),t.substring(u)),h=s.diff_commonSuffix(e.substring(0,n),t.substring(0,u));f.length<h+l&&(f=t.substring(u-h,u)+t.substring(u,u+l),r=e.substring(0,n-h),i=e.substring(n+l),o=t.substring(0,u-h),a=t.substring(u+l))}return 2*f.length>=e.length?[r,i,o,a,f]:null}if(this.Diff_Timeout<=0)return null;var r=e.length>t.length?e:t,i=e.length>t.length?t:e;if(r.length<4||2*i.length<r.length)return null;var o,s=this,a=n(r,i,Math.ceil(r.length/4)),c=n(r,i,Math.ceil(r.length/2));if(!a&&!c)return null;o=c?a&&a[4].length>c[4].length?a:c:a;var u,f,l,h;e.length>t.length?(u=o[0],f=o[1],l=o[2],h=o[3]):(l=o[0],h=o[1],u=o[2],f=o[3]);var d=o[4];return[u,f,l,h,d]},n.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],s=0,a=null,c=0,u=0,f=0,l=0,h=0;c<e.length;)e[c][0]==o?(n[s++]=c,u=l,f=h,l=0,h=0,a=e[c][1]):(e[c][0]==i?l+=e[c][1].length:h+=e[c][1].length,null!==a&&a.length<=Math.max(u,f)&&a.length<=Math.max(l,h)&&(e.splice(n[s-1],0,[r,a]),e[n[s-1]+1][0]=i,s--,s--,c=s>0?n[s-1]:-1,u=0,f=0,l=0,h=0,a=null,t=!0)),c++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),c=1;c<e.length;){if(e[c-1][0]==r&&e[c][0]==i){var d=e[c-1][1],p=e[c][1],v=this.diff_commonOverlap_(d,p);(v>=d.length/2||v>=p.length/2)&&(e.splice(c,0,[o,p.substring(0,v)]),e[c-1][1]=d.substring(0,d.length-v),e[c+1][1]=p.substring(v),c++),c++}c++}},n.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 5;var o=0;return(e.charAt(e.length-1).match(n)||t.charAt(0).match(n))&&(o++,(e.charAt(e.length-1).match(r)||t.charAt(0).match(r))&&(o++,(e.charAt(e.length-1).match(i)||t.charAt(0).match(i))&&(o++,(e.match(s)||t.match(a))&&o++))),o}for(var n=/[^a-zA-Z0-9]/,r=/\s/,i=/[\r\n]/,s=/\n\r?\n$/,a=/^\r?\n\r?\n/,c=1;c<e.length-1;){if(e[c-1][0]==o&&e[c+1][0]==o){var u=e[c-1][1],f=e[c][1],l=e[c+1][1],h=this.diff_commonSuffix(u,f);if(h){var d=f.substring(f.length-h);u=u.substring(0,u.length-h),f=d+f.substring(0,f.length-h),l=d+l}for(var p=u,v=f,g=l,y=t(u,f)+t(f,l);f.charAt(0)===l.charAt(0);){u+=f.charAt(0),f=f.substring(1)+l.charAt(0),l=l.substring(1);var m=t(u,f)+t(f,l);m>=y&&(y=m,p=u,v=f,g=l)}e[c-1][1]!=p&&(p?e[c-1][1]=p:(e.splice(c-1,1),c--),e[c][1]=v,g?e[c+1][1]=g:(e.splice(c+1,1),c--))}c++}},n.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],s=0,a="",c=0,u=!1,f=!1,l=!1,h=!1;c<e.length;)e[c][0]==o?(e[c][1].length<this.Diff_EditCost&&(l||h)?(n[s++]=c,u=l,f=h,a=e[c][1]):(s=0,a=""),l=h=!1):(e[c][0]==r?h=!0:l=!0,a&&(u&&f&&l&&h||a.length<this.Diff_EditCost/2&&u+f+l+h==3)&&(e.splice(n[s-1],0,[r,a]),e[n[s-1]+1][0]=i,s--,a="",u&&f?(l=h=!0,s=0):(s--,c=s>0?n[s-1]:-1,l=h=!1),t=!0)),c++;t&&this.diff_cleanupMerge(e)},n.prototype.diff_cleanupMerge=function(e){e.push([o,""]);for(var t,n=0,s=0,a=0,c="",u="";n<e.length;)switch(e[n][0]){case i:a++,u+=e[n][1],n++;break;case r:s++,c+=e[n][1],n++;break;case o:s+a>1?(0!==s&&0!==a&&(t=this.diff_commonPrefix(u,c),0!==t&&(n-s-a>0&&e[n-s-a-1][0]==o?e[n-s-a-1][1]+=u.substring(0,t):(e.splice(0,0,[o,u.substring(0,t)]),n++),u=u.substring(t),c=c.substring(t)),t=this.diff_commonSuffix(u,c),0!==t&&(e[n][1]=u.substring(u.length-t)+e[n][1],u=u.substring(0,u.length-t),c=c.substring(0,c.length-t))),0===s?e.splice(n-s-a,s+a,[i,u]):0===a?e.splice(n-s-a,s+a,[r,c]):e.splice(n-s-a,s+a,[r,c],[i,u]),n=n-s-a+(s?1:0)+(a?1:0)+1):0!==n&&e[n-1][0]==o?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,a=0,s=0,c="",u=""}""===e[e.length-1][1]&&e.pop();var f=!1;for(n=1;n<e.length-1;)e[n-1][0]==o&&e[n+1][0]==o&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),f=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),f=!0)),n++;f&&this.diff_cleanupMerge(e)},n.prototype.diff_xIndex=function(e,t){var n,o=0,s=0,a=0,c=0;for(n=0;n<e.length&&(e[n][0]!==i&&(o+=e[n][1].length),e[n][0]!==r&&(s+=e[n][1].length),!(o>t));n++)a=o,c=s;return e.length!=n&&e[n][0]===r?c:c+(t-a)},n.prototype.diff_prettyHtml=function(e){for(var t=[],n=0,s=/&/g,a=/</g,c=/>/g,u=/\n/g,f=0;f<e.length;f++){var l=e[f][0],h=e[f][1],d=h.replace(s,"&amp;").replace(a,"&lt;").replace(c,"&gt;").replace(u,"&para;<br>");switch(l){case i:t[f]='<ins style="background:#e6ffe6;">'+d+"</ins>";break;case r:t[f]='<del style="background:#ffe6e6;">'+d+"</del>";break;case o:t[f]="<span>"+d+"</span>"}l!==r&&(n+=h.length)}return t.join("")},n.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==i&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==r&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_levenshtein=function(e){for(var t=0,n=0,s=0,a=0;a<e.length;a++){var c=e[a][0],u=e[a][1];switch(c){case i:n+=u.length;break;case r:s+=u.length;break;case o:t+=Math.max(n,s),n=0,s=0}}return t+=Math.max(n,s)},n.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case i:t[n]="+"+encodeURI(e[n][1]);break;case r:t[n]="-"+e[n][1].length;break;case o:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},n.prototype.diff_fromDelta=function(e,t){for(var n=[],s=0,a=0,c=t.split(/\t/g),u=0;u<c.length;u++){var f=c[u].substring(1);switch(c[u].charAt(0)){case"+":try{n[s++]=[i,decodeURI(f)]}catch(l){throw new Error("Illegal escape in diff_fromDelta: "+f)}break;case"-":case"=":var h=parseInt(f,10);if(isNaN(h)||h<0)throw new Error("Invalid number in diff_fromDelta: "+f);var d=e.substring(a,a+=h);"="==c[u].charAt(0)?n[s++]=[o,d]:n[s++]=[r,d];break;default:if(c[u])throw new Error("Invalid diff operation in diff_fromDelta: "+c[u])}}if(a!=e.length)throw new Error("Delta length ("+a+") does not equal source text length ("+e.length+").");return n},n.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},n.prototype.match_bitap_=function(e,t,n){function r(e,r){var i=e/t.length,s=Math.abs(n-r);return o.Match_Distance?i+s/o.Match_Distance:s?1:i}if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(t),o=this,s=this.Match_Threshold,a=e.indexOf(t,n);a!=-1&&(s=Math.min(r(0,a),s),a=e.lastIndexOf(t,n+t.length),a!=-1&&(s=Math.min(r(0,a),s)));var c=1<<t.length-1;a=-1;for(var u,f,l,h=t.length+e.length,d=0;d<t.length;d++){for(u=0,f=h;u<f;)r(d,n+f)<=s?u=f:h=f,f=Math.floor((h-u)/2+u);h=f;var p=Math.max(1,n-f+1),v=Math.min(n+f,e.length)+t.length,g=Array(v+2);g[v+1]=(1<<d)-1;for(var y=v;y>=p;y--){var m=i[e.charAt(y-1)];if(0===d?g[y]=(g[y+1]<<1|1)&m:g[y]=(g[y+1]<<1|1)&m|((l[y+1]|l[y])<<1|1)|l[y+1],g[y]&c){var b=r(d,y-1);if(b<=s){if(s=b,a=y-1,!(a>n))break;p=Math.max(1,2*n-a)}}}if(r(d+1,n)>s)break;l=g}return a},n.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(var n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},n.prototype.patch_addContext_=function(e,t){if(0!=t.length){for(var n=t.substring(e.start2,e.start2+e.length1),r=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,n=t.substring(e.start2-r,e.start2+e.length1+r);r+=this.Patch_Margin;var i=t.substring(e.start2-r,e.start2);i&&e.diffs.unshift([o,i]);var s=t.substring(e.start2+e.length1,e.start2+e.length1+r);s&&e.diffs.push([o,s]),e.start1-=i.length,e.start2-=i.length,e.length1+=i.length+s.length,e.length2+=i.length+s.length}},n.prototype.patch_make=function(e,t,s){var a,c;if("string"==typeof e&&"string"==typeof t&&"undefined"==typeof s)a=e,c=this.diff_main(a,t,!0),c.length>2&&(this.diff_cleanupSemantic(c),this.diff_cleanupEfficiency(c));else if(e&&"object"==typeof e&&"undefined"==typeof t&&"undefined"==typeof s)c=e,a=this.diff_text1(c);else if("string"==typeof e&&t&&"object"==typeof t&&"undefined"==typeof s)a=e,c=t;else{if("string"!=typeof e||"string"!=typeof t||!s||"object"!=typeof s)throw new Error("Unknown call format to patch_make.");a=e,c=s}if(0===c.length)return[];for(var u=[],f=new n.patch_obj,l=0,h=0,d=0,p=a,v=a,g=0;g<c.length;g++){var y=c[g][0],m=c[g][1];switch(l||y===o||(f.start1=h,f.start2=d),y){case i:f.diffs[l++]=c[g],f.length2+=m.length,v=v.substring(0,d)+m+v.substring(d);break;case r:f.length1+=m.length,f.diffs[l++]=c[g],v=v.substring(0,d)+v.substring(d+m.length);break;case o:m.length<=2*this.Patch_Margin&&l&&c.length!=g+1?(f.diffs[l++]=c[g],f.length1+=m.length,f.length2+=m.length):m.length>=2*this.Patch_Margin&&l&&(this.patch_addContext_(f,p),u.push(f),f=new n.patch_obj,l=0,p=v,h=d)}y!==i&&(h+=m.length),y!==r&&(d+=m.length)}return l&&(this.patch_addContext_(f,p),u.push(f)),u},n.prototype.patch_deepCopy=function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r],o=new n.patch_obj;o.diffs=[];for(var s=0;s<i.diffs.length;s++)o.diffs[s]=i.diffs[s].slice();o.start1=i.start1,o.start2=i.start2,o.length1=i.length1,o.length2=i.length2,t[r]=o}return t},n.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var s=0,a=[],c=0;c<e.length;c++){var u,f=e[c].start2+s,l=this.diff_text1(e[c].diffs),h=-1;if(l.length>this.Match_MaxBits?(u=this.match_main(t,l.substring(0,this.Match_MaxBits),f),u!=-1&&(h=this.match_main(t,l.substring(l.length-this.Match_MaxBits),f+l.length-this.Match_MaxBits),(h==-1||u>=h)&&(u=-1))):u=this.match_main(t,l,f),u==-1)a[c]=!1,s-=e[c].length2-e[c].length1;else{a[c]=!0,s=u-f;var d;if(d=h==-1?t.substring(u,u+l.length):t.substring(u,h+this.Match_MaxBits),l==d)t=t.substring(0,u)+this.diff_text2(e[c].diffs)+t.substring(u+l.length);else{var p=this.diff_main(l,d,!1);if(l.length>this.Match_MaxBits&&this.diff_levenshtein(p)/l.length>this.Patch_DeleteThreshold)a[c]=!1;else{this.diff_cleanupSemanticLossless(p);for(var v,g=0,y=0;y<e[c].diffs.length;y++){var m=e[c].diffs[y];m[0]!==o&&(v=this.diff_xIndex(p,g)),m[0]===i?t=t.substring(0,u+v)+m[1]+t.substring(u+v):m[0]===r&&(t=t.substring(0,u+v)+t.substring(u+this.diff_xIndex(p,g+m[1].length))),m[0]!==r&&(g+=m[1].length)}}}}}return t=t.substring(n.length,t.length-n.length),[t,a]},n.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,n="",r=1;r<=t;r++)n+=String.fromCharCode(r);for(var r=0;r<e.length;r++)e[r].start1+=t,e[r].start2+=t;var i=e[0],s=i.diffs;if(0==s.length||s[0][0]!=o)s.unshift([o,n]),i.start1-=t,i.start2-=t,i.length1+=t,i.length2+=t;else if(t>s[0][1].length){var a=t-s[0][1].length;s[0][1]=n.substring(s[0][1].length)+s[0][1],i.start1-=a,i.start2-=a,i.length1+=a,i.length2+=a}if(i=e[e.length-1],s=i.diffs,0==s.length||s[s.length-1][0]!=o)s.push([o,n]),i.length1+=t,i.length2+=t;else if(t>s[s.length-1][1].length){var a=t-s[s.length-1][1].length;s[s.length-1][1]+=n.substring(0,a),i.length1+=a,i.length2+=a}return n},n.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,s=0;s<e.length;s++)if(e[s].length1>t){var a=e[s];e.splice(s--,1);for(var c=a.start1,u=a.start2,f="";0!==a.diffs.length;){var l=new n.patch_obj,h=!0;for(l.start1=c-f.length,l.start2=u-f.length,""!==f&&(l.length1=l.length2=f.length,l.diffs.push([o,f]));0!==a.diffs.length&&l.length1<t-this.Patch_Margin;){var d=a.diffs[0][0],p=a.diffs[0][1];d===i?(l.length2+=p.length,u+=p.length,l.diffs.push(a.diffs.shift()),h=!1):d===r&&1==l.diffs.length&&l.diffs[0][0]==o&&p.length>2*t?(l.length1+=p.length,c+=p.length,h=!1,l.diffs.push([d,p]),a.diffs.shift()):(p=p.substring(0,t-l.length1-this.Patch_Margin),l.length1+=p.length,c+=p.length,d===o?(l.length2+=p.length,u+=p.length):h=!1,l.diffs.push([d,p]),p==a.diffs[0][1]?a.diffs.shift():a.diffs[0][1]=a.diffs[0][1].substring(p.length))}f=this.diff_text2(l.diffs),f=f.substring(f.length-this.Patch_Margin);var v=this.diff_text1(a.diffs).substring(0,this.Patch_Margin);""!==v&&(l.length1+=v.length,l.length2+=v.length,0!==l.diffs.length&&l.diffs[l.diffs.length-1][0]===o?l.diffs[l.diffs.length-1][1]+=v:l.diffs.push([o,v])),h||e.splice(++s,0,l)}}},n.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},n.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var s=e.split("\n"),a=0,c=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;a<s.length;){var u=s[a].match(c);if(!u)throw new Error("Invalid patch string: "+s[a]);var f=new n.patch_obj;for(t.push(f),f.start1=parseInt(u[1],10),""===u[2]?(f.start1--,f.length1=1):"0"==u[2]?f.length1=0:(f.start1--,f.length1=parseInt(u[2],10)),f.start2=parseInt(u[3],10),""===u[4]?(f.start2--,f.length2=1):"0"==u[4]?f.length2=0:(f.start2--,f.length2=parseInt(u[4],10)),a++;a<s.length;){var l=s[a].charAt(0);try{var h=decodeURI(s[a].substring(1))}catch(d){throw new Error("Illegal escape in patch_fromText: "+h)}if("-"==l)f.diffs.push([r,h]);else if("+"==l)f.diffs.push([i,h]);else if(" "==l)f.diffs.push([o,h]);else{if("@"==l)break;if(""!==l)throw new Error('Invalid patch mode "'+l+'" in: '+h)}a++}}return t},n.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},n.patch_obj.prototype.toString=function(){var e,t;e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,t=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var n,s=["@@ -"+e+" +"+t+" @@\n"],a=0;a<this.diffs.length;a++){switch(this.diffs[a][0]){case i:n="+";break;case r:n="-";break;case o:n=" "}s[a+1]=n+encodeURI(this.diffs[a][1])+"\n"}return s.join("").replace(/%20/g," ")},this.diff_match_patch=n,this.DIFF_DELETE=r,this.DIFF_INSERT=i,this.DIFF_EQUAL=o},function(e,t,n){function r(e){return n(i(e))}function i(e){return o[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var o={"./contexts/context":193,"./contexts/context.js":193,"./contexts/diff":192,"./contexts/diff.js":192,"./contexts/patch":195,"./contexts/patch.js":195,"./contexts/reverse":196,"./contexts/reverse.js":196,"./date-reviver":194,"./date-reviver.js":194,"./diffpatcher":189,"./diffpatcher.js":189,"./environment":188,"./environment.js":188,"./filters/arrays":199,"./filters/arrays.js":199,"./filters/dates":201,"./filters/dates.js":201,"./filters/lcs":200,"./filters/lcs.js":200,"./filters/nested":198,"./filters/nested.js":198,"./filters/texts":202,"./filters/texts.js":202,"./filters/trivial":197,"./filters/trivial.js":197,"./formatters/annotated":206,"./formatters/annotated.js":206,"./formatters/base":207,"./formatters/base.js":207,"./formatters/console":208,"./formatters/console.js":208,"./formatters/html":217,"./formatters/html.js":217,"./formatters/index":218,"./formatters/index.js":218,"./formatters/jsonpatch":219,"./formatters/jsonpatch.js":219,"./main":187,"./main-formatters":221,"./main-formatters.js":221,"./main-full":222,"./main-full.js":222,"./main.js":187,"./pipe":191,"./pipe.js":191,"./processor":190,"./processor.js":190};r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=205},function(e,t,n){var r=n(207),i=r.BaseFormatter,o=function(){this.includeMoveDestinations=!1};o.prototype=new i,o.prototype.prepareContext=function(e){i.prototype.prepareContext.call(this,e),e.indent=function(e){this.indentLevel=(this.indentLevel||0)+("undefined"==typeof e?1:e),this.indentPad=new Array(this.indentLevel+1).join("&nbsp;&nbsp;")},e.row=function(t,n){e.out('<tr><td style="white-space: nowrap;"><pre class="jsondiffpatch-annotated-indent" style="display: inline-block">'),e.out(e.indentPad),e.out('</pre><pre style="display: inline-block">'),e.out(t),e.out('</pre></td><td class="jsondiffpatch-delta-note"><div>'),e.out(n),e.out("</div></td></tr>")}},o.prototype.typeFormattterErrorFormatter=function(e,t){e.row("",'<pre class="jsondiffpatch-error">'+t+"</pre>")},o.prototype.formatTextDiffString=function(e,t){var n=this.parseTextDiff(t);e.out('<ul class="jsondiffpatch-textdiff">');for(var r=0,i=n.length;r<i;r++){var o=n[r];e.out('<li><div class="jsondiffpatch-textdiff-location"><span class="jsondiffpatch-textdiff-line-number">'+o.location.line+'</span><span class="jsondiffpatch-textdiff-char">'+o.location.chr+'</span></div><div class="jsondiffpatch-textdiff-line">');
for(var s=o.pieces,a=0,c=s.length;a<c;a++){var u=s[a];e.out('<span class="jsondiffpatch-textdiff-'+u.type+'">'+u.text+"</span>")}e.out("</div></li>")}e.out("</ul>")},o.prototype.rootBegin=function(e,t,n){e.out('<table class="jsondiffpatch-annotated-delta">'),"node"===t&&(e.row("{"),e.indent()),"array"===n&&e.row('"_t": "a",',"Array delta (member names indicate array indices)")},o.prototype.rootEnd=function(e,t){"node"===t&&(e.indent(-1),e.row("}")),e.out("</table>")},o.prototype.nodeBegin=function(e,t,n,r,i){e.row("&quot;"+t+"&quot;: {"),"node"===r&&e.indent(),"array"===i&&e.row('"_t": "a",',"Array delta (member names indicate array indices)")},o.prototype.nodeEnd=function(e,t,n,r,i,o){"node"===r&&e.indent(-1),e.row("}"+(o?"":","))},o.prototype.format_unchanged=function(){},o.prototype.format_movedestination=function(){},o.prototype.format_node=function(e,t,n){this.formatDeltaChildren(e,t,n)};var s=function(e){return'<pre style="display:inline-block">&quot;'+e+"&quot;</pre>"},a={added:function(e,t,n,r){var i=" <pre>([newValue])</pre>";return"undefined"==typeof r?"new value"+i:"number"==typeof r?"insert at index "+r+i:"add property "+s(r)+i},modified:function(e,t,n,r){var i=" <pre>([previousValue, newValue])</pre>";return"undefined"==typeof r?"modify value"+i:"number"==typeof r?"modify at index "+r+i:"modify property "+s(r)+i},deleted:function(e,t,n,r){var i=" <pre>([previousValue, 0, 0])</pre>";return"undefined"==typeof r?"delete value"+i:"number"==typeof r?"remove index "+r+i:"delete property "+s(r)+i},moved:function(e,t,n,r){return'move from <span title="(position to remove at original state)">index '+r+'</span> to <span title="(position to insert at final state)">index '+e[1]+"</span>"},textdiff:function(e,t,n,r){var i="undefined"==typeof r?"":"number"==typeof r?" at index "+r:" at property "+s(r);return"text diff"+i+', format is <a href="https://code.google.com/p/google-diff-match-patch/wiki/Unidiff">a variation of Unidiff</a>'}},c=function(e,t){var n=this.getDeltaType(t),r=a[n],i=r&&r.apply(r,Array.prototype.slice.call(arguments,1)),o=JSON.stringify(t,null,2);"textdiff"===n&&(o=o.split("\\n").join('\\n"+\n   "')),e.indent(),e.row(o,i),e.indent(-1)};o.prototype.format_added=c,o.prototype.format_modified=c,o.prototype.format_deleted=c,o.prototype.format_moved=c,o.prototype.format_textdiff=c,t.AnnotatedFormatter=o;var u;t.format=function(e,t){return u||(u=new o),u.format(e,t)}},function(e,t){var n="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},r="function"==typeof Object.keys?function(e){return Object.keys(e)}:function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},i=function(e){return"_"===e.substr(0,1)?e.slice(1):e},o=function(e){return"_t"===e?-1:"_"===e.substr(0,1)?parseInt(e.slice(1),10):parseInt(e,10)+.1},s=function(e,t){return o(e)-o(t)},a=function(){};a.prototype.format=function(e,t){var n={};return this.prepareContext(n),this.recurse(n,e,t),this.finalize(n)},a.prototype.prepareContext=function(e){e.buffer=[],e.out=function(){this.buffer.push.apply(this.buffer,arguments)}},a.prototype.typeFormattterNotFound=function(e,t){throw new Error("cannot format delta type: "+t)},a.prototype.typeFormattterErrorFormatter=function(e,t){return t.toString()},a.prototype.finalize=function(e){if(n(e.buffer))return e.buffer.join("")},a.prototype.recurse=function(e,t,n,r,i,o,s){var a=t&&o,c=a?o.value:n;if("undefined"!=typeof t||"undefined"!=typeof r){var u=this.getDeltaType(t,o),f="node"===u?"a"===t._t?"array":"object":"";"undefined"!=typeof r?this.nodeBegin(e,r,i,u,f,s):this.rootBegin(e,u,f);var l;try{l=this["format_"+u]||this.typeFormattterNotFound(e,u),l.call(this,e,t,c,r,i,o)}catch(h){this.typeFormattterErrorFormatter(e,h,t,c,r,i,o),"undefined"!=typeof console&&console.error&&console.error(h.stack)}"undefined"!=typeof r?this.nodeEnd(e,r,i,u,f,s):this.rootEnd(e,u,f)}},a.prototype.formatDeltaChildren=function(e,t,n){var r=this;this.forEachDeltaKey(t,n,function(i,o,s,a){r.recurse(e,t[i],n?n[o]:void 0,i,o,s,a)})},a.prototype.forEachDeltaKey=function(e,t,o){var a,c=r(e),u="a"===e._t,f={};if("undefined"!=typeof t)for(a in t)"undefined"!=typeof e[a]||u&&"undefined"!=typeof e["_"+a]||c.push(a);for(a in e){var l=e[a];n(l)&&3===l[2]&&(f[l[1].toString()]={key:a,value:t&&t[parseInt(a.substr(1))]},this.includeMoveDestinations!==!1&&"undefined"==typeof t&&"undefined"==typeof e[l[1]]&&c.push(l[1].toString()))}u?c.sort(s):c.sort();for(var h=0,d=c.length;h<d;h++){var p=c[h];if(!u||"_t"!==p){var v=u?"number"==typeof p?p:parseInt(i(p),10):p,g=h===d-1;o(p,v,f[v],g)}}},a.prototype.getDeltaType=function(e,t){if("undefined"==typeof e)return"undefined"!=typeof t?"movedestination":"unchanged";if(n(e)){if(1===e.length)return"added";if(2===e.length)return"modified";if(3===e.length&&0===e[2])return"deleted";if(3===e.length&&2===e[2])return"textdiff";if(3===e.length&&3===e[2])return"moved"}else if("object"==typeof e)return"node";return"unknown"},a.prototype.parseTextDiff=function(e){for(var t=[],n=e.split("\n@@ "),r=0,i=n.length;r<i;r++){var o=n[r],s={pieces:[]},a=/^(?:@@ )?[-+]?(\d+),(\d+)/.exec(o).slice(1);s.location={line:a[0],chr:a[1]};for(var c=o.split("\n").slice(1),u=0,f=c.length;u<f;u++){var l=c[u];if(l.length){var h={type:"context"};"+"===l.substr(0,1)?h.type="added":"-"===l.substr(0,1)&&(h.type="deleted"),h.text=l.slice(1),s.pieces.push(h)}}t.push(s)}return t},t.BaseFormatter=a},function(e,t,n){var r=n(209),i=n(207),o=i.BaseFormatter,s={added:r.green,deleted:r.red,movedestination:r.gray,moved:r.yellow,unchanged:r.gray,error:r.white.bgRed,textDiffLine:r.gray},a=function(){this.includeMoveDestinations=!1};a.prototype=new o,a.prototype.prepareContext=function(e){o.prototype.prepareContext.call(this,e),e.indent=function(e){this.indentLevel=(this.indentLevel||0)+("undefined"==typeof e?1:e),this.indentPad=new Array(this.indentLevel+1).join("  "),this.outLine()},e.outLine=function(){this.buffer.push("\n"+(this.indentPad||""))},e.out=function(){for(var e=0,t=arguments.length;e<t;e++){var n=arguments[e].split("\n"),r=n.join("\n"+(this.indentPad||""));this.color&&this.color[0]&&(r=this.color[0](r)),this.buffer.push(r)}},e.pushColor=function(e){this.color=this.color||[],this.color.unshift(e)},e.popColor=function(){this.color=this.color||[],this.color.shift()}},a.prototype.typeFormattterErrorFormatter=function(e,t){e.pushColor(s.error),e.out("[ERROR]"+t),e.popColor()},a.prototype.formatValue=function(e,t){e.out(JSON.stringify(t,null,2))},a.prototype.formatTextDiffString=function(e,t){var n=this.parseTextDiff(t);e.indent();for(var r=0,i=n.length;r<i;r++){var o=n[r];e.pushColor(s.textDiffLine),e.out(o.location.line+","+o.location.chr+" "),e.popColor();for(var a=o.pieces,c=0,u=a.length;c<u;c++){var f=a[c];e.pushColor(s[f.type]),e.out(f.text),e.popColor()}r<i-1&&e.outLine()}e.indent(-1)},a.prototype.rootBegin=function(e,t,n){e.pushColor(s[t]),"node"===t&&(e.out("array"===n?"[":"{"),e.indent())},a.prototype.rootEnd=function(e,t,n){"node"===t&&(e.indent(-1),e.out("array"===n?"]":"}")),e.popColor()},a.prototype.nodeBegin=function(e,t,n,r,i){e.pushColor(s[r]),e.out(n+": "),"node"===r&&(e.out("array"===i?"[":"{"),e.indent())},a.prototype.nodeEnd=function(e,t,n,r,i,o){"node"===r&&(e.indent(-1),e.out("array"===i?"]":"}"+(o?"":","))),o||e.outLine(),e.popColor()},a.prototype.format_unchanged=function(e,t,n){"undefined"!=typeof n&&this.formatValue(e,n)},a.prototype.format_movedestination=function(e,t,n){"undefined"!=typeof n&&this.formatValue(e,n)},a.prototype.format_node=function(e,t,n){this.formatDeltaChildren(e,t,n)},a.prototype.format_added=function(e,t){this.formatValue(e,t[0])},a.prototype.format_modified=function(e,t){e.pushColor(s.deleted),this.formatValue(e,t[0]),e.popColor(),e.out(" => "),e.pushColor(s.added),this.formatValue(e,t[1]),e.popColor()},a.prototype.format_deleted=function(e,t){this.formatValue(e,t[0])},a.prototype.format_moved=function(e,t){e.out("==> "+t[1])},a.prototype.format_textdiff=function(e,t){this.formatTextDiffString(e,t[0])},t.ConsoleFormatter=a;var c,u=function(e,t){return c||(c=new a),c.format(e,t)};t.log=function(e,t){console.log(u(e,t))},t.format=u},function(e,t,n){"use strict";function r(e){var t=function n(){return i.apply(n,arguments)};return t._styles=e,t.__proto__=p,t}function i(){var e=arguments,t=e.length,n=0!==t&&String(arguments[0]);if(t>1)for(var r=1;r<t;r++)n+=" "+e[r];if(!h.enabled||!n)return n;for(var i=this._styles,o=0;o<i.length;o++){var s=a[i[o]];n=s.open+n.replace(s.closeRe,s.open)+s.close}return n}function o(){var e={};return Object.keys(d).forEach(function(t){e[t]={get:function(){return r([t])}}}),e}var s=n(210),a=n(211),c=n(212),u=n(214),f=n(216),l=Object.defineProperties,h=e.exports,d=function(){var e={};return a.grey=a.gray,Object.keys(a).forEach(function(t){a[t].closeRe=new RegExp(s(a[t].close),"g"),e[t]={get:function(){return r(this._styles.concat(t))}}}),e}(),p=l(function(){},d);l(h,o()),h.styles=a,h.hasColor=u,h.stripColor=c,h.supportsColor=f,void 0===h.enabled&&(h.enabled=h.supportsColor)},function(e,t){"use strict";var n=/[|\\{}()[\]^$+*?.]/g;e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(n,"\\$&")}},function(e,t){"use strict";var n=e.exports,r={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49]};Object.keys(r).forEach(function(e){var t=r[e],i=n[e]={};i.open="["+t[0]+"m",i.close="["+t[1]+"m"})},function(e,t,n){"use strict";var r=n(213)();e.exports=function(e){return"string"==typeof e?e.replace(r,""):e}},function(e,t){"use strict";e.exports=function(){return/\u001b\[(?:[0-9]{1,3}(?:;[0-9]{1,3})*)?[m|K]/g}},function(e,t,n){"use strict";var r=n(215),i=new RegExp(r().source);e.exports=i.test.bind(i)},function(e,t){"use strict";e.exports=function(){return/\u001b\[(?:[0-9]{1,3}(?:;[0-9]{1,3})*)?[m|K]/g}},function(e,t,n){(function(t){"use strict";e.exports=function(){return t.argv.indexOf("--no-color")===-1&&(t.argv.indexOf("--color")!==-1||!(t.stdout&&!t.stdout.isTTY)&&("win32"===t.platform||("COLORTERM"in t.env||"dumb"!==t.env.TERM&&!!/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(t.env.TERM))))}()}).call(t,n(1))},function(e,t,n){function r(e){for(var t=e,n=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/'/g,"&apos;"],[/"/g,"&quot;"]],r=0;r<n.length;r++)t=t.replace(n[r][0],n[r][1]);return t}var i=n(207),o=i.BaseFormatter,s=function(){};s.prototype=new o,s.prototype.typeFormattterErrorFormatter=function(e,t){e.out('<pre class="jsondiffpatch-error">'+t+"</pre>")},s.prototype.formatValue=function(e,t){e.out("<pre>"+r(JSON.stringify(t,null,2))+"</pre>")},s.prototype.formatTextDiffString=function(e,t){var n=this.parseTextDiff(t);e.out('<ul class="jsondiffpatch-textdiff">');for(var i=0,o=n.length;i<o;i++){var s=n[i];e.out('<li><div class="jsondiffpatch-textdiff-location"><span class="jsondiffpatch-textdiff-line-number">'+s.location.line+'</span><span class="jsondiffpatch-textdiff-char">'+s.location.chr+'</span></div><div class="jsondiffpatch-textdiff-line">');for(var a=s.pieces,c=0,u=a.length;c<u;c++){var f=a[c];e.out('<span class="jsondiffpatch-textdiff-'+f.type+'">'+r(unescape(f.text))+"</span>")}e.out("</div></li>")}e.out("</ul>")};var a=function(e){e=e||document;var t=function(e){return e.textContent||e.innerText},n=function(e,t,n){for(var r=e.querySelectorAll(t),i=0,o=r.length;i<o;i++)n(r[i])},r=function(e,t){for(var n=0,r=e.children.length;n<r;n++)t(e.children[n],n)};n(e,".jsondiffpatch-arrow",function(e){var n=e.parentNode,i=e.children[0],o=i.children[1];i.style.display="none";var s,a=t(n.querySelector(".jsondiffpatch-moved-destination")),c=n.parentNode;if(r(c,function(e){e.getAttribute("data-key")===a&&(s=e)}),s)try{var u=s.offsetTop-n.offsetTop;i.setAttribute("height",Math.abs(u)+6),e.style.top=-8+(u>0?0:u)+"px";var f=u>0?"M30,0 Q-10,"+Math.round(u/2)+" 26,"+(u-4):"M30,"+-u+" Q-10,"+Math.round(-u/2)+" 26,4";o.setAttribute("d",f),i.style.display=""}catch(l){return}})};s.prototype.rootBegin=function(e,t,n){var r="jsondiffpatch-"+t+(n?" jsondiffpatch-child-node-type-"+n:"");e.out('<div class="jsondiffpatch-delta '+r+'">')},s.prototype.rootEnd=function(e){e.out("</div>"+(e.hasArrows?'<script type="text/javascript">setTimeout('+a.toString()+",10);</script>":""))},s.prototype.nodeBegin=function(e,t,n,r,i){var o="jsondiffpatch-"+r+(i?" jsondiffpatch-child-node-type-"+i:"");e.out('<li class="'+o+'" data-key="'+n+'"><div class="jsondiffpatch-property-name">'+n+"</div>")},s.prototype.nodeEnd=function(e){e.out("</li>")},s.prototype.format_unchanged=function(e,t,n){"undefined"!=typeof n&&(e.out('<div class="jsondiffpatch-value">'),this.formatValue(e,n),e.out("</div>"))},s.prototype.format_movedestination=function(e,t,n){"undefined"!=typeof n&&(e.out('<div class="jsondiffpatch-value">'),this.formatValue(e,n),e.out("</div>"))},s.prototype.format_node=function(e,t,n){var r="a"===t._t?"array":"object";e.out('<ul class="jsondiffpatch-node jsondiffpatch-node-type-'+r+'">'),this.formatDeltaChildren(e,t,n),e.out("</ul>")},s.prototype.format_added=function(e,t){e.out('<div class="jsondiffpatch-value">'),this.formatValue(e,t[0]),e.out("</div>")},s.prototype.format_modified=function(e,t){e.out('<div class="jsondiffpatch-value jsondiffpatch-left-value">'),this.formatValue(e,t[0]),e.out('</div><div class="jsondiffpatch-value jsondiffpatch-right-value">'),this.formatValue(e,t[1]),e.out("</div>")},s.prototype.format_deleted=function(e,t){e.out('<div class="jsondiffpatch-value">'),this.formatValue(e,t[0]),e.out("</div>")},s.prototype.format_moved=function(e,t){e.out('<div class="jsondiffpatch-value">'),this.formatValue(e,t[0]),e.out('</div><div class="jsondiffpatch-moved-destination">'+t[1]+"</div>"),e.out('<div class="jsondiffpatch-arrow" style="position: relative; left: -34px;">\t        <svg width="30" height="60" style="position: absolute; display: none;">\t        <defs>\t            <marker id="markerArrow" markerWidth="8" markerHeight="8" refx="2" refy="4"\t                   orient="auto" markerUnits="userSpaceOnUse">\t                <path d="M1,1 L1,7 L7,4 L1,1" style="fill: #339;" />\t            </marker>\t        </defs>\t        <path d="M30,0 Q-10,25 26,50" style="stroke: #88f; stroke-width: 2px; fill: none;\t        stroke-opacity: 0.5; marker-end: url(#markerArrow);"></path>\t        </svg>\t        </div>'),e.hasArrows=!0},s.prototype.format_textdiff=function(e,t){e.out('<div class="jsondiffpatch-value">'),this.formatTextDiffString(e,t[0]),e.out("</div>")};var c=function(e,t,n){var r=t||document.body,i="jsondiffpatch-unchanged-",o={showing:i+"showing",hiding:i+"hiding",visible:i+"visible",hidden:i+"hidden"},s=r.classList;if(s){if(!n)return s.remove(o.showing),s.remove(o.hiding),s.remove(o.visible),s.remove(o.hidden),void(e===!1&&s.add(o.hidden));e===!1?(s.remove(o.showing),s.add(o.visible),setTimeout(function(){s.add(o.hiding)},10)):(s.remove(o.hiding),s.add(o.showing),s.remove(o.hidden));var c=setInterval(function(){a(r)},100);setTimeout(function(){s.remove(o.showing),s.remove(o.hiding),e===!1?(s.add(o.hidden),s.remove(o.visible)):(s.add(o.visible),s.remove(o.hidden)),setTimeout(function(){s.remove(o.visible),clearInterval(c)},n+400)},n)}},u=function(e,t){return c(!1,e,t)};t.HtmlFormatter=s,t.showUnchanged=c,t.hideUnchanged=u;var f;t.format=function(e,t){return f||(f=new s),f.format(e,t)}},function(e,t,n){var r=n(188);if(t.base=n(207),t.html=n(217),t.annotated=n(206),t.jsonpatch=n(219),!r.isBrowser){var i="./console";t.console=n(220)(i)}},function(e,t,n){!function(){function e(){this.includeMoveDestinations=!1}function r(e){return e[e.length-1]}function i(e,t){return e.sort(t),e}function o(e){return i(e,function(e,t){var n=e.path.split("/"),i=t.path.split("/");return n.length!==i.length?n.length-i.length:h(r(n),r(i))})}function s(e,t){var n=[],r=[];return e.forEach(function(e){var i=t(e)?n:r;i.push(e)}),[n,r]}function a(e){var t=s(e,function(e){return"remove"===e.op}),n=t[0],r=t[1],i=o(n);return i.concat(r)}var c=n(207),u=c.BaseFormatter,f={added:"add",deleted:"remove",modified:"replace",moved:"moved",movedestination:"movedestination",unchanged:"unchanged",error:"error",textDiffLine:"textDiffLine"};e.prototype=new u,e.prototype.prepareContext=function(e){u.prototype.prepareContext.call(this,e),e.result=[],e.path=[],e.pushCurrentOp=function(e,t){var n={op:e,path:this.currentPath()};"undefined"!=typeof t&&(n.value=t),this.result.push(n)},e.currentPath=function(){return"/"+this.path.join("/")}},e.prototype.typeFormattterErrorFormatter=function(e,t){e.out("[ERROR]"+t)},e.prototype.rootBegin=function(){},e.prototype.rootEnd=function(){},e.prototype.nodeBegin=function(e,t,n){e.path.push(n)},e.prototype.nodeEnd=function(e){e.path.pop()},e.prototype.format_unchanged=function(e,t,n){"undefined"!=typeof n&&e.pushCurrentOp(f.unchanged,n)},e.prototype.format_movedestination=function(e,t,n){"undefined"!=typeof n&&e.pushCurrentOp(f.movedestination,n)},e.prototype.format_node=function(e,t,n){this.formatDeltaChildren(e,t,n)},e.prototype.format_added=function(e,t){e.pushCurrentOp(f.added,t[0])},e.prototype.format_modified=function(e,t){e.pushCurrentOp(f.modified,t[1])},e.prototype.format_deleted=function(e){e.pushCurrentOp(f.deleted)},e.prototype.format_moved=function(e,t){e.pushCurrentOp(f.moved,t[1])},e.prototype.format_textdiff=function(){throw"not implimented"},e.prototype.format=function(e,t){var n={};return this.prepareContext(n),this.recurse(n,e,t),n.result},t.JSONFormatter=e;var l,h=function(e,t){var n=parseInt(e,10),r=parseInt(t,10);return isNaN(n)||isNaN(r)?0:r-n},d=function(t,n){return l||(l=new e),a(l.format(t,n))};t.log=function(e,t){console.log(d(e,t))},t.format=d}()},function(e,t,n){function r(e){return n(i(e))}function i(e){return o[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var o={"./annotated":206,"./annotated.js":206,"./base":207,"./base.js":207,"./console":208,"./console.js":208,"./html":217,"./html.js":217,"./index":218,"./index.js":218,"./jsonpatch":219,"./jsonpatch.js":219};r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=220},function(e,t,n){e.exports=n(218)},function(e,t,n){var r=n(188);r.isBrowser&&(window.diff_match_patch=n(204)),e.exports=n(187)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(185),a=r(s),c=n(173),u=r(c),f=n(182),l=r(f),h=n(184),d=r(h),p=function(){function e(t,n){i(this,e),this._event=new a["default"](l["default"]),this._monitor=t,this._options=n,this.objects={},this.objectsArray=[]}return o(e,[{key:"subscribe",value:function(){var e=this;u["default"].call("object/subscribe",this._options,function(t,n){if(t)e._event.emit("error",(0,d["default"])("Subscribe failed with error: "+t));else{var r;for(r=0;r<n.body.content.length;r++)e.objects[n.body.content[r].id]=n.body.content[r];e.objectsArray=n.body.content;var i=Object.keys(e.objects);for(r=0;r<i.length;r++)e.objects[i[r]].$$event=new a["default"](l["default"]);e._monitor.add(e._options,e.objects,e._event,e.add.bind(e),e.remove.bind(e),e.update.bind(e)),e._event.emit("subscribe")}})}},{key:"unsubscribe",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0];u["default"].call("object/unsubscribe",this._options,function(n){n?(e._event.emit("error",(0,d["default"])("Unsubscribe failed with error: "+n)),t(n)):(e.objects={},e.objectsArray=[],e._monitor.remove(e._options),e._event.emit("unsubscribe"),e._event.emit("_unsubscribe"),t())})}},{key:"add",value:function(e){var t=this;u["default"].call("object/create",{model:this._options.channel.model,context:this._options.channel.context||e.context_id,content:e},function(e){e&&t._event.emit("error",(0,d["default"])("Adding object failed with error: "+e))})}},{key:"remove",value:function(e){var t=this;u["default"].del("object/delete",{model:this._options.channel.model,context:this._options.channel.context||this.objects[e].context_id,id:e},function(e){e&&t._event.emit("error",(0,d["default"])("Removing object failed with error: "+e))})}},{key:"update",value:function(e,t){var n=this;u["default"].call("object/update",{model:this._options.channel.model,context:this._options.channel.context||this.objects[e].context_id,id:e,patches:t},function(e){e&&n._event.emit("error",(0,d["default"])("Updating object failed with error: "+e))})}},{key:"on",value:function(e,t){return this._event.on(e,t)}},{key:"removeCallback",value:function(e,t){return this._event.removeCallback(e,t)}}]),e}();t["default"]=p,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(173),a=r(s),c=n(182),u=r(c),f=n(184),l=r(f),h=n(225),d=r(h),p=function(){function e(t,n,r,o){var s=this,c=arguments.length<=4||void 0===arguments[4]?function(){}:arguments[4];i(this,e),this._event=n,this._monitor=r,this._setAdmin=o,this._db=t,this._customProperties=[],this.isAdmin=!1,this.canReauth=null,this.data={},a["default"].tokenUpdateCallback=function(e){s._saveToken(e)},this._db.get(":userToken").then(function(e){s.canReauth=!0,c()})["catch"](function(){s.canReauth=!1,c()})}return o(e,[{key:"_saveToken",value:function(e){var t=this,n={_id:":userToken",value:{token:e,admin:this.isAdmin}};this._db.get(":userToken").then(function(e){n._rev=e._rev,u["default"].info("Replacing existing authentication token"),t._db.put(n).then(function(e){t.canReauth=!0})["catch"](function(e){u["default"].warn("Could not persist authentication token. Error: "+e)})})["catch"](function(){t._db.put(n).then(function(e){t.canReauth=!0})["catch"](function(e){u["default"].warn("Could not persist authentication token. Error: "+e)})})}},{key:"_login",value:function(e,t,n){function r(e){for(var t in e.body.content.user)o.data[t]=e.body.content.user[t],o._customProperties.push(t);n&&(o.isAdmin=!0,o._setAdmin(new d["default"](o))),a["default"].authenticationToken=e.body.content.token,o._saveToken(a["default"].authenticationToken),o._event.emit("login"),i(null,o)}var i=arguments.length<=3||void 0===arguments[3]?function(){}:arguments[3],o=this;a["default"].call(e,t,function(n,s){n?404===n.status&&t.hasOwnProperty("access_token")?(u["default"].info("Got 404 on Facebook login, registering user first"),a["default"].call("user/register_facebook",t,function(n,i){n?(u["default"].error("Failed to login with Facebook. Could not register or login user."),o._event.emit("login_error",(0,l["default"])("Login failed with error: "+n))):a["default"].call(e,t,function(e,t){e?(u["default"].error("Failed to login with Facebook. User registration was successful, but login failed."),o._event.emit("login_error",(0,l["default"])("Login failed with error: "+e))):r(t)})})):(o._event.emit("login_error",(0,l["default"])("Login failed with error: "+n)),i(n,null)):r(s)})}},{key:"reauth",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0];this._db.get(":userToken").then(function(n){u["default"].info("Retrieved saved authentication token"),a["default"].authenticationToken=n.value.token,a["default"].get(n.value.admin?"admin/me":"user/me","",function(e,r){if(e)a["default"].authenticationToken=null,this._setAdmin(null),this._db.remove(n._id,n._rev),t((0,l["default"])("Saved authentication token expired"),null),this._customProperties=[],this.data={},this._event.emit("logout");else{for(var i in r.body.content)this.data[i]=r.body.content[i],this._customProperties.push(i);"admin"===r.body.content.type&&(this.isAdmin=!0,this._saveToken(a["default"].authenticationToken),this._setAdmin(new d["default"](this))),t(null,r),this._event.emit("login")}}.bind(e))})["catch"](function(e){t((0,l["default"])("Error retrieving authentication token: "+e),null)})}},{key:"update",value:function(){var e=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0],t={};for(var n in self)self.hasOwnProperty(n)&&(t[n]=self[n]);a["default"].call("user/update_immediate",{user:t},function(t,n){t?e((0,l["default"])("Updating user failed with error: "+t),null):e(null,n.body.content)})}},{key:"requestPasswordReset",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=arguments.length<=2||void 0===arguments[2]?function(){}:arguments[2];if(!e){if(!this.email)return void n((0,l["default"])("You must provide a valid email address for the account that needs the password reset"),null);e=this.email}a["default"].call("user/request_password_reset",{type:"app",username:e,callbackUrl:t},function(e,t){e?n((0,l["default"])("Password reset request failed with error: "+e),null):n(null,t.body.content)})}},{key:"resetPassword",value:function(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?function(){}:arguments[3];return e&&t&&n?void a["default"].call("user/request_password_reset",{token:t,user_id:e,password:n},function(e,t){e?r((0,l["default"])("Password reset request failed with error: "+e),null):r(null,t.body.content)}):void r((0,l["default"])("You must provide a valid user-id, pass reset token and new password for the account that needs the password reset"),null)}},{key:"register",value:function(e,t){a["default"].call("user/register-username",e,t)}},{key:"registerAdmin",value:function(e,t){a["default"].call("admin/add",e,function(e,n){e?t((0,l["default"])("Register failed with error: "+n.body.message||""),null):t(null,n.body.content)})}},{key:"loginWithFacebook",value:function(e,t){return this._login("user/login-facebook",{access_token:e},!1,t)}},{key:"login",value:function(e,t,n){return this._login("user/login_password",{username:e,password:t},!1,n)}},{key:"loginAdmin",value:function(e,t,n){return this._login("admin/login",{email:e,password:t},!0,n)}},{key:"get",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];a["default"].get("user/get","user_id="+encodeURIComponent(e),function(e,n){e?t(console.error("Request failed with error: "+e),null):t(null,JSON.parse(n.text).content)})}},{key:"me",value:function(){var e=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0];a["default"].get(this.isAdmin?"admin/me":"user/me","",function(t,n){t?e(console.error("Request failed with error: "+t),null):e(null,JSON.parse(n.text).content)})}},{key:"logout",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0];this._db.get(":userToken").then(function(t){e._db.remove(t._id,t._rev)})["catch"](function(){}),this._setAdmin(null),this.isAdmin=!1,this.canReauth=!1,this._customProperties=[],this.data={},a["default"].get("user/logout","",function(n){a["default"].authenticationToken=null,n?(e._event.emit("logout_error",(0,l["default"])("Logout failed with error: "+n)),t(n)):(e._event.emit("logout"),t())})}}]),e}();t["default"]=p,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(173),a=r(s),c=n(184),u=r(c),f=function(){function e(t){i(this,e),this.users=null,this._user=t,this._monitor=t._monitor,this._event=t._event,this.apps=null,this.app=null}return o(e,[{key:"getAppUsers",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0];a["default"].call("admin/users",{},function(n,r){n?t((0,u["default"])("Retrieving users failed with error: "+n),null):(e.users=r.body.content,e._monitor.add({channel:{model:"user"}},e.users,null,e.addUser,e.deleteUser,e.updateUser),t(null,e.users))})}},{key:"getAppUser",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];a["default"].call("user/get","user_id="+e,function(e,n){e?t((0,u["default"])("Retrieving user failed with error: "+e),null):t(null,n.body.content)},"get")}},{key:"getApps",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0];a["default"].call("admin/apps","",function(n,r){if(n)t((0,u["default"])("Retrieving apps failed with error: "+n),null);else{e.apps={};for(var i in r.body.content){var o=r.body.content[i];e.apps[o.id]=o}e.app=e.apps[a["default"].appId],e._monitor.add({channel:{model:"application"}},e.apps,null,e.addApp,e.deleteApp,e.updateApp),t(null,r.body.content)}},"get")}},{key:"addApp",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];a["default"].call("admin/app/add",e,function(e,n){e?t((0,u["default"])("Adding application failed with error: "+e),null):t(null,n.body.content)})}},{key:"updateApp",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?function(){}:arguments[2];return e!==a["default"].appId?n((0,u["default"])("Cannot update an app that is not active. Please reconnect to that specific app id to make updates.")):void a["default"].call("admin/app/update",{id:e,patches:t},function(e,t){return e?n((0,u["default"])("Updating application failed with error: "+e)):void n()})}},{key:"deleteApp",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];a["default"].del("admin/app/remove",{id:e},function(e,n){e?t((0,u["default"])("Removing application failed with error: "+e),null):t()})}},{key:"addContext",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];a["default"].call("admin/context/add",e,function(e,n){return e?t((0,u["default"])("Creating context failed with error: "+e)):void t(null,n)})}},{key:"updateContext",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?function(){}:arguments[2];a["default"].call("admin/context/update",{id:e,patches:t},function(e,t){return e?n((0,u["default"])("Updating context failed with error: "+e)):void n()})}},{key:"deleteContext",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];a["default"].del("admin/context/remove",{id:e},function(e,n){return e?t((0,u["default"])("Deleting context failed with error: "+e)):void t()})}},{key:"deleteModel",value:function(e,t){a["default"].del("admin/schema/remove_model",{model_name:e},function(e,n){return e?t((0,u["default"])("Deleting model failed with error: "+e)):void t()})}},{key:"updateAdmin",value:function(e,t){a["default"].call("admin/update",{patches:e},function(e,n){return e?t((0,u["default"])("Failed updating admin: "+n.body.message)):void t()})}},{key:"addUser",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];this._user.register(e,t)}},{key:"deleteUser",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];a["default"].del("admin/user/delete",{username:e},function(e,n){e?t((0,u["default"])("Removing user failed with error: "+e),null):t();
})}},{key:"updateUser",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];a["default"].call("admin/user/update",{patches:e},function(e,n){e?t((0,u["default"])("Removing user failed with error: "+e),null):t()})}},{key:"authorize",value:function(e,t){a["default"].call("/admin/app/authorize",{email:e},function(e,n){return e?t((0,u["default"])("Authorizing admin failed with error: "+e),null):void t()})}},{key:"deauthorize",value:function(e,t){a["default"].call("/admin/app/deauthorize",{email:e},function(e,n){return e?t((0,u["default"])("Deauthorizing admin failed with error: "+e),null):void t()})}},{key:"unhook",value:function(){this._monitor.remove({channel:{model:"user"}}),this._monitor.remove({channel:{model:"application"}})}}]),e}();t["default"]=f,e.exports=t["default"]},function(e,t,n){function r(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r=i(e),o=r.source,u=r.id,f=r.path,l=c[u]&&f in c[u].nsps,h=t.forceNew||t["force new connection"]||!1===t.multiplex||l;return h?(a("ignoring socket cache for %s",o),n=s(o,t)):(c[u]||(a("new io instance for %s",o),c[u]=s(o,t)),n=c[u]),n.socket(r.path)}var i=n(227),o=n(232),s=n(240),a=n(229)("socket.io-client");e.exports=t=r;var c=t.managers={};t.protocol=o.protocol,t.connect=r,t.Manager=n(240),t.Socket=n(268)},function(e,t,n){(function(t){function r(e,n){var r=e,n=n||t.location;null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!=typeof n?n.protocol+"//"+e:"https://"+e),o("parse %s",e),r=i(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var s=r.host.indexOf(":")!==-1,a=s?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port,r.href=r.protocol+"://"+a+(n&&n.port==r.port?"":":"+r.port),r}var i=n(228),o=n(229)("socket.io-client:url");e.exports=r}).call(t,function(){return this}())},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");i!=-1&&o!=-1&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var s=n.exec(e||""),a={},c=14;c--;)a[r[c]]=s[c]||"";return i!=-1&&o!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(e,t,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,r),e}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}}function a(){var e;try{e=t.storage.debug}catch(n){}return e}function c(){try{return window.localStorage}catch(e){}}t=e.exports=n(230),t.log=o,t.formatArgs=i,t.save=s,t.load=a,t.useColors=r,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(a())},function(e,t,n){function r(){return t.colors[f++%t.colors.length]}function i(e){function n(){}function i(){var e=i,n=+new Date,o=n-(u||n);e.diff=o,e.prev=u,e.curr=n,u=n,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=r());var s=Array.prototype.slice.call(arguments);s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(n,r){if("%%"===n)return n;a++;var i=t.formatters[r];if("function"==typeof i){var o=s[a];n=i.call(e,o),s.splice(a,1),a--}return n}),"function"==typeof t.formatArgs&&(s=t.formatArgs.apply(e,s));var c=i.log||t.log||console.log.bind(console);c.apply(e,s)}n.enabled=!1,i.enabled=!0;var o=t.enabled(e)?i:n;return o.namespace=e,o}function o(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&(e=n[i].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function s(){t.enable("")}function a(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=i,t.coerce=c,t.disable=s,t.enable=o,t.enabled=a,t.humanize=n(231),t.names=[],t.skips=[],t.formatters={};var u,f=0},function(e,t){function n(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*f;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*a;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function r(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=a?Math.round(e/a)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function i(e){return o(e,u,"day")||o(e,c,"hour")||o(e,a,"minute")||o(e,s,"second")||e+" ms"}function o(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var s=1e3,a=60*s,c=60*a,u=24*c,f=365.25*u;e.exports=function(e,t){return t=t||{},"string"==typeof e?n(e):t["long"]?i(e):r(e)}},function(e,t,n){function r(){}function i(e){var n="",r=!1;return n+=e.type,t.BINARY_EVENT!=e.type&&t.BINARY_ACK!=e.type||(n+=e.attachments,n+="-"),e.nsp&&"/"!=e.nsp&&(r=!0,n+=e.nsp),null!=e.id&&(r&&(n+=",",r=!1),n+=e.id),null!=e.data&&(r&&(n+=","),n+=l.stringify(e.data)),f("encoded %j as %s",e,n),n}function o(e,t){function n(e){var n=d.deconstructPacket(e),r=i(n.packet),o=n.buffers;o.unshift(r),t(o)}d.removeBlobs(e,n)}function s(){this.reconstructor=null}function a(e){var n={},r=0;if(n.type=Number(e.charAt(0)),null==t.types[n.type])return u();if(t.BINARY_EVENT==n.type||t.BINARY_ACK==n.type){for(var i="";"-"!=e.charAt(++r)&&(i+=e.charAt(r),r!=e.length););if(i!=Number(i)||"-"!=e.charAt(r))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"==e.charAt(r+1))for(n.nsp="";++r;){var o=e.charAt(r);if(","==o)break;if(n.nsp+=o,r==e.length)break}else n.nsp="/";var s=e.charAt(r+1);if(""!==s&&Number(s)==s){for(n.id="";++r;){var o=e.charAt(r);if(null==o||Number(o)!=o){--r;break}if(n.id+=e.charAt(r),r==e.length)break}n.id=Number(n.id)}if(e.charAt(++r))try{n.data=l.parse(e.substr(r))}catch(a){return u()}return f("decoded %s as %j",e,n),n}function c(e){this.reconPack=e,this.buffers=[]}function u(e){return{type:t.ERROR,data:"parser error"}}var f=n(229)("socket.io-parser"),l=n(233),h=(n(236),n(237)),d=n(238),p=n(239);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=s,r.prototype.encode=function(e,n){if(f("encoding packet %j",e),t.BINARY_EVENT==e.type||t.BINARY_ACK==e.type)o(e,n);else{var r=i(e);n([r])}},h(s.prototype),s.prototype.add=function(e){var n;if("string"==typeof e)n=a(e),t.BINARY_EVENT==n.type||t.BINARY_ACK==n.type?(this.reconstructor=new c(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!p(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,this.emit("decoded",n))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},c.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=d.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},c.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){var r;(function(e,i){(function(){function o(e,t){function n(e){if(n[e]!==g)return n[e];var o;if("bug-string-char-index"==e)o="a"!="a"[0];else if("json"==e)o=n("json-stringify")&&n("json-parse");else{var s,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var u=t.stringify,f="function"==typeof u&&b;if(f){(s=function(){return 1}).toJSON=s;try{f="0"===u(0)&&"0"===u(new r)&&'""'==u(new i)&&u(m)===g&&u(g)===g&&u()===g&&"1"===u(s)&&"[1]"==u([s])&&"[null]"==u([g])&&"null"==u(null)&&"[null,null,null]"==u([g,m,null])&&u({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===u(null,s)&&"[\n 1,\n 2\n]"==u([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==u(new c((-864e13)))&&'"+275760-09-13T00:00:00.000Z"'==u(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==u(new c((-621987552e5)))&&'"1969-12-31T23:59:59.999Z"'==u(new c((-1)))}catch(l){f=!1}}o=f}if("json-parse"==e){var h=t.parse;if("function"==typeof h)try{if(0===h("0")&&!h(!1)){s=h(a);var d=5==s.a.length&&1===s.a[0];if(d){try{d=!h('"\t"')}catch(l){}if(d)try{d=1!==h("01")}catch(l){}if(d)try{d=1!==h("1.")}catch(l){}}}}catch(l){d=!1}o=d}}return n[e]=!!o}e||(e=u.Object()),t||(t=u.Object());var r=e.Number||u.Number,i=e.String||u.String,s=e.Object||u.Object,c=e.Date||u.Date,f=e.SyntaxError||u.SyntaxError,l=e.TypeError||u.TypeError,h=e.Math||u.Math,d=e.JSON||u.JSON;"object"==typeof d&&d&&(t.stringify=d.stringify,t.parse=d.parse);var p,v,g,y=s.prototype,m=y.toString,b=new c((-0xc782b5b800cec));try{b=b.getUTCFullYear()==-109252&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()}catch(_){}if(!n("json")){var w="[object Function]",E="[object Date]",k="[object Number]",x="[object String]",S="[object Array]",A="[object Boolean]",T=n("bug-string-char-index");if(!b)var O=h.floor,R=[0,31,59,90,120,151,181,212,243,273,304,334],C=function(e,t){return R[t]+365*(e-1970)+O((e-1969+(t=+(t>1)))/4)-O((e-1901+t)/100)+O((e-1601+t)/400)};if((p=y.hasOwnProperty)||(p=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=m?p=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,p=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,p.call(this,e)}),v=function(e,t){var n,r,i,o=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,r=new n;for(i in r)p.call(r,i)&&o++;return n=r=null,o?v=2==o?function(e,t){var n,r={},i=m.call(e)==w;for(n in e)i&&"prototype"==n||p.call(r,n)||!(r[n]=1)||!p.call(e,n)||t(n)}:function(e,t){var n,r,i=m.call(e)==w;for(n in e)i&&"prototype"==n||!p.call(e,n)||(r="constructor"===n)||t(n);(r||p.call(e,n="constructor"))&&t(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],v=function(e,t){var n,i,o=m.call(e)==w,s=!o&&"function"!=typeof e.constructor&&a[typeof e.hasOwnProperty]&&e.hasOwnProperty||p;for(n in e)o&&"prototype"==n||!s.call(e,n)||t(n);for(i=r.length;n=r[--i];s.call(e,n)&&t(n));}),v(e,t)},!n("json-stringify")){var j={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},D="000000",L=function(e,t){return(D+(t||0)).slice(-e)},I="\\u00",N=function(e){for(var t='"',n=0,r=e.length,i=!T||r>10,o=i&&(T?e.split(""):e);n<r;n++){var s=e.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=j[s];break;default:if(s<32){t+=I+L(2,s.toString(16));break}t+=i?o[n]:e.charAt(n)}}return t+'"'},B=function(e,t,n,r,i,o,s){var a,c,u,f,h,d,y,b,_,w,T,R,j,D,I,M;try{a=t[e]}catch(P){}if("object"==typeof a&&a)if(c=m.call(a),c!=E||p.call(a,"toJSON"))"function"==typeof a.toJSON&&(c!=k&&c!=x&&c!=S||p.call(a,"toJSON"))&&(a=a.toJSON(e));else if(a>-1/0&&a<1/0){if(C){for(h=O(a/864e5),u=O(h/365.2425)+1970-1;C(u+1,0)<=h;u++);for(f=O((h-C(u,0))/30.42);C(u,f+1)<=h;f++);h=1+h-C(u,f),d=(a%864e5+864e5)%864e5,y=O(d/36e5)%24,b=O(d/6e4)%60,_=O(d/1e3)%60,w=d%1e3}else u=a.getUTCFullYear(),f=a.getUTCMonth(),h=a.getUTCDate(),y=a.getUTCHours(),b=a.getUTCMinutes(),_=a.getUTCSeconds(),w=a.getUTCMilliseconds();a=(u<=0||u>=1e4?(u<0?"-":"+")+L(6,u<0?-u:u):L(4,u))+"-"+L(2,f+1)+"-"+L(2,h)+"T"+L(2,y)+":"+L(2,b)+":"+L(2,_)+"."+L(3,w)+"Z"}else a=null;if(n&&(a=n.call(t,e,a)),null===a)return"null";if(c=m.call(a),c==A)return""+a;if(c==k)return a>-1/0&&a<1/0?""+a:"null";if(c==x)return N(""+a);if("object"==typeof a){for(D=s.length;D--;)if(s[D]===a)throw l();if(s.push(a),T=[],I=o,o+=i,c==S){for(j=0,D=a.length;j<D;j++)R=B(j,a,n,r,i,o,s),T.push(R===g?"null":R);M=T.length?i?"[\n"+o+T.join(",\n"+o)+"\n"+I+"]":"["+T.join(",")+"]":"[]"}else v(r||a,function(e){var t=B(e,a,n,r,i,o,s);t!==g&&T.push(N(e)+":"+(i?" ":"")+t)}),M=T.length?i?"{\n"+o+T.join(",\n"+o)+"\n"+I+"}":"{"+T.join(",")+"}":"{}";return s.pop(),M}};t.stringify=function(e,t,n){var r,i,o,s;if(a[typeof t]&&t)if((s=m.call(t))==w)i=t;else if(s==S){o={};for(var c,u=0,f=t.length;u<f;c=t[u++],s=m.call(c),(s==x||s==k)&&(o[c]=1));}if(n)if((s=m.call(n))==k){if((n-=n%1)>0)for(r="",n>10&&(n=10);r.length<n;r+=" ");}else s==x&&(r=n.length<=10?n:n.slice(0,10));return B("",(c={},c[""]=e,c),i,o,r,"",[])}}if(!n("json-parse")){var M,P,q=i.fromCharCode,U={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},F=function(){throw M=P=null,f()},H=function(){for(var e,t,n,r,i,o=P,s=o.length;M<s;)switch(i=o.charCodeAt(M)){case 9:case 10:case 13:case 32:M++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=T?o.charAt(M):o[M],M++,e;case 34:for(e="@",M++;M<s;)if(i=o.charCodeAt(M),i<32)F();else if(92==i)switch(i=o.charCodeAt(++M)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=U[i],M++;break;case 117:for(t=++M,n=M+4;M<n;M++)i=o.charCodeAt(M),i>=48&&i<=57||i>=97&&i<=102||i>=65&&i<=70||F();e+=q("0x"+o.slice(t,M));break;default:F()}else{if(34==i)break;for(i=o.charCodeAt(M),t=M;i>=32&&92!=i&&34!=i;)i=o.charCodeAt(++M);e+=o.slice(t,M)}if(34==o.charCodeAt(M))return M++,e;F();default:if(t=M,45==i&&(r=!0,i=o.charCodeAt(++M)),i>=48&&i<=57){for(48==i&&(i=o.charCodeAt(M+1),i>=48&&i<=57)&&F(),r=!1;M<s&&(i=o.charCodeAt(M),i>=48&&i<=57);M++);if(46==o.charCodeAt(M)){for(n=++M;n<s&&(i=o.charCodeAt(n),i>=48&&i<=57);n++);n==M&&F(),M=n}if(i=o.charCodeAt(M),101==i||69==i){for(i=o.charCodeAt(++M),43!=i&&45!=i||M++,n=M;n<s&&(i=o.charCodeAt(n),i>=48&&i<=57);n++);n==M&&F(),M=n}return+o.slice(t,M)}if(r&&F(),"true"==o.slice(M,M+4))return M+=4,!0;if("false"==o.slice(M,M+5))return M+=5,!1;if("null"==o.slice(M,M+4))return M+=4,null;F()}return"$"},W=function(e){var t,n;if("$"==e&&F(),"string"==typeof e){if("@"==(T?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=H(),"]"!=e;n||(n=!0))n&&(","==e?(e=H(),"]"==e&&F()):F()),","==e&&F(),t.push(W(e));return t}if("{"==e){for(t={};e=H(),"}"!=e;n||(n=!0))n&&(","==e?(e=H(),"}"==e&&F()):F()),","!=e&&"string"==typeof e&&"@"==(T?e.charAt(0):e[0])&&":"==H()||F(),t[e.slice(1)]=W(H());return t}F()}return e},z=function(e,t,n){var r=J(e,t,n);r===g?delete e[t]:e[t]=r},J=function(e,t,n){var r,i=e[t];if("object"==typeof i&&i)if(m.call(i)==S)for(r=i.length;r--;)z(i,r,n);else v(i,function(e){z(i,e,n)});return n.call(e,t,i)};t.parse=function(e,t){var n,r;return M=0,P=""+e,n=W(H()),"$"!=H()&&F(),M=P=null,t&&m.call(t)==w?J((r={},r[""]=n,r),"",t):n}}}return t.runInContext=o,t}var s=n(235),a={"function":!0,object:!0},c=a[typeof t]&&t&&!t.nodeType&&t,u=a[typeof window]&&window||this,f=c&&a[typeof e]&&e&&!e.nodeType&&"object"==typeof i&&i;if(!f||f.global!==f&&f.window!==f&&f.self!==f||(u=f),c&&!s)o(u,c);else{var l=u.JSON,h=u.JSON3,d=!1,p=o(u,u.JSON3={noConflict:function(){return d||(d=!0,u.JSON=l,u.JSON3=h,l=h=null),p}});u.JSON={parse:p.parse,stringify:p.stringify}}s&&(r=function(){return p}.call(t,n,t,e),!(void 0!==r&&(e.exports=r)))}).call(this)}).call(t,n(234)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){r.off(e,n),t.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(e){var r=n(236),i=n(239);t.deconstructPacket=function(e){function t(e){if(!e)return e;if(i(e)){var o={_placeholder:!0,num:n.length};return n.push(e),o}if(r(e)){for(var s=new Array(e.length),a=0;a<e.length;a++)s[a]=t(e[a]);return s}if("object"==typeof e&&!(e instanceof Date)){var s={};for(var c in e)s[c]=t(e[c]);return s}return e}var n=[],o=e.data,s=e;return s.data=t(o),s.attachments=n.length,{packet:s,buffers:n}},t.reconstructPacket=function(e,t){function n(e){if(e&&e._placeholder){var i=t[e.num];return i}if(r(e)){for(var o=0;o<e.length;o++)e[o]=n(e[o]);return e}if(e&&"object"==typeof e){for(var s in e)e[s]=n(e[s]);return e}return e}return e.data=n(e.data),e.attachments=void 0,e},t.removeBlobs=function(t,n){function o(t,c,u){if(!t)return t;if(e.Blob&&t instanceof Blob||e.File&&t instanceof File){s++;var f=new FileReader;f.onload=function(){u?u[c]=this.result:a=this.result,--s||n(a)},f.readAsArrayBuffer(t)}else if(r(t))for(var l=0;l<t.length;l++)o(t[l],l,t);else if(t&&"object"==typeof t&&!i(t))for(var h in t)o(t[h],h,t)}var s=0,a=t;o(a),s||n(a)}}).call(t,function(){return this}())},function(e,t){(function(t){function n(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}e.exports=n}).call(t,function(){return this}())},function(e,t,n){function r(e,t){return this instanceof r?(e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new a.Encoder,this.decoder=new a.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new r(e,t)}var i=n(241),o=n(268),s=n(269),a=n(232),c=n(271),u=n(272),f=n(229)("socket.io-client:manager"),l=n(266),h=n(275),d=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)d.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)d.call(this.nsps,e)&&(this.nsps[e].id=this.engine.id)},s(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e){if(f("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;f("opening %s",this.uri),this.engine=i(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var r=c(t,"open",function(){n.onopen(),e&&e()}),o=c(t,"error",function(t){if(f("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;f("connect attempt will timeout after %d",s);var a=setTimeout(function(){f("connect attempt timed out after %d",s),r.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(r),this.subs.push(o),this},r.prototype.onopen=function(){f("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(c(e,"data",u(this,"ondata"))),this.subs.push(c(e,"ping",u(this,"onping"))),this.subs.push(c(e,"pong",u(this,"onpong"))),this.subs.push(c(e,"error",u(this,"onerror"))),this.subs.push(c(e,"close",u(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",u(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){f("error",e),this.emitAll("error",e)},r.prototype.socket=function(e){function t(){~l(r.connecting,n)||r.connecting.push(n)}var n=this.nsps[e];if(!n){n=new o(this,e),this.nsps[e]=n;var r=this;n.on("connecting",t),n.on("connect",function(){n.id=r.engine.id}),this.autoConnect&&t()}return n},r.prototype.destroy=function(e){var t=l(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){f("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){f("cleanup");for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){f("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"==this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){f("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)f("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();f("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(f("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(f("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(f("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(242)},function(e,t,n){e.exports=n(243),e.exports.parser=n(250)},function(e,t,n){(function(t){function r(e,n){if(!(this instanceof r))return new r(e,n);n=n||{},e&&"object"==typeof e&&(n=e,e=null),e?(e=f(e),n.hostname=e.host,n.secure="https"==e.protocol||"wss"==e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=f(n.host).host),this.secure=null!=n.secure?n.secure:t.location&&"https:"==location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(t.location?location.hostname:"localhost"),this.port=n.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=h.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized||n.rejectUnauthorized;var i="object"==typeof t&&t;i.global===i&&n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),this.open()}function i(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var o=n(244),s=n(259),a=n(229)("engine.io-client:socket"),c=n(266),u=n(250),f=n(228),l=n(267),h=n(260);e.exports=r,r.priorWebsocketSuccess=!1,s(r.prototype),r.protocol=u.protocol,r.Socket=r,r.Transport=n(249),r.transports=n(244),r.parser=n(250),r.prototype.createTransport=function(e){a('creating transport "%s"',e);var t=i(this.query);t.EIO=u.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new o[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders});return n},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1)e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(n){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},r.prototype.probe=function(e){function t(){if(h.onlyBinaryUpgrades){var t=!this.supportsBinary&&h.transport.supportsBinary;l=l||t}l||(a('probe transport "%s" opened',e),f.send([{type:"ping",data:"probe"}]),f.once("packet",function(t){if(!l)if("pong"==t.type&&"probe"==t.data){if(a('probe transport "%s" pong',e),h.upgrading=!0,h.emit("upgrading",f),!f)return;r.priorWebsocketSuccess="websocket"==f.name,a('pausing current transport "%s"',h.transport.name),h.transport.pause(function(){l||"closed"!=h.readyState&&(a("changing transport and sending upgrade packet"),u(),h.setTransport(f),f.send([{type:"upgrade"}]),h.emit("upgrade",f),f=null,h.upgrading=!1,h.flush())})}else{a('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=f.name,h.emit("upgradeError",n)}}))}function n(){l||(l=!0,u(),f.close(),f=null)}function i(t){var r=new Error("probe error: "+t);r.transport=f.name,n(),a('probe transport "%s" failed because of error: %s',e,t),h.emit("upgradeError",r)}function o(){i("transport closed")}function s(){i("socket closed")}function c(e){f&&e.name!=f.name&&(a('"%s" works - aborting "%s"',e.name,f.name),n())}function u(){f.removeListener("open",t),f.removeListener("error",i),f.removeListener("close",o),h.removeListener("close",s),h.removeListener("upgrading",c)}a('probing transport "%s"',e);var f=this.createTransport(e,{probe:1}),l=!1,h=this;r.priorWebsocketSuccess=!1,f.once("open",t),f.once("error",i),f.once("close",o),this.once("close",s),this.once("upgrading",c),f.open()},r.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(l(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),
this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},r.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!=this.readyState&&"closed"!=this.readyState){n=n||{},n.compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),a("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},r.prototype.onError=function(e){a("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){a('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}},r.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~c(this.transports,e[n])&&t.push(e[n]);return t}}).call(t,function(){return this}())},function(e,t,n){(function(e){function r(t){var n,r=!1,a=!1,c=!1!==t.jsonp;if(e.location){var u="https:"==location.protocol,f=location.port;f||(f=u?443:80),r=t.hostname!=location.hostname||f!=t.port,a=t.secure!=u}if(t.xdomain=r,t.xscheme=a,n=new i(t),"open"in n&&!t.forceJSONP)return new o(t);if(!c)throw new Error("JSONP disabled");return new s(t)}var i=n(245),o=n(247),s=n(263),a=n(264);t.polling=r,t.websocket=a}).call(t,function(){return this}())},function(e,t,n){var r=n(246);e.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(o){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(o){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(o){}}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(n){e.exports=!1}},function(e,t,n){(function(t){function r(){}function i(e){if(c.call(this,e),t.location){var n="https:"==location.protocol,r=location.port;r||(r=n?443:80),this.xd=e.hostname!=t.location.hostname||r!=e.port,this.xs=e.secure!=n}else this.extraHeaders=e.extraHeaders}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function s(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var a=n(245),c=n(248),u=n(259),f=n(261),l=n(229)("engine.io-client:polling-xhr");e.exports=i,e.exports.Request=o,f(i,c),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.extraHeaders=this.extraHeaders,new o(e)},i.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=r},i.prototype.doPoll=function(){l("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},u(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new a(e),r=this;try{l("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders){n.setDisableHeaderCheck(!0);for(var i in this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this.extraHeaders[i])}}catch(s){}if(this.supportsBinary&&(n.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(s){}"withCredentials"in n&&(n.withCredentials=!0),this.hasXDR()?(n.onload=function(){r.onLoad()},n.onerror=function(){r.onError(n.responseText)}):n.onreadystatechange=function(){4==n.readyState&&(200==n.status||1223==n.status?r.onLoad():setTimeout(function(){r.onError(n.status)},0))},l("xhr data %s",this.data),n.send(this.data)}catch(s){return void setTimeout(function(){r.onError(s)},0)}t.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(n){}t.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(n){}if("application/octet-stream"===t)e=this.xhr.response;else if(this.supportsBinary)try{e=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(n){for(var r=new Uint8Array(this.xhr.response),i=[],o=0,s=r.length;o<s;o++)i.push(r[o]);e=String.fromCharCode.apply(null,i)}else e=this.xhr.responseText}catch(n){this.onError(n)}null!=e&&this.onData(e)},o.prototype.hasXDR=function(){return"undefined"!=typeof t.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},t.document&&(o.requestsCount=0,o.requests={},t.attachEvent?t.attachEvent("onunload",s):t.addEventListener&&t.addEventListener("beforeunload",s,!1))}).call(t,function(){return this}())},function(e,t,n){function r(e){var t=e&&e.forceBase64;f&&!t||(this.supportsBinary=!1),i.call(this,e)}var i=n(249),o=n(260),s=n(250),a=n(261),c=n(262),u=n(229)("engine.io-client:polling");e.exports=r;var f=function(){var e=n(245),t=new e({xdomain:!1});return null!=t.responseType}();a(r,i),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){u("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){u("pre-pause polling complete"),--r||t()})),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",function(){u("pre-pause writing complete"),--r||t()}))}else t()},r.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;u("polling got data %s",e);var n=function(e,n,r){return"opening"==t.readyState&&t.onOpen(),"close"==e.type?(t.onClose(),!1):void t.onPacket(e)};s.decodePayload(e,this.socket.binaryType,n),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){u("writing close packet"),t.write([{type:"close"}])}var t=this;"open"==this.readyState?(u("transport open - closing"),e()):(u("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")},t=this;s.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders}var i=n(250),o=n(259);e.exports=r,o(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){(function(e){function r(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}function i(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,o=new Uint8Array(i),s=new Uint8Array(1+i.byteLength);s[0]=y[e.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return r(s.buffer)}function o(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){e.data=i.result,t.encodePacket(e,n,!0,r)},i.readAsArrayBuffer(e.data)}function s(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(g)return o(e,n,r);var i=new Uint8Array(1);i[0]=y[e.type];var s=new _([i.buffer,e.data]);return r(s)}function a(e,t,n){for(var r=new Array(e.length),i=h(e.length,n),o=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})},s=0;s<e.length;s++)o(s,e[s],i)}var c=n(251),u=n(252),f=n(254),l=n(255),h=n(256),d=n(257),p=navigator.userAgent.match(/Android/i),v=/PhantomJS/i.test(navigator.userAgent),g=p||v;t.protocol=3;var y=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},m=c(y),b={type:"error",data:"parser error"},_=n(258);t.encodePacket=function(t,n,o,a){"function"==typeof n&&(a=n,n=!1),"function"==typeof o&&(a=o,o=null);var c=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&c instanceof ArrayBuffer)return i(t,n,a);if(_&&c instanceof e.Blob)return s(t,n,a);if(c&&c.base64)return r(t,a);var u=y[t.type];return void 0!==t.data&&(u+=o?d.encode(String(t.data)):String(t.data)),a(""+u)},t.encodeBase64Packet=function(n,r){var i="b"+t.packets[n.type];if(_&&n.data instanceof e.Blob){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];r(i+e)},o.readAsDataURL(n.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(a){for(var c=new Uint8Array(n.data),u=new Array(c.length),f=0;f<c.length;f++)u[f]=c[f];s=String.fromCharCode.apply(null,u)}return i+=e.btoa(s),r(i)},t.decodePacket=function(e,n,r){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r)try{e=d.decode(e)}catch(i){return b}var o=e.charAt(0);return Number(o)==o&&m[o]?e.length>1?{type:m[o],data:e.substring(1)}:{type:m[o]}:b}var s=new Uint8Array(e),o=s[0],a=f(e,1);return _&&"blob"===n&&(a=new _([a])),{type:m[o],data:a}},t.decodeBase64Packet=function(t,n){var r=m[t.charAt(0)];if(!e.ArrayBuffer)return{type:r,data:{base64:!0,data:t.substr(1)}};var i=l.decode(t.substr(1));return"blob"===n&&_&&(i=new _([i])),{type:r,data:i}},t.encodePayload=function(e,n,r){function i(e){return e.length+":"+e}function o(e,r){t.encodePacket(e,!!s&&n,!0,function(e){r(null,i(e))})}"function"==typeof n&&(r=n,n=null);var s=u(e);return n&&s?_&&!g?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void a(e,o,function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);"function"==typeof n&&(r=n,n=null);var i;if(""==e)return r(b,0,1);for(var o,s,a="",c=0,u=e.length;c<u;c++){var f=e.charAt(c);if(":"!=f)a+=f;else{if(""==a||a!=(o=Number(a)))return r(b,0,1);if(s=e.substr(c+1,o),a!=s.length)return r(b,0,1);if(s.length){if(i=t.decodePacket(s,n,!0),b.type==i.type&&b.data==i.data)return r(b,0,1);var l=r(i,c+o,u);if(!1===l)return}c+=o,a=""}}return""!=a?r(b,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){function r(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})}return e.length?void a(e,r,function(e,t){var r=t.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),i=new Uint8Array(r),o=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),s=0;s<e.length;s++)r[s]=e.charCodeAt(s);n=r.buffer}t?i[o++]=0:i[o++]=1;for(var a=n.byteLength.toString(),s=0;s<a.length;s++)i[o++]=parseInt(a[s]);i[o++]=255;for(var r=new Uint8Array(n),s=0;s<r.length;s++)i[o++]=r[s]}),n(i.buffer)}):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){function r(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}for(var o=e instanceof ArrayBuffer?e.byteLength:e.size,s=o.toString(),a=new Uint8Array(s.length+1),i=0;i<s.length;i++)a[i]=parseInt(s[i]);if(a[s.length]=255,_){var c=new _([t.buffer,a.buffer,e]);n(null,c)}})}a(e,r,function(e,t){return n(new _(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,o=[],s=!1;i.byteLength>0;){for(var a=new Uint8Array(i),c=0===a[0],u="",l=1;255!=a[l];l++){if(u.length>310){s=!0;break}u+=a[l]}if(s)return r(b,0,1);i=f(i,2+u.length),u=parseInt(u);var h=f(i,0,u);if(c)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(d){var p=new Uint8Array(h);h="";for(var l=0;l<p.length;l++)h+=String.fromCharCode(p[l])}o.push(h),i=f(i,u)}var v=o.length;o.forEach(function(e,i){r(t.decodePacket(e,n,!0),i,v)})}}).call(t,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t,n){(function(t){function r(e){function n(e){if(!e)return!1;if(t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer||t.Blob&&e instanceof Blob||t.File&&e instanceof File)return!0;if(i(e)){for(var r=0;r<e.length;r++)if(n(e[r]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&n(e[o]))return!0}return!1}return n(e)}var i=n(253);e.exports=r}).call(t,function(){return this}())},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)o[a]=i[s];return o.buffer}},function(e,t){!function(e){"use strict";t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3===2?o=o.substring(0,o.length-1)+"=":i%3===1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(t){var n,r,i,o,s,a=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var f=new ArrayBuffer(a),l=new Uint8Array(f);for(n=0;n<c;n+=4)r=e.indexOf(t[n]),i=e.indexOf(t[n+1]),o=e.indexOf(t[n+2]),s=e.indexOf(t[n+3]),l[u++]=r<<2|i>>4,l[u++]=(15&i)<<4|o>>2,l[u++]=(3&o)<<6|63&s;return f}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},function(e,t){function n(e,t,n){function i(e,r){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,t(e),t=n):0!==i.count||o||t(null,r)}var o=!1;return n=n||r,i.count=e,0===e?t():i}function r(){}e.exports=n},function(e,t,n){var r;(function(e,i){!function(o){function s(e){for(var t,n,r=[],i=0,o=e.length;i<o;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<o?(n=e.charCodeAt(i++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--)):r.push(t);return r}function a(e){for(var t,n=e.length,r=-1,i="";++r<n;)t=e[r],t>65535&&(t-=65536,i+=_(t>>>10&1023|55296),t=56320|1023&t),i+=_(t);return i}function c(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function u(e,t){return _(e>>t&63|128)}function f(e){if(0==(4294967168&e))return _(e);var t="";return 0==(4294965248&e)?t=_(e>>6&31|192):0==(4294901760&e)?(c(e),t=_(e>>12&15|224),t+=u(e,6)):0==(4292870144&e)&&(t=_(e>>18&7|240),t+=u(e,12),t+=u(e,6)),t+=_(63&e|128)}function l(e){for(var t,n=s(e),r=n.length,i=-1,o="";++i<r;)t=n[i],o+=f(t);return o}function h(){if(b>=m)throw Error("Invalid byte index");var e=255&y[b];if(b++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function d(){var e,t,n,r,i;if(b>m)throw Error("Invalid byte index");if(b==m)return!1;if(e=255&y[b],b++,0==(128&e))return e;if(192==(224&e)){var t=h();if(i=(31&e)<<6|t,i>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=h(),n=h(),i=(15&e)<<12|t<<6|n,i>=2048)return c(i),i;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=h(),n=h(),r=h(),i=(15&e)<<18|t<<12|n<<6|r,i>=65536&&i<=1114111))return i;throw Error("Invalid UTF-8 detected")}function p(e){y=s(e),m=y.length,b=0;for(var t,n=[];(t=d())!==!1;)n.push(t);return a(n)}var v="object"==typeof t&&t,g=("object"==typeof e&&e&&e.exports==v&&e,"object"==typeof i&&i);g.global!==g&&g.window!==g||(o=g);var y,m,b,_=String.fromCharCode,w={version:"2.0.0",encode:l,decode:p};r=function(){return w}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}(this)}).call(t,n(234)(e),function(){return this}())},function(e,t){(function(t){function n(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=i.buffer}e[t]=r}}}function r(e,t){t=t||{};var r=new o;n(e);for(var i=0;i<e.length;i++)r.append(e[i]);return t.type?r.getBlob(t.type):r.getBlob()}function i(e,t){return n(e),new Blob(e,t||{})}var o=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,s=function(){try{var e=new Blob(["hi"]);return 2===e.size}catch(t){return!1}}(),a=s&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return 2===e.size}catch(t){return!1}}(),c=o&&o.prototype.append&&o.prototype.getBlob;e.exports=function(){return s?a?t.Blob:i:c?r:void 0}()}).call(t,function(){return this}())},function(e,t){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){r.off(e,n),t.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){"use strict";function n(e){var t="";do t=s[e%a]+t,e=Math.floor(e/a);while(e>0);return t}function r(e){var t=0;for(f=0;f<e.length;f++)t=t*a+c[e.charAt(f)];return t}function i(){var e=n(+new Date);return e!==o?(u=0,o=e):e+"."+n(u++)}for(var o,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,c={},u=0,f=0;f<a;f++)c[s[f]]=f;i.encode=n,i.decode=r,e.exports=i},function(e,t,n){(function(t){function r(){}function i(e){o.call(this,e),this.query=this.query||{},a||(t.___eio||(t.___eio=[]),a=t.___eio),this.index=a.length;var n=this;a.push(function(e){n.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=r)},!1)}var o=n(248),s=n(261);e.exports=i;var a,c=/\n/g,u=/\\n/g;s(i,o),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},i.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(e){i.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+i.iframeId+'">';o=document.createElement(t)}catch(e){o=document.createElement("iframe"),o.name=i.iframeId,o.src="javascript:0"}o.id=i.iframeId,i.form.appendChild(o),i.iframe=o}var i=this;if(!this.form){var o,s=document.createElement("form"),a=document.createElement("textarea"),f=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=f,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),r(),e=e.replace(u,"\\\n"),this.area.value=e.replace(c,"\\n");try{this.form.submit()}catch(l){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==i.iframe.readyState&&n()}:this.iframe.onload=n}}).call(t,function(){return this}())},function(e,t,n){(function(t){function r(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,i.call(this,e)}var i=n(249),o=n(250),s=n(260),a=n(261),c=n(262),u=n(229)("engine.io-client:websocket"),f=t.WebSocket||t.MozWebSocket,l=f;if(!l&&"undefined"==typeof window)try{l=n(265)}catch(h){}e.exports=r,a(r,i),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=void 0,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.ws=f?new l(e):new l(e,t,n),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="buffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(r.prototype.onData=function(e){var t=this;setTimeout(function(){i.prototype.onData.call(t,e)},0)}),r.prototype.write=function(e){function n(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}var r=this;this.writable=!1;for(var i=e.length,s=0,a=i;s<a;s++)!function(e){o.encodePacket(e,r.supportsBinary,function(o){if(!f){var s={};if(e.options&&(s.compress=e.options.compress),r.perMessageDeflate){var a="string"==typeof o?t.Buffer.byteLength(o):o.length;a<r.perMessageDeflate.threshold&&(s.compress=!1)}}try{f?r.ws.send(o):r.ws.send(o,s)}catch(c){u("websocket closed before onclose event")}--i||n()})}(e[s])},r.prototype.onClose=function(){i.prototype.onClose.call(this)},r.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||(e.b64=1),e=s.encode(e),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e},r.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===r.prototype.name)}}).call(t,function(){return this}())},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t){(function(t){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(s,"").replace(a,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(r,"@").replace(i,"]").replace(o,""))?new Function("return "+e)():void 0):null}}).call(t,function(){return this}())},function(e,t,n){function r(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.io.autoConnect&&this.open()}var i=n(232),o=n(269),s=n(270),a=n(271),c=n(272),u=n(229)("socket.io-client:socket"),f=n(273);e.exports=t=r;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=o.prototype.emit;o(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",c(this,"onopen")),a(e,"packet",c(this,"onpacket")),a(e,"close",c(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this.emit("connecting"),this)},r.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(l.hasOwnProperty(e))return h.apply(this,arguments),this;var t=s(arguments),n=i.EVENT;f(t)&&(n=i.BINARY_EVENT);var r={type:n,data:t};return r.options={},r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),delete this.flags,this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){u("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:i.CONNECT})},r.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:this.onevent(e);break;case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:this.onack(e);break;case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=s(arguments);u("sending ack %j",r);var o=f(r)?i.BINARY_ACK:i.ACK;t.packet({type:o,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){
return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){function n(e,t){var n=[];t=t||0;for(var r=t||0;r<e.length;r++)n[r-t]=e[r];return n}e.exports=n},function(e,t){function n(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}e.exports=n},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t,n){(function(t){function r(e){function n(e){if(!e)return!1;if(t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer||t.Blob&&e instanceof Blob||t.File&&e instanceof File)return!0;if(i(e)){for(var r=0;r<e.length;r++)if(n(e[r]))return!0}else if(e&&"object"==typeof e){e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON());for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&n(e[o]))return!0}return!1}return n(e)}var i=n(274);e.exports=r}).call(t,function(){return this}())},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}])});
//# sourceMappingURL=telepat.min.js.map